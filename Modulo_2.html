
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Parte II - Regresión Lineal &#8212; Microeconometria Aplicada</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Modulo_2';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Parte I - Fundamentos" href="Modulo_1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Microeconometria Aplicada - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Microeconometria Aplicada - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Microeconometría Aplicada
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Modulo_1.html">Parte I - Fundamentos</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Parte II - Regresión Lineal</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FModulo_2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Modulo_2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Parte II - Regresión Lineal</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-aprendizaje-y-tamano-de-clase">2.1 Aplicación: Aprendizaje y Tamaño de Clase</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-simple-o-univariada">2.2 Regresión Simple o Univariada</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supuestos-del-modelo">2.3 Supuestos del Modelo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linealidad-en-parametros">2.3.1 Linealidad en Parámetros</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-multicolinealidad-o-rango-completo">2.3.2 No Multicolinealidad o Rango Completo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#homoscedasticidad">2.3.3 Homoscedasticidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-autocorrelacion">2.3.4 No Autocorrelación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-normal-de-los-errores">2.3.5 Distribución Normal de los Errores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independencia-condicional-o-exogenidad">2.3.6 Independencia Condicional o Exogenidad</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametros-poblacionales">2.4 Parámetros Poblacionales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-por-mco">2.5 Estimación por MCO</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-relacion-entre-educacion-y-crecimiento">2.6 Aplicación : Relación entre Educación y Crecimiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#residuales-de-la-regresion-e-i-y-i-hat-y-i">2.7 Residuales de la Regresión: <span class="math notranslate nohighlight">\(e_i = Y_i - \hat Y_i\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propiedades-de-los-estimadores-hat-beta-k">2.8 Propiedades de los estimadores <span class="math notranslate nohighlight">\(\hat\beta_k\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inferencia-en-regresion-simple">2.9 Inferencia en Regresión Simple</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-hipotesis-sobre-hat-beta-k">2.9.1 Pruebas de Hipótesis sobre <span class="math notranslate nohighlight">\(\hat\beta_k\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varianza-de-hat-beta-k">2.9.2 Varianza de <span class="math notranslate nohighlight">\(\hat\beta_k\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varianza-de-los-errores">2.9.3 Varianza de los Errores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-hipotesis-individuales">2.9.4 Pruebas de Hipótesis Individuales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intervalo-de-confianza-para-beta-k">2.9.5 Intervalo de confianza para <span class="math notranslate nohighlight">\(\beta_k\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coeficiente-de-determinacion-r-2">2.9.6 Coeficiente de Determinación: <span class="math notranslate nohighlight">\(R^2\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-significancia-global">2.9.7 Prueba de Significancia Global</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-e-inferencia-para-hat-y-i">2.9.8 Predicción e Inferencia para <span class="math notranslate nohighlight">\(\hat Y_i\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-media">2.9.9 Predicción Media</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-individual">2.9.10 Predicción Individual</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-por-maxima-verosimilitud">2.10 Estimación por Máxima Verosimilitud</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-multiple">2.11 Modelo de Regresión Multiple</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-en-forma-matricial">2.11.1 Modelo en Forma Matricial</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#supuestos-en-forma-matricial">2.11.2 Supuestos en forma Matricial</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-ordinarios">2.12 Mínimos Cuadrados Ordinarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-de-beta">2.13 Estimación de <span class="math notranslate nohighlight">\(\beta\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices-y-sumatorias">2.13.1 Matrices y Sumatorias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo">2.13.2 Ejemplo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propiedades-de-hat-beta">2.14 Propiedades de <span class="math notranslate nohighlight">\(\hat\beta\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-varianza-y-covarianza">2.15 Matriz de Varianza y Covarianza</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-significancia-individual">2.16 Pruebas de Significancia Individual</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bondad-de-ajuste-r-2-y-r-2-ajustado">2.17 Bondad de Ajuste: <span class="math notranslate nohighlight">\(R^2\)</span> y <span class="math notranslate nohighlight">\(R^2\)</span>-Ajustado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-signifiancia-global">2.18 Prueba de Signifiancia Global</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otras-pruebas-de-hipotesis">2.19 Otras Pruebas de Hipotesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-restringidos">2.20 Mínimos Cuadrados Restringidos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.20.1 Ejemplo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-variables">2.20.2 Selección de Variables</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-coeficientes">2.21 Interpretación de Coeficientes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lin-lin">2.21.1 Lin-Lin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-lin">2.21.2 Log-Lin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lin-log">2.21.3 Lin-Log</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-log">2.21.4 Log-Log</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion">2.22 Aplicación:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-binarias-y-categoricas">2.23 Variables Binarias y Categoricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-retornos-a-la-educacion-edad-y-gaps">2.24 Aplicación: Retornos a la Educación, Edad, y Gaps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covariables-no-lineales">2.25 Covariables No-lineales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interacciones">2.26 Interacciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interaccion-entre-variables-binarias">2.26.1 Interacción entre Variables Binarias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interaccion-entre-una-variable-binaria-y-una-continua">2.26.2 Interacción entre una Variable Binaria y una Continua</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#teorema-de-gauss-markov">2.27 Teorema de Gauss-Markov</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="parte-ii-regresion-lineal">
<h1>Parte II - Regresión Lineal<a class="headerlink" href="#parte-ii-regresion-lineal" title="Link to this heading">#</a></h1>
<p>La regresión es un método que nos permite estudiar la relación entre una variable de resultado <span class="math notranslate nohighlight">\(Y\)</span> y una covariable o predictor <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>Aunque no siempre se busca determinar si existe una relación causal, el problema de causalidad ocupa un lugar central en la agenda de los microeconometristas.</p>
<section id="aplicacion-aprendizaje-y-tamano-de-clase">
<h2>2.1 Aplicación: Aprendizaje y Tamaño de Clase<a class="headerlink" href="#aplicacion-aprendizaje-y-tamano-de-clase" title="Link to this heading">#</a></h2>
<p>¿Cuál es la mejor forma de asignar el gasto en educación? ¿Es buena idea tener clases de menor tamaño? Estas son preguntas de interés no solo para economistas sino también para gobiernos y la sociedad en general. Sin embargo, por mucho tiempo la literatura presentó evidencia no concluyente o mixta.</p>
<p>Parte del problema para responder estas preguntas está relacionado con que sabemos muy poco acerca de cómo aprenden los estudiantes. En particular, múltiples factores afectan los resultados de los estudiantes. Suponiendo que existe una función de producción educativa, <span class="math notranslate nohighlight">\(f\)</span>, ¿qué elementos cree usted que explican el aprendizaje?</p>
<div class="math notranslate nohighlight">
\[\text{Aprendizaje} = f(?)\]</div>
<p>Existen diferentes factores que confluyen al tiempo en el aprendizaje de los estudiantes, entre ellos</p>
<ul class="simple">
<li><p>Calidad docente</p></li>
<li><p>Compañeros de clase</p></li>
<li><p>Padres y condiciones del hogar</p></li>
<li><p>Infraestructura</p></li>
<li><p>Tamaño de clase</p></li>
<li><p>Habilidades innatas</p></li>
</ul>
<p><a class="reference external" href="https://doi.org/10.1162/003355399556052">Krueger (1999)</a> utilizó información de un experimento aleatario en Tennessee (STAR), encontrando que los estudiantes asignados a clases más pequeñas obtienen mejores resultados en pruebas estandarizadas y que este efecto positivo es persistente en el tiempo. Luego veremos por qué las estimaciones de Krueger pueden ser interpretadas como relaciones causales.</p>
</section>
<section id="regresion-simple-o-univariada">
<h2>2.2 Regresión Simple o Univariada<a class="headerlink" href="#regresion-simple-o-univariada" title="Link to this heading">#</a></h2>
<p>La función de regresión, <span class="math notranslate nohighlight">\(r(X)\)</span>, resume la relación entre <span class="math notranslate nohighlight">\(X\)</span> y <span class="math notranslate nohighlight">\(Y\)</span>:</p>
<div class="math notranslate nohighlight">
\[
r(x) = \mathbb{E}(Y | X = x) = \int y f(y|x) dy.
\]</div>
<p>Nuestro objetivo es estimar <span class="math notranslate nohighlight">\(r(x)\)</span> usando datos de la forma</p>
<div class="math notranslate nohighlight">
\[\{Y_i , X_i\}_{i = 1}^n\]</div>
<p>Definamos el error <span class="math notranslate nohighlight">\(\varepsilon = Y - r(x)\)</span>. De esta manera, podemos escribir:</p>
<div class="math notranslate nohighlight">
\[
Y = r(x) + \varepsilon
\]</div>
<p>En su versión más simple, <span class="math notranslate nohighlight">\(X\)</span> es unidimensional y asumimos que <span class="math notranslate nohighlight">\(r(x)\)</span> es lineal. Así,</p>
<div class="math notranslate nohighlight">
\[r(x) = \beta_0 + \beta_1 x.\]</div>
<p>El modelo regresión lineal simple se define como:</p>
<div class="math notranslate nohighlight">
\[
Y_i = r(x) + \varepsilon_i = \beta_0 + \beta_1 X_i + \varepsilon_i
\]</div>
<p>Observe que los parámetros desconocidos en este modelo son el intercepto <span class="math notranslate nohighlight">\(\beta_0\)</span> y la pendiente <span class="math notranslate nohighlight">\(\beta_1\)</span>.</p>
</section>
<section id="supuestos-del-modelo">
<h2>2.3 Supuestos del Modelo<a class="headerlink" href="#supuestos-del-modelo" title="Link to this heading">#</a></h2>
<p>Para estimar el modelo de regresión suponemos:</p>
<ul class="simple">
<li><p>Linealidad en los parámetros</p></li>
<li><p>No multicolinealidad o Rango Completo</p></li>
<li><p>Homoscedasticidad</p></li>
<li><p>No autocorrelación</p></li>
<li><p>Distribución Normal de los Errores</p></li>
<li><p>Independencia Condicional o Exogenidad</p></li>
</ul>
<p>Algunos de estos supuestos hace que el modelo sea <strong>estimable</strong>, otros nos permiten hacer <strong>inferencia</strong> sobre los parámetros</p>
<section id="linealidad-en-parametros">
<h3>2.3.1 Linealidad en Parámetros<a class="headerlink" href="#linealidad-en-parametros" title="Link to this heading">#</a></h3>
<p>Este supuesto es necesario para que el modelo sea <strong>estimable</strong>.</p>
<p>Se refiere a la forma funcional de la función de regresión <span class="math notranslate nohighlight">\(r(x) = \beta_0 + \beta_1 X_i\)</span>.</p>
<p>Note que nos interesa estimar <span class="math notranslate nohighlight">\(\beta_k\)</span>, no <span class="math notranslate nohighlight">\(\beta_k^2\)</span>, <span class="math notranslate nohighlight">\(\ln(\beta_k)\)</span>, o cualquier otra función <span class="math notranslate nohighlight">\(g(\beta_k)\)</span>.</p>
<div class="alert alert-block alert-warning"> 
<b>EJEMPLO:</b>
<p>
<p>Suponga queremos estimar el parámetro <span class="math notranslate nohighlight">\(\beta\)</span> de la función <span class="math notranslate nohighlight">\(y = A X^\beta e^\varepsilon\)</span>. ¿Podemos usar el modelo de regresión lineal?</p>
<p>Sí, note que podemos utilizar la siguiente transformación:</p>
<div class="math notranslate nohighlight">
\[\ln y_i = \alpha + \beta \cdot X_i + \varepsilon_i, \text{ con } \alpha = \ln A\]</div>
<p>¿Qué pasa si <span class="math notranslate nohighlight">\(y = A X^\beta e^\varepsilon + u\)</span> ?</p>
</div></section>
<section id="no-multicolinealidad-o-rango-completo">
<h3>2.3.2 No Multicolinealidad o Rango Completo<a class="headerlink" href="#no-multicolinealidad-o-rango-completo" title="Link to this heading">#</a></h3>
<p>Este supuesto es necesario para que el modelo sea <strong>estimable</strong>.</p>
<p>El supuesto hace referencia a la información que aportan diferentes covariables. En primer lugar, este supuesto señala que:</p>
<div class="math notranslate nohighlight">
\[|\rho(X_{1i}, X_{2i})| \neq 1\]</div>
<p>Donde <span class="math notranslate nohighlight">\(\rho\)</span> es el coeficiente de correlación. Este supuesto será más relevante cuando estudiemos el modelo de regresión múltiple.</p>
<p>Adicionalmente, es necesario que el número de observaciones en los datos <span class="math notranslate nohighlight">\(n\)</span> sea mayor al número de parámetros <span class="math notranslate nohighlight">\(k\)</span> que queremos estimar. Es decir</p>
<div class="math notranslate nohighlight">
\[n \geq k\]</div>
</section>
<section id="homoscedasticidad">
<h3>2.3.3 Homoscedasticidad<a class="headerlink" href="#homoscedasticidad" title="Link to this heading">#</a></h3>
<p>Este supuesto es sobre la varianza y nos facilita realizar pruebas de hipótesis</p>
<p>El supuesto establece que:</p>
<div class="math notranslate nohighlight">
\[V(\varepsilon_i | X) = \sigma^2\]</div>
<p>La violación de este supuesto se conoce como <strong>heteroscedasticidad</strong>. En un modelo <strong>heteroscedástico</strong></p>
<div class="math notranslate nohighlight">
\[V(\varepsilon_i | X) = \sigma_i^2\]</div>
</section>
<section id="no-autocorrelacion">
<h3>2.3.4 No Autocorrelación<a class="headerlink" href="#no-autocorrelacion" title="Link to this heading">#</a></h3>
<p>Este supuesto establece que:</p>
<div class="math notranslate nohighlight">
\[Cov(\varepsilon_i, \varepsilon_j | X) = 0 \text{ para todo } i \neq j\]</div>
<p>La violación de este supuesto se conoce como <strong>autocorrelación</strong>.</p>
</section>
<section id="distribucion-normal-de-los-errores">
<h3>2.3.5 Distribución Normal de los Errores<a class="headerlink" href="#distribucion-normal-de-los-errores" title="Link to this heading">#</a></h3>
<p>Este supuesto se hace sobre los errores entonces también afecta las pruebas de hipótesis.</p>
<p>El supuesto señala que:</p>
<div class="math notranslate nohighlight">
\[\varepsilon_i | X \sim N(0, \sigma^2)\]</div>
<p>Observe que por el teorema del límite central este supuesto no es tan fuerte, y si muy útil para determinar cómo se distribuyen ciertos estadísticos.</p>
</section>
<section id="independencia-condicional-o-exogenidad">
<h3>2.3.6 Independencia Condicional o Exogenidad<a class="headerlink" href="#independencia-condicional-o-exogenidad" title="Link to this heading">#</a></h3>
<p>Para que los estimadores de <span class="math notranslate nohighlight">\(\beta_k\)</span> sean insesgados y consistentes suponemos que</p>
<div class="math notranslate nohighlight">
\[E(\varepsilon_i | X) = E(\varepsilon_i)\]</div>
<p>Observe que combinado con el supuesto anterior tenemos que:</p>
<div class="math notranslate nohighlight">
\[E(\varepsilon_i | X) = 0\]</div>
<p>Según este supuesto <span class="math notranslate nohighlight">\(\varepsilon\)</span> es indepente de <span class="math notranslate nohighlight">\(X\)</span>. En otras palabras <span class="math notranslate nohighlight">\(X\)</span> es una variable exogena.</p>
<p>Este supuesto garantiza que los efectos encontrados pueden se interpretados como estimaciones <strong>causales</strong>.</p>
</section>
</section>
<section id="parametros-poblacionales">
<h2>2.4 Parámetros Poblacionales<a class="headerlink" href="#parametros-poblacionales" title="Link to this heading">#</a></h2>
<p>El supuesto de independencia condicional y el supuesto de media cero de los errores, nos permiten determinar los <strong>parámetros poblaciones</strong>. Observe que:</p>
<div class="math notranslate nohighlight">
\[E(\varepsilon_i | X) = 0 \hspace{10pt}\Rightarrow\hspace{10pt} Cov(\varepsilon_i, X_i) = E(\varepsilon_i X_i) - E(\varepsilon_i)E(X_i) = 0 \hspace{10pt}\Rightarrow\hspace{10pt} E(\varepsilon_i X_i) = 0\]</div>
<div class="math notranslate nohighlight">
\[E(\varepsilon_i) = 0 \hspace{10pt}\Rightarrow\hspace{10pt} E(Y_i) = \beta_0 + \beta_1 E(X_i)\]</div>
<p>De esta manera,</p>
<div class="math notranslate nohighlight">
\[E(\varepsilon_i X_i) = E(y_i X_i) - \beta_0 E(X_i) - \beta_1 E(X^2_i) = 0\]</div>
<div class="math notranslate nohighlight">
\[E(y_i X_i) = \beta_0 E(X_i) + \beta_1 E(X^2_i)\]</div>
<div class="math notranslate nohighlight">
\[E(y_i X_i) = [E(Y_i) - \beta_1 E(X_i)] E(X_i) + \beta_1 E(X^2_i)\]</div>
<div class="math notranslate nohighlight">
\[E(y_i X_i) - E(Y_i)E(X_i) = \beta_1 [E(X^2_i) - E(X_i)^2]\]</div>
<p>Finalmente,</p>
<div class="math notranslate nohighlight">
\[\beta_1 = \frac{Cov(Y_i X_i)}{Var(X_i)}\]</div>
</section>
<section id="estimacion-por-mco">
<h2>2.5 Estimación por MCO<a class="headerlink" href="#estimacion-por-mco" title="Link to this heading">#</a></h2>
<p>Para estimar <span class="math notranslate nohighlight">\(\beta_0\)</span> y <span class="math notranslate nohighlight">\(\beta_1\)</span> podemos usar el método de Mínimos Cuadrados Ordinarios (MCO), de manera formal:</p>
<div class="math notranslate nohighlight">
\[\{\hat\beta_0, \hat\beta_1\} = \operatorname*{arg\,min} \mathcal{L}(\beta_0, \beta_1)\]</div>
<p>donde <span class="math notranslate nohighlight">\(\mathcal{L}(\beta_0, \beta_1) = \sum_i {\varepsilon_i}^2 = \sum_i ({Y_i} - \beta_0 - \beta_1 X_i)^2\)</span></p>
<p>Las condiciones de primer orden (CPO) de este problema estan dadas por:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{L}}{\partial\beta_0} \bigg|_{(\hat\beta_0, \hat\beta_1)} = \sum_i (-2) \cdot ({Y_i} - \beta_0 - \beta_1 X_i) \bigg|_{(\hat\beta_0, \hat\beta_1)} = 0\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{L}}{\partial\beta_1} \bigg|_{(\hat\beta_0, \hat\beta_1)} = \sum_i (-2 X_i) \cdot ({Y_i} - \beta_0 - \beta_1 X_i) \bigg|_{(\hat\beta_0, \hat\beta_1)} = 0\]</div>
<p>Estas ecuaciones se conocen como <strong>ecuaciones normales</strong>.</p>
<p>A partir de estas condiciones obtenemos los siguientes <strong>estimadores</strong>:</p>
<div class="math notranslate nohighlight">
\[\hat\beta_0 = \overline Y - \hat\beta_1 \overline X\]</div>
<div class="math notranslate nohighlight">
\[\hat\beta_1 = \frac{\sum_i (X_i - \overline X)(Y_i - \overline Y)}{\sum_i (X_i - \overline X)^2} = \frac{\mathbb{\hat Cov}(X, Y)}{\mathbb{\hat V}(X)}\]</div>
<p>De esta manera, la <strong>linea ajustada</strong> está dada por <span class="math notranslate nohighlight">\(\hat r(x) = \hat\beta_0 + \hat\beta_1 x\)</span>, y los <strong>valores predichos</strong> se definen como <span class="math notranslate nohighlight">\(\hat Y_i = \hat r(X_i)\)</span></p>
<p>Definimos además el <strong>residual</strong> como $<span class="math notranslate nohighlight">\(e_i = Y_i - \hat Y_i = Y_i - \left(\hat\beta_0 + \hat\beta_1 X_i \right)\)</span>$</p>
</section>
<section id="aplicacion-relacion-entre-educacion-y-crecimiento">
<h2>2.6 Aplicación : Relación entre Educación y Crecimiento<a class="headerlink" href="#aplicacion-relacion-entre-educacion-y-crecimiento" title="Link to this heading">#</a></h2>
<p>Vamos a usar datos de las pruebas PISA, que toman estudiantes de 15 años de diversos países, para estudiar la relación entre educación y desarrollo económico</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Leer datos</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;haven&#39;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&#39;haven&#39;</span><span class="p">)</span>
<span class="n">link_datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;https://www.dropbox.com/scl/fi/nmgy6omfwzj7mj9c8m4mk/PISA_GDP_2022.dta?rlkey=mdnhm4k5yi31rzthx8tu1xgy8&amp;dl=1&#39;</span>
<span class="n">datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_dta</span><span class="p">(</span><span class="n">link_datos</span><span class="p">)</span>

<span class="n">datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">na.omit</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="w"> </span><span class="c1">#Eliminar observaciones con info incompleta</span>
<span class="nf">names</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span><span class="w"> </span><span class="c1">#Variables en la base de datos</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing package into &#39;C:/Users/smontano/AppData/Local/R/win-library/4.3&#39;
(as &#39;lib&#39; is unspecified)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  There is a binary version available but the source version is later:
      binary source needs_compilation
haven  2.5.4  2.5.5              TRUE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>installing the source package &#39;haven&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Estadisticas descriptivas</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">datos</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;math&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;read&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;scie&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;GDP_percapita&#39;</span><span class="p">)])</span>
<span class="n">datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">datos</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">100000</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="c1">#Eliminar outliers</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      math            read            scie       GDP_percapita   
 Min.   :336.4   Min.   :328.8   Min.   :347.1   Min.   :  6163  
 1st Qu.:388.7   1st Qu.:391.0   1st Qu.:405.4   1st Qu.: 22407  
 Median :447.6   Median :442.8   Median :447.2   Median : 41223  
 Mean   :438.0   Mean   :436.9   Mean   :448.2   Mean   : 46295  
 3rd Qu.:483.4   3rd Qu.:480.7   3rd Qu.:493.6   3rd Qu.: 64006  
 Max.   :574.7   Max.   :542.6   Max.   :561.4   Max.   :143095  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Diagrama de puntos</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">,</span><span class="w"> </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Relación Desarrollo Económico y Educación&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Puntaje en Lectura - PISA 2022&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PIB Per-capita (PPP)&quot;</span><span class="p">)</span>
<span class="c1">#Paises de Referencia</span>
<span class="nf">points</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;COL&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;COL&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">);</span><span class="w"> </span><span class="nf">text</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;COL&#39;</span><span class="p">],</span><span class="w">  </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;COL&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Colombia&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;CHL&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;CHL&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">);</span><span class="w"> </span><span class="nf">text</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;CHL&#39;</span><span class="p">],</span><span class="w">  </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;CHL&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Chile&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;USA&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;USA&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">);</span><span class="w"> </span><span class="nf">text</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;USA&#39;</span><span class="p">],</span><span class="w">  </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;USA&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Estados Unidos&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;orange&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="nf">points</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;JPN&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;JPN&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;purple&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">);</span><span class="w"> </span><span class="nf">text</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;JPN&#39;</span><span class="p">],</span><span class="w">  </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">[</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="o">==</span><span class="s">&#39;JPN&#39;</span><span class="p">],</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Japón&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;purple&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">font</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/b7ae760cfb10f4f1c425426db565aac90ed79d8c20ffa55b7cb4908af56917e4.png"><img alt="_images/b7ae760cfb10f4f1c425426db565aac90ed79d8c20ffa55b7cb4908af56917e4.png" src="_images/b7ae760cfb10f4f1c425426db565aac90ed79d8c20ffa55b7cb4908af56917e4.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Estimar regresion lineal simple</span>
<span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">GDP_percapita</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">read</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

<span class="c1">#Usando las formulas</span>
<span class="n">b1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cov</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">,</span><span class="w"> </span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">)</span><span class="o">/</span><span class="nf">var</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">);</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;b1 =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">b1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>
<span class="n">b0</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">b1</span><span class="o">*</span><span class="nf">mean</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">);</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;b0 =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = GDP_percapita ~ read, data = datos)

Residuals:
   Min     1Q Median     3Q    Max 
-36312  -9338  -2157   5786  46589 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -94388.26   14678.37  -6.430 1.34e-08 ***
read           313.08      33.56   9.329 6.61e-14 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 15330 on 70 degrees of freedom
Multiple R-squared:  0.5542,	Adjusted R-squared:  0.5479 
F-statistic: 87.03 on 1 and 70 DF,  p-value: 6.609e-14
</pre></div>
</div>
<div class="output text_html">'b1 = 313.08'</div><div class="output text_html">'b0 = -94388.26'</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Prediccion</span>
<span class="n">model_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">se.fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;confidence&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.99</span><span class="p">))</span>
<span class="nf">names</span><span class="p">(</span><span class="n">model_fit</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;yhat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;lwr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;upr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;se&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;df&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;residuals&#39;</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">model_fit</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 5 × 6</caption>
<thead>
	<tr><th></th><th scope=col>yhat</th><th scope=col>lwr</th><th scope=col>upr</th><th scope=col>se</th><th scope=col>df</th><th scope=col>residuals</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>17828.75</td><td> 9578.873</td><td>26078.63</td><td>3115.625</td><td>70</td><td>15334</td></tr>
	<tr><th scope=row>2</th><td>36273.57</td><td>31263.301</td><td>41283.84</td><td>1892.164</td><td>70</td><td>15334</td></tr>
	<tr><th scope=row>3</th><td>31074.74</td><td>25447.751</td><td>36701.74</td><td>2125.074</td><td>70</td><td>15334</td></tr>
	<tr><th scope=row>4</th><td>61539.10</td><td>54107.501</td><td>68970.70</td><td>2806.596</td><td>70</td><td>15334</td></tr>
	<tr><th scope=row>5</th><td>56014.87</td><td>49701.700</td><td>62328.04</td><td>2384.213</td><td>70</td><td>15334</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Diagrama de puntos con linea de regresion ajustada</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">,</span><span class="w"> </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Relación Desarrollo Económico y Educación&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Puntaje en Lectura - PISA 2022&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PIB Per-capita (PPP)&quot;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">,</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">yhat</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">),</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">upr</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">),</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">lwr</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/c27345bbba3a3065ec65b3dbb1b206660b019b2f16134e8a39e54f83e1960133.png"><img alt="_images/c27345bbba3a3065ec65b3dbb1b206660b019b2f16134e8a39e54f83e1960133.png" src="_images/c27345bbba3a3065ec65b3dbb1b206660b019b2f16134e8a39e54f83e1960133.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
</section>
<section id="residuales-de-la-regresion-e-i-y-i-hat-y-i">
<h2>2.7 Residuales de la Regresión: <span class="math notranslate nohighlight">\(e_i = Y_i - \hat Y_i\)</span><a class="headerlink" href="#residuales-de-la-regresion-e-i-y-i-hat-y-i" title="Link to this heading">#</a></h2>
<p>Observe que a partir de las ecuaciones normales tenemos que</p>
<div class="math notranslate nohighlight">
\[\sum_i ({Y_i} - \hat\beta_0 - \hat\beta_1 X_i) = \sum_i e_i = 0\]</div>
<div class="math notranslate nohighlight">
\[\sum_i (X_i) \cdot ({Y_i} - \hat\beta_0 - \hat\beta_1 X_i) = \sum_i e_i \cdot X_i = 0\]</div>
<p>Lo anterior indica que:</p>
<div class="math notranslate nohighlight">
\[\frac{\sum_i e_i}{n} = \bar e = 0 \hspace{5pt} \Rightarrow \hspace{5pt} \bar Y = \bar{\hat Y}\]</div>
<div class="math notranslate nohighlight">
\[\sum_i e_i \cdot X_i = 0 \hspace{5pt} \Rightarrow \hspace{5pt} \mathbb{\hat Cov}(e_i, X_i) = \sum_i (e_i - \bar e) \cdot (X_i - \bar X) = 0\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Predecir los errores</span>
<span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">yhat</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">322026</span><span class="p">)</span>
<span class="n">u</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">5000</span><span class="p">,</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">e</span><span class="p">))</span><span class="w"> </span><span class="c1">#Variable normal teorica</span>

<span class="c1">#Estimacion de la función de densidad</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">density</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">#Residuales</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">density</span><span class="p">(</span><span class="n">u</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">#Variable normal</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/e53aad3b0e8e6e1dcd0f5d46d81b8d43d95cb695fc2bb9e93b74c3d77137dcf2.png"><img alt="_images/e53aad3b0e8e6e1dcd0f5d46d81b8d43d95cb695fc2bb9e93b74c3d77137dcf2.png" src="_images/e53aad3b0e8e6e1dcd0f5d46d81b8d43d95cb695fc2bb9e93b74c3d77137dcf2.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
</section>
<section id="propiedades-de-los-estimadores-hat-beta-k">
<h2>2.8 Propiedades de los estimadores <span class="math notranslate nohighlight">\(\hat\beta_k\)</span><a class="headerlink" href="#propiedades-de-los-estimadores-hat-beta-k" title="Link to this heading">#</a></h2>
<p>Queremos evaluar si <span class="math notranslate nohighlight">\(\hat\beta_1\)</span> es un buen estimador de <span class="math notranslate nohighlight">\(\beta_1\)</span>.</p>
<p>La primera pregunta que nos hacemos es ¿<span class="math notranslate nohighlight">\(E(\hat\beta_1) = \beta_1\)</span>? Es decir, queremos ver si <span class="math notranslate nohighlight">\(\hat\beta_1\)</span> es un estimador insesgado.</p>
<p>Note que</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \hat\beta_1 &amp; = \frac{\sum_i (X_i - \overline X)(Y_i - \overline Y)}{\sum_i (X_i - \overline X)^2}\\
     &amp; = \frac{\sum_i (X_i - \overline X)(\beta_0 + \beta_1 X_i + \varepsilon_i - \beta_0 - \beta_1 \bar X - \bar \varepsilon)}{\sum_i (X_i - \overline X)^2}\\
    &amp; = \beta_1 + \frac{\sum_i (X_i - \overline X)(\varepsilon_i - \overline \varepsilon)}{\sum_i (X_i - \overline X)^2}\\
    &amp; = \beta_1 + \frac{\sum_i (X_i - \overline X) \cdot \varepsilon_i}{\sum_i (X_i - \overline X)^2} \\     
\end{align*}\]</div>
<p>Si tomamos la esperanza de esta exprensión tenemos:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    E(\hat\beta_1) &amp; = \beta_1 + E \left(\frac{\sum_i (X_i - \overline X) \cdot \varepsilon_i}{\sum_i (X_i - \overline X)^2}\right) \\    
\end{align*}\]</div>
<p>A partir del supuesto de <strong>independencia condicional</strong>, para todo <span class="math notranslate nohighlight">\(i\)</span> y <span class="math notranslate nohighlight">\(j\)</span>, <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> y <span class="math notranslate nohighlight">\(X_j\)</span> son independientes. Es decir,</p>
<div class="math notranslate nohighlight">
\[E(\varepsilon_i \cdot X_j) = E(\varepsilon_i) \cdot E(X_j) = 0\]</div>
<p>Debido a esto:</p>
<div class="math notranslate nohighlight">
\[E\left(\sum_i (X_i - \overline X) \cdot \varepsilon_i\right) = \sum_i E(X_i \varepsilon_i) - \sum_i E(\overline X \varepsilon_i) = \sum_i E(X_i) E(\varepsilon_i) - \sum_i E(\overline X) E(\varepsilon_i) = 0\]</div>
<p>De esta manera, el estimador <span class="math notranslate nohighlight">\(\hat\beta_1\)</span>, que obtuvimos por el método MCO, es insesgado. Así,</p>
<div class="math notranslate nohighlight">
\[E(\hat\beta_1) = \beta_1\]</div>
<p>Es <span class="math notranslate nohighlight">\(\beta_0\)</span> un estimador insesgado?</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    E(\hat\beta_0) &amp; =E \left(\overline Y - \hat\beta_1 \overline X \right)\\
     &amp; = E\left(\beta_0 + \beta_1 \overline X + \overline\varepsilon - \hat\beta_1 \overline X\right)\\
     &amp; = \beta_0 + \beta_1 E(\overline X) + E(\overline\varepsilon) - \beta_1 E(\overline X)\\
     &amp; = \beta_0 \\
\end{align*}\]</div>
</section>
<section id="inferencia-en-regresion-simple">
<h2>2.9 Inferencia en Regresión Simple<a class="headerlink" href="#inferencia-en-regresion-simple" title="Link to this heading">#</a></h2>
<p>Luego de estimar el modelo, y saber que en promedio nuestros estimadores de MCO encuentran los verdaderos parámetros que se desconocen, queremos determinar si</p>
<ol class="arabic simple">
<li><p>existe una relación <strong>estádisticamente significativa</strong> entre <span class="math notranslate nohighlight">\(Y\)</span> y <span class="math notranslate nohighlight">\(X\)</span></p></li>
<li><p>nuestro modelo tiene un buen ajuste (o poder predictivo)</p></li>
</ol>
<p>Con este objetivo en mente,</p>
<ol class="arabic simple">
<li><p>realizaremos pruebas de hipotesis individuales y conjuntas</p></li>
<li><p>computaremos el coeficiente de determinación <span class="math notranslate nohighlight">\(R^2\)</span>.</p></li>
</ol>
<section id="pruebas-de-hipotesis-sobre-hat-beta-k">
<h3>2.9.1 Pruebas de Hipótesis sobre <span class="math notranslate nohighlight">\(\hat\beta_k\)</span><a class="headerlink" href="#pruebas-de-hipotesis-sobre-hat-beta-k" title="Link to this heading">#</a></h3>
<p>Debido al supuesto de <strong>normalidad de los errores</strong>, <span class="math notranslate nohighlight">\(\varepsilon_i | X \sim N(0, \sigma^2)\)</span>, es posible probar que</p>
<div class="math notranslate nohighlight">
\[\hat\beta_k | X \sim N(\beta_k, \sigma^2_\beta)\]</div>
<p>Sin entrar en detalles, recuerde que la suma de variables normales da como resultado una variable que se distribuye normal. Esta es la idea fundamental detrás de la demostración de que nuestros estimadores de MCO son normales.</p>
<p>La hipotesis que queremos considerar en general toma la siguiente forma:</p>
<div class="math notranslate nohighlight">
\[H_0 : \beta_k = 0\]</div>
<div class="math notranslate nohighlight">
\[H_1 : \beta_k \neq 0\]</div>
<p>Note que bajo la hipótesis nula (<span class="math notranslate nohighlight">\(H_0\)</span>) el parámetro <span class="math notranslate nohighlight">\(\beta_k\)</span> es cero, y queremos saber si podemos rechazar dicha hipotesis con un nivel de significancia <span class="math notranslate nohighlight">\(\alpha \in \{0.1, 0.05, 0.01\}\)</span>.</p>
<p>Para probar esta hipótesis podemoslos usar el siguiente estadístico:</p>
<div class="math notranslate nohighlight">
\[\frac{\hat\beta_k - \beta_k}{\sigma_\beta}\]</div>
<p>Sin embargo, desconocemos <span class="math notranslate nohighlight">\(\sigma_\beta\)</span>. Esto implica que debemos estimarlo.</p>
</section>
<section id="varianza-de-hat-beta-k">
<h3>2.9.2 Varianza de <span class="math notranslate nohighlight">\(\hat\beta_k\)</span><a class="headerlink" href="#varianza-de-hat-beta-k" title="Link to this heading">#</a></h3>
<p>Recuerde <span class="math notranslate nohighlight">\(\hat\beta_1 = \frac{\mathbb{\hat Cov}(X, Y)}{\mathbb{\hat V}(X)} = \beta_1 + \frac{\sum_i (X_i - \overline X) \cdot \varepsilon_i}{\sum_i (X_i - \overline X)^2}\)</span>. De esta manera,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    V(\hat\beta_1 | X) &amp; = E \left(\hat\beta_1 - E(\hat\beta_1) | X \right)^2 = E \left(\hat\beta_1 - \beta_1 | X \right)^2 = E \left(\frac{\sum_i (X_i - \overline X) \cdot \varepsilon_i}{\sum_i (X_i - \overline X)^2} | X \right)^2 \\ 
    &amp; = \left(\frac{1}{\sum_i (X_i - \overline X)^2}\right)^2 E \left(\sum_i (X_i - \overline X) \cdot \varepsilon_i | X \right)^2 \\
    &amp; = \left(\frac{1}{\sum_i (X_i - \overline X)^2}\right)^2 E \left(\sum_i (X_i - \overline X)^2 \cdot \varepsilon_i^2 + 2 \sum_{i &lt; j} (X_i - \overline X) (X_j - \overline X) \varepsilon_i \varepsilon_j | X \right) \\
    &amp; = \left(\frac{1}{\sum_i (X_i - \overline X)^2}\right)^2 \left(\sum_i (X_i - \overline X)^2 \cdot E(\varepsilon_i^2 | X) \right) \\ 
    &amp; = \frac{\sigma^2}{\sum_i (X_i - \overline X)^2} = \frac{\sigma^2}{S^2_X (n-1)} \\
\end{align*}\]</div>
<p>Note que para estimar esta varianza debemos encontrar un estimador para <span class="math notranslate nohighlight">\(\sigma^2\)</span></p>
</section>
<section id="varianza-de-los-errores">
<h3>2.9.3 Varianza de los Errores<a class="headerlink" href="#varianza-de-los-errores" title="Link to this heading">#</a></h3>
<p>Antes de encontrar un estimador para <span class="math notranslate nohighlight">\(\sigma^2\)</span>, note que</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    V(Y_i | X_i) &amp; = V(\beta_0 + \beta_1 X_i + \varepsilon_i | X) \\
    &amp; = V(\beta_0 + \beta_1 X_i | X) + V(\varepsilon_i | X) + 2 \cdot Cov(\beta_0 + \beta_1 X_i, \varepsilon_i | X) \\
    &amp; = V(\varepsilon_i | X) = \sigma^2 \\
\end{align*}\]</div>
<p>Más aún, observe que</p>
<div class="math notranslate nohighlight">
\[Y_i | X \sim N(\beta_0 + \beta_1 X_i, \sigma^2)\]</div>
<p>Ahora, ya que <span class="math notranslate nohighlight">\(E(\varepsilon_i) = 0\)</span>, podemos mostrar que</p>
<div class="math notranslate nohighlight">
\[V(\varepsilon_i | X) = E(\varepsilon_i^2)\]</div>
<p>Un estimador para <span class="math notranslate nohighlight">\(\sigma^2\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\hat\sigma^2 = \frac{\sum_i e_i^2}{n-K} = \frac{\sum_i (Y_i - \hat Y_i)^2}{n-K} = \frac{\sum_i (Y_i - \hat\beta_0 - \hat\beta_1 X_i)^2}{n-K} \]</div>
<p>Donde <span class="math notranslate nohighlight">\(K\)</span> es el número de parámetros que debemos estimar. En este caso <span class="math notranslate nohighlight">\(K = 2\)</span>.</p>
</section>
<section id="pruebas-de-hipotesis-individuales">
<h3>2.9.4 Pruebas de Hipótesis Individuales<a class="headerlink" href="#pruebas-de-hipotesis-individuales" title="Link to this heading">#</a></h3>
<p>Para nuestra prueba de hipótesis</p>
<div class="math notranslate nohighlight">
\[H_0 : \beta_1 = 0\]</div>
<div class="math notranslate nohighlight">
\[H_1 : \beta_1 \neq 0\]</div>
<p>Usaremos el siguiente estadístico de prueba</p>
<div class="math notranslate nohighlight">
\[T = \frac{\hat\beta_1 - \beta_1}{\text{ee}(\hat\beta_1)}\]</div>
<p>Donde el error estandar de <span class="math notranslate nohighlight">\(\hat\beta_1\)</span> se define como:</p>
<div class="math notranslate nohighlight">
\[\text{ee}(\hat\beta_1) = \sqrt{ \frac{\sum_i e_i^2/n-K}{\sum_i (X_i - \overline X)^2}}\]</div>
<p>Observe que nuestro estadístico <span class="math notranslate nohighlight">\(T \sim t_{n-K}\)</span>. Esto se debe a que <span class="math notranslate nohighlight">\(\hat\beta_1 \sim N(\beta_1, \sigma_{\beta_1})\)</span> y <span class="math notranslate nohighlight">\(\sum_i e_i^2 \sim \chi^2_{n-K}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Estimacion de varianza de los errores</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">cnt</span><span class="p">)</span>
<span class="n">sigma2_hat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="m">-2</span><span class="p">);</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;sigma_hat =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sigma2_hat</span><span class="p">),</span><span class="w"> </span><span class="m">3</span><span class="p">))</span>

<span class="c1">#Estimacion de error estandar de coeficiente</span>
<span class="n">Sx2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="m">-1</span><span class="p">)</span>
<span class="n">se_b1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sigma2_hat</span><span class="o">/</span><span class="n">Sx2</span><span class="p">);</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;SE(b1) =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">se_b1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'sigma_hat = 15333.996'</div><div class="output text_html">'SE(b1) = 33.559'</div></div>
</div>
</section>
<section id="intervalo-de-confianza-para-beta-k">
<h3>2.9.5 Intervalo de confianza para <span class="math notranslate nohighlight">\(\beta_k\)</span><a class="headerlink" href="#intervalo-de-confianza-para-beta-k" title="Link to this heading">#</a></h3>
<p>Nuestro intervalo de confianza para el parámetro desconocido <span class="math notranslate nohighlight">\(\beta_k\)</span> está dado por</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    IC &amp; = \left(\beta_k - t_{\alpha/2 \hspace{2pt},\hspace{2pt} n-K}\cdot\sqrt{ \frac{\sum_i e_i^2/n-K}{\sum_i (X_i - \overline X)^2}} \hspace{5pt} , \hspace{5pt} \beta_k + t_{1-\alpha/2 \hspace{2pt},\hspace{2pt} n - K}\cdot\sqrt{ \frac{\sum_i e_i^2/n-K}{\sum_i (X_i - \overline X)^2}} \right)
\end{align*}\]</div>
<p>Cuando <span class="math notranslate nohighlight">\(n\)</span> es grande, si <span class="math notranslate nohighlight">\(\alpha = 0.05\)</span>, entonces <span class="math notranslate nohighlight">\(|t_{\alpha/2 \hspace{2pt},\hspace{2pt} n-K}| \approx 1.96\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Estadistico t</span>
<span class="bp">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b1</span><span class="o">/</span><span class="n">se_b1</span><span class="p">;</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;t-stat =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>

<span class="c1">#Valores criticos</span>
<span class="n">t_inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="m">0.025</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="m">-2</span><span class="p">)</span><span class="w"> </span>
<span class="n">t_sup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">qt</span><span class="p">(</span><span class="m">1-0.025</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="m">-2</span><span class="p">)</span>
<span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Rechace H0 si T &lt; t_inf ó T &gt; t_sup&quot;</span><span class="p">)</span>
<span class="nf">paste</span><span class="p">(</span><span class="s">&quot;¿Es T &gt; t_sup? &quot;</span><span class="p">,</span><span class="w"> </span><span class="bp">T</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">t_sup</span><span class="p">)</span>

<span class="c1">#P-valor (minimo alpha para no rechazar)</span>
<span class="n">pval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="nf">pt</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="bp">T</span><span class="p">),</span><span class="w"> </span><span class="n">n</span><span class="m">-2</span><span class="p">))</span><span class="o">*</span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;p-valor =&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pval</span><span class="p">)</span>

<span class="c1">#Intervalo de confianza (alpha = 5%)</span>
<span class="n">IC_inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">se_b1</span><span class="o">*</span><span class="n">t_inf</span>
<span class="n">IC_sup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">se_b1</span><span class="o">*</span><span class="n">t_sup</span>
<span class="nf">paste</span><span class="p">(</span><span class="s">&quot;IC(95%) = (&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">IC_inf</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&lt; b1 &lt; &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">IC_sup</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'t-stat = 9.33'</div><div class="output text_html">'Rechace H0 si T &lt; t_inf ó T &gt; t_sup'</div><div class="output text_html"><span style=white-space:pre-wrap>'¿Es T &gt; t_sup?  TRUE'</span></div><div class="output text_html">'p-valor = 6.61692922676593e-14'</div><div class="output text_html"><span style=white-space:pre-wrap>'IC(95%) = ( 246.143830331241 &lt; b1 &lt;  380.006429530505 )'</span></div></div>
</div>
</section>
<section id="coeficiente-de-determinacion-r-2">
<h3>2.9.6 Coeficiente de Determinación: <span class="math notranslate nohighlight">\(R^2\)</span><a class="headerlink" href="#coeficiente-de-determinacion-r-2" title="Link to this heading">#</a></h3>
<p>Una segunda forma de evaluar nuestro modelo es sabiendo qué tanto de <span class="math notranslate nohighlight">\(\boldsymbol{Y}\)</span> puede <span class="math notranslate nohighlight">\(\boldsymbol{X}\)</span> explicar.</p>
<p>Para saber esto debemos hacer lo siguiente:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
Y_i  &amp;= \hat Y_i + e_i \\
Y_i -\bar{Y} &amp;= \hat Y_i -\bar{Y} + e_i \\
\sum_i (Y_i -\bar{Y})^2 &amp;= \sum_i (\hat Y_i -\bar{Y} + e_i)^2 \\
\sum_i (Y_i -\bar{Y})^2 &amp;= \sum_i (\hat Y_i -\bar{Y})^2 + \sum_i e_i^2 + 2 \sum_i e_i (\hat Y_i -\bar{Y}) \\
\sum_i (Y_i -\bar{Y})^2 &amp;= \sum_i (\hat Y_i -\bar{Y})^2 + \sum_i e_i^2
\end{align*}\]</div>
<p>Esto es así porque</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\sum_i e_i (\hat Y_i -\bar{Y}) &amp;= \sum_i e_i \hat Y_i - \bar{Y}\sum e_i \\
&amp;= \sum_i e_i(\hat \beta_0 + \hat \beta_1 X_i) - \bar{Y}\sum e_i = 0
\end{align*}\]</div>
<p>Es decir, a partir de nuestros estimadores de MCO</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\underbrace{\sum_i (Y_i -\bar{Y})^2}_{\text{Varianza Total } (SST)} &amp;= \sum_i (\hat Y_i -\bar{Y})^2 + \sum_i e_i^2 \\
&amp;= \underbrace{\sum_i (\hat Y_i -\bar{Y})^2}_{\text{Varianza Explicada } (SSR)} + \underbrace{\sum_i (Y_i - \hat Y_i)^2}_{\text{Varianza No Explicada } (SSE)}
\end{align*}\]</div>
<p>Luego podemos definir:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
R^2 &amp;= \frac{SSR}{SST} = 1 - \frac{SSE}{SST} \\
&amp;= \frac{\sum_i (\hat Y_i -\bar{Y})^2}{\sum_i (Y_i -\bar{Y})^2} = 1 - \frac{\sum_i (Y_i - \hat Y_i)^2}{\sum_i (Y_i -\bar{Y})^2}
\end{align*}\]</div>
<p>Observe que el coeficiente de determinación está acodato, es decir,</p>
<div class="math notranslate nohighlight">
\[0 \leq R^2 \leq 1\]</div>
<p>Este estadístico <strong>mide qué tanto de la varianza de <span class="math notranslate nohighlight">\(Y\)</span> es explicada por la covariable <span class="math notranslate nohighlight">\(X\)</span></strong></p>
<div class="alert alert-block alert-danger"> 
<b>Nota:</b>
<p>
<p>En el modelo de regresión lineal, el coeficiente de determinación crece a medida que se incluyen más variables explicativas o covariables.</p>
</div>
<p>Para el modelo de regresión simple podemos demostar que</p>
<div class="math notranslate nohighlight">
\[\rho_{Y,X}^2 = R^2\]</div>
<p>donde <span class="math notranslate nohighlight">\(\rho_{Y,X}\)</span> es el coeficiente de correlación entre <span class="math notranslate nohighlight">\(X\)</span> y <span class="math notranslate nohighlight">\(Y\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Varianza total de la variable Y (SST)</span>
<span class="n">SST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">GDP_percapita</span><span class="p">)</span>
<span class="c1">#Varianza Explicada (SSR)</span>
<span class="n">yhat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b1</span><span class="o">*</span><span class="n">datos</span><span class="o">$</span><span class="n">read</span>
<span class="n">SSR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">yhat</span><span class="p">)</span>
<span class="c1">#Varianza No Explicada (SSE)</span>
<span class="n">SSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Residual standard error (sigma_hat) =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">sigma2_hat</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>

<span class="c1">#Bondad de ajuste del modelo (R2)</span>
<span class="n">R2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SSR</span><span class="o">/</span><span class="n">SST</span><span class="p">;</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;R-squared =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'Residual standard error (sigma_hat) = 15334'</div><div class="output text_html">'R-squared = 0.5542'</div></div>
</div>
</section>
<section id="prueba-de-significancia-global">
<h3>2.9.7 Prueba de Significancia Global<a class="headerlink" href="#prueba-de-significancia-global" title="Link to this heading">#</a></h3>
<p>La idea de esta prueba es evaluar si todas las covariables que incluimos en el modelo pueden explicar conjuntamente la variable <span class="math notranslate nohighlight">\(Y\)</span></p>
<p>La prueba de signifiancia global se define como:</p>
<div class="math notranslate nohighlight">
\[H_0 : \beta_1 = \beta_2 = ... = \beta_K = 0\]</div>
<div class="math notranslate nohighlight">
\[H_1 : \text{ al menos un } \beta_k \text{ es diferente de 0}\]</div>
<p>Esta es una prueba de ‘cola derecha,’ por lo tanto la zona de rechazo siempre va a ser a la derecha e igual a <span class="math notranslate nohighlight">\(\alpha\)</span>.</p>
<p>Observe que en el modelo de regresión univariada (o simple), esta prueba es equivalente a:</p>
<div class="math notranslate nohighlight">
\[H_0 : \beta_1 = 0\]</div>
<div class="math notranslate nohighlight">
\[H_1 : \beta_1 \neq 0\]</div>
<p>Para evaluar esta prueba de hipótesis debemos plantear un nuevo estadístico.</p>
<p>Antes de plantear el estadístico de prueba debemos construir los <strong>cuadrados medios</strong>.</p>
<p>Los cuadrados medios se definen <strong>como la correspondiente suma de cuadrados dividido por sus grados de libertad</strong>.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>Suma de Cuadrados</p></th>
<th class="head"><p>G.L.</p></th>
<th class="head"><p>Cuadrados Medios</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Modelo</strong></p></td>
<td><p>$<span class="math notranslate nohighlight">\(\sum(\hat{Y}_i - \bar{Y})^2\)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(K-1\)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\dfrac{\sum(\hat{Y}_i - \bar{Y})^2}{K-1}\)</span>$</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Residuales</strong></p></td>
<td><p>$<span class="math notranslate nohighlight">\(\sum(Y_i - \hat Y_i)^2\)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(N-K\)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\dfrac{\sum(Y_i - \hat Y_i)^2}{N-K}\)</span>$</p></td>
</tr>
<tr class="row-even"><td><p><strong>Total</strong></p></td>
<td><p>$<span class="math notranslate nohighlight">\(\sum(Y_i - \bar{Y})^2\)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(N-1\)</span>$</p></td>
<td><p>$<span class="math notranslate nohighlight">\(\dfrac{\sum(Y_i - \bar{Y})^2}{N-1}\)</span>$</p></td>
</tr>
</tbody>
</table>
</div>
<p>Vamos a llamar los cuadrados medios como:</p>
<div class="math notranslate nohighlight">
\[MSR = SSR/K-1\]</div>
<div class="math notranslate nohighlight">
\[MSE = SSE/N-K\]</div>
<div class="math notranslate nohighlight">
\[MST = SST/N-1\]</div>
<p>Con base en estos estadísticos podemos calcular nuestro estadístico de prueba:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
F_{K-1,N-K} &amp;= \frac{MSR}{MSE} \\
&amp;= \frac{\frac{\sum(\hat Y_i - \bar{Y})^2}{K-1}}{\frac{\sum(Y_i - \hat Y_i)^2}{N-K}}
\end{align*}\]</div>
<p>Observe que</p>
<div class="math notranslate nohighlight">
\[MSE = \frac{\sum(Y_i - \hat Y_i)^2}{N-K} = \hat{\sigma}^2\]</div>
<p><span class="math notranslate nohighlight">\(MSE\)</span> es lo mismo que el estimador de la varianza de los errores. Entonces el <strong>error estándar del modelo</strong> es igual a:</p>
<div class="math notranslate nohighlight">
\[\hat{\sigma} = \sqrt{MSE} = \sqrt{\frac{\sum(y_i - \hat{y}_i)^2}{N-K}}\]</div>
<p>También en regresión simple:</p>
<div class="math notranslate nohighlight">
\[T^2 = F\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Cuadrados medios de la regresion (MSR)</span>
<span class="n">MSR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">yhat</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">yhat</span><span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="m">2-1</span><span class="p">)</span>
<span class="c1">#Cuadrados medios del error (MSE)</span>
<span class="n">MSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="w"> </span><span class="n">e</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="m">-2</span><span class="p">)</span>

<span class="c1">#Estadistico F</span>
<span class="bp">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MSR</span><span class="o">/</span><span class="n">MSE</span><span class="p">;</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;F-stat =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>
<span class="nf">paste</span><span class="p">(</span><span class="s">&quot;F-stat = T^2 = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="bp">T</span><span class="o">^</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;(solo en regresion simple)&quot;</span><span class="p">)</span>

<span class="c1">#P-valor</span>
<span class="n">pval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">-</span><span class="nf">pf</span><span class="p">(</span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="m">2-1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="m">-2</span><span class="p">);</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;pval =&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pval</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'F-stat = 87.03'</div><div class="output text_html"><span style=white-space:pre-wrap>'F-stat = T^2 =  87.03 (solo en regresion simple)'</span></div><div class="output text_html">'pval = 6.60582699651968e-14'</div></div>
</div>
</section>
<section id="prediccion-e-inferencia-para-hat-y-i">
<h3>2.9.8 Predicción e Inferencia para <span class="math notranslate nohighlight">\(\hat Y_i\)</span><a class="headerlink" href="#prediccion-e-inferencia-para-hat-y-i" title="Link to this heading">#</a></h3>
<p>Después de evaluar nuestro modelo podemos usarlo y hacer predicciones:</p>
<div class="math notranslate nohighlight">
\[\hat Y_i = \hat\beta_0 + \hat\beta_1 X_i\]</div>
<p>Es decir, a partir de las observaciones <span class="math notranslate nohighlight">\(X_i\)</span> podemos intentar predecir el valor <span class="math notranslate nohighlight">\(Y_i\)</span>.</p>
<p>Observe que <span class="math notranslate nohighlight">\(\hat Y_i\)</span> es una variable aleatoria y debemos hacer inferencia sobre este resultado.</p>
<p>Se pueden computar dos tipos de intervalos de confianza:</p>
<ol class="arabic simple">
<li><p>Un intervalo sobre la predicción media o <span class="math notranslate nohighlight">\(E(Y|X)\)</span></p></li>
<li><p>Un intervalo para hacer predicción sobre un valor individual <span class="math notranslate nohighlight">\(\hat Y_i\)</span></p></li>
</ol>
</section>
<section id="prediccion-media">
<h3>2.9.9 Predicción Media<a class="headerlink" href="#prediccion-media" title="Link to this heading">#</a></h3>
<p>Cuando hacemos predicción sobre la media estamos interesados en sacar un intervalo para el <span class="math notranslate nohighlight">\(E[Y_0|X_0] = \beta_0 + \beta_1 X_0 \)</span>.</p>
<p>Para esto recordemos primero que <span class="math notranslate nohighlight">\(\hat{y}_i\)</span> es un estimador de <span class="math notranslate nohighlight">\(E[Y|X]\)</span>.</p>
<p>Necesitamos entonces la distribución de <span class="math notranslate nohighlight">\(\hat{y}_i\)</span>. Podemos demostrar que:</p>
<div class="math notranslate nohighlight">
\[\hat{y}_0 \sim N(\beta_0 + \beta_1 x_0,Var(\hat{y}_0))\]</div>
<p>Donde</p>
<div class="math notranslate nohighlight">
\[Var(\hat{y}_0) = \sigma^2 \left[ \frac{1}{n} + \frac{ (x_0 - \bar{x})^2}{\sum x_i^2}\right]\]</div>
<p>Entonces reemplazando con <span class="math notranslate nohighlight">\(s^2\)</span>, podemos construir un estimador <span class="math notranslate nohighlight">\(t\)</span> tal que:</p>
<div class="math notranslate nohighlight">
\[t_{n-K} = \frac{\hat{y}_0 - (\beta_0 + \beta_1 x_0)}{ee(\hat{y}_0)}\]</div>
<p>Podemos también sacar un IC:</p>
<div class="math notranslate nohighlight">
\[\hat{y} \pm t_{\alpha/2} \cdot ee(\hat{y}_0)\]</div>
</section>
<section id="prediccion-individual">
<h3>2.9.10 Predicción Individual<a class="headerlink" href="#prediccion-individual" title="Link to this heading">#</a></h3>
<p>Queremos sacar un intervalo para un punto en particular <span class="math notranslate nohighlight">\(y_0 = \beta_1 + \beta_2 x_0 + \epsilon_0\)</span></p>
<p><strong>Este intervalo va a ser más grande!</strong></p>
<p>En este caso, <span class="math notranslate nohighlight">\(\hat{y}_0\)</span> será de nuevo nuestro estimador, pero la varianza va a estar dada por la varianza del error de predicción:</p>
<div class="math notranslate nohighlight">
\[Var(y_0 - \hat{y}_0) = \sigma^2 \left[ 1 + \frac{1}{n} + \frac{ (x_0 - \bar{x})^2}{\sum x_i^2}\right]\]</div>
<p>Y el estadístico de prueba estará dado por:</p>
<div class="math notranslate nohighlight">
\[t = \frac{y_0 - \hat{y}_0}{ee(y_0 - \hat{y}_0)}\]</div>
</section>
</section>
<section id="estimacion-por-maxima-verosimilitud">
<h2>2.10 Estimación por Máxima Verosimilitud<a class="headerlink" href="#estimacion-por-maxima-verosimilitud" title="Link to this heading">#</a></h2>
<p>Para estimar los coeficientes <span class="math notranslate nohighlight">\(\beta_k\)</span> también podemos usar el método de máxima verosimilitud.</p>
<p>Recuerde que asumimos que <span class="math notranslate nohighlight">\(\varepsilon_i | X \sim N(0, \sigma^2)\)</span>. Esto que implica que</p>
<div class="math notranslate nohighlight">
\[Y_i | X \sim N(\mu_i, \sigma^2)\]</div>
<p>Donde <span class="math notranslate nohighlight">\(\mu_i = \beta_0 + \beta_1 X_i\)</span>. Ya que asumimos que <span class="math notranslate nohighlight">\(\varepsilon_i\)</span> y <span class="math notranslate nohighlight">\(\varepsilon_j\)</span> son independientes para todo <span class="math notranslate nohighlight">\(i\)</span> y <span class="math notranslate nohighlight">\(j\)</span>, la función de verosimilitud está dada por</p>
<div class="math notranslate nohighlight">
\[\mathcal{L}(\beta_0, \beta_1, \sigma^2) = f(Y_1, Y_2,..., Y_n) = \prod_{i = 1}^n \frac{1}{\sqrt{2\pi\sigma^2}} \exp \left\{ - \frac{1}{2\sigma^2} (Y_i - \beta_0 - \beta_1 X_i)^2 \right\}\]</div>
<p>Si tomamos el logaritmo de la función de verosimilitud obtenemos:</p>
<div class="math notranslate nohighlight">
\[\mathcal{l}(\beta_0, \beta_1, \sigma^2) =  - \frac{n}{2} \ln(2\pi\sigma^2) - \frac{1}{2\sigma^2} \sum_{i = 1}^n (Y_i - \beta_0 - \beta_1 X_i)^2\]</div>
<p>Maximizando <span class="math notranslate nohighlight">\(\mathcal{l}(\beta_0, \beta_1, \sigma^2)\)</span> respecto a <span class="math notranslate nohighlight">\(\beta_0\)</span> y <span class="math notranslate nohighlight">\(\beta_1\)</span>, encontramos que</p>
<div class="math notranslate nohighlight">
\[\hat\beta_0 = \overline Y - \hat\beta_1 \overline X\]</div>
<div class="math notranslate nohighlight">
\[\hat\beta_1 = \frac{\sum_i (X_i - \overline X)(Y_i - \overline Y)}{\sum_i (X_i - \overline X)^2} = \frac{\mathbb{\hat Cov}(X, Y)}{\mathbb{\hat V}(X)}\]</div>
<p>Observe que estos son precisamente los estimadores que obtuvimos a través de MCO, y ya conocemos las propiedades de estos estimadores.</p>
</section>
<section id="modelo-de-regresion-multiple">
<h2>2.11 Modelo de Regresión Multiple<a class="headerlink" href="#modelo-de-regresion-multiple" title="Link to this heading">#</a></h2>
<p>Un modelo de regresión con múltiples covariables o predictores se puede escribir de la siguiente manera:</p>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \beta_1 x_{1,i} + ... + \beta_{k-1} x_{k-1, i} + \varepsilon_i\]</div>
<p>Observe que queremos estimar <span class="math notranslate nohighlight">\(k\)</span> parámetros (incluyendo a <span class="math notranslate nohighlight">\(\beta_0\)</span>), usando <span class="math notranslate nohighlight">\(k-1\)</span> covariables a partir de una base de datos con <span class="math notranslate nohighlight">\(n\)</span> observaciones</p>
<div class="math notranslate nohighlight">
\[\{y_i, x_{1,i}, x_{2,i}, ..., x_{k-1,i}\}_{i=1}^n\]</div>
<p>Pero antes de derivar los estimadores de los parámetros <span class="math notranslate nohighlight">\(\beta_j\)</span>, veamos una aplicación:</p>
<section id="modelo-en-forma-matricial">
<h3>2.11.1 Modelo en Forma Matricial<a class="headerlink" href="#modelo-en-forma-matricial" title="Link to this heading">#</a></h3>
<p>En forma matricial, nuestro modelo de regresión se puede escribir de la siguiente forma:</p>
<div class="math notranslate nohighlight">
\[Y = X\beta + \varepsilon\]</div>
<p>Observe que tenemos cuatro matrices:</p>
<div class="math notranslate nohighlight">
\[
Y_{[n \times 1]} = X_{[n \times k]} \, \beta_{[k \times 1]} + \varepsilon_{[n \times 1]}
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
y_1 \\
y_2 \\
\vdots \\
y_n
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; x_{11} &amp; x_{21} &amp; \dots &amp; x_{k-1,1} \\
1 &amp; x_{12} &amp; x_{22} &amp; \dots &amp; x_{k-1,2} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; x_{1n} &amp; x_{2n} &amp; \dots &amp; x_{k-1,n}
\end{bmatrix}
\begin{bmatrix}
\beta_0 \\
\beta_1 \\
\vdots \\
\beta_{k-1}
\end{bmatrix}
+
\begin{bmatrix}
\varepsilon_1 \\
\varepsilon_2 \\
\vdots \\
\varepsilon_n
\end{bmatrix}
\end{split}\]</div>
<p>La forma matricial es una manera útil de presentar <span class="math notranslate nohighlight">\(n\)</span> <strong>ecuaciones</strong>, ya que:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
y_1 \\
y_2 \\
\vdots \\
y_n
\end{bmatrix}
=
\begin{bmatrix}
\beta_0 + \sum_j^{k-1} \beta_j x_{j1} + \varepsilon_1 \\
\beta_0 + \sum_j^{k-1} \beta_j x_{j2} + \varepsilon_2 \\
\vdots \\
\beta_0 + \sum_j^{k-1} \beta_j x_{jn} + \varepsilon_n
\end{bmatrix}
\end{split}\]</div>
</section>
<section id="supuestos-en-forma-matricial">
<h3>2.11.2 Supuestos en forma Matricial<a class="headerlink" href="#supuestos-en-forma-matricial" title="Link to this heading">#</a></h3>
<p>¿Cómo se ven los supuestos sobre el error cuando tenemos matrices?</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\varepsilon \varepsilon' =
\begin{bmatrix}
\varepsilon_1 \\
\varepsilon_2 \\
\vdots \\
\varepsilon_n
\end{bmatrix}
\begin{bmatrix}
\varepsilon_1 &amp; \varepsilon_2 &amp; \dots &amp; \varepsilon_n
\end{bmatrix}
=
\begin{bmatrix}
\varepsilon_1^2 &amp; \varepsilon_1\varepsilon_2 &amp; \dots &amp; \varepsilon_1\varepsilon_n \\
\varepsilon_2\varepsilon_1 &amp; \varepsilon_2^2 &amp; \dots &amp; \varepsilon_2\varepsilon_n \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\varepsilon_n\varepsilon_1 &amp; \varepsilon_n\varepsilon_2 &amp; \dots &amp; \varepsilon_n^2
\end{bmatrix}
\end{split}\]</div>
<p>Observe que bajo homoscedasticidad y no autocorrelación:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
E[\varepsilon \varepsilon'] =
\begin{bmatrix}
\sigma^2 &amp; 0 &amp; \dots &amp; 0 \\
0 &amp; \sigma^2 &amp; \dots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \dots &amp; \sigma^2
\end{bmatrix}
= \sigma^2 I_n
\end{split}\]</div>
<p>Si asumimos independencia condicional y además que los errores son normales, entonces:</p>
<div class="math notranslate nohighlight">
\[E(\varepsilon | x_1, ...., x_{k-1}) = E(\varepsilon | X) = 0\]</div>
<div class="math notranslate nohighlight">
\[\varepsilon \sim N(0, \sigma^2 I_n)\]</div>
</section>
</section>
<section id="minimos-cuadrados-ordinarios">
<h2>2.12 Mínimos Cuadrados Ordinarios<a class="headerlink" href="#minimos-cuadrados-ordinarios" title="Link to this heading">#</a></h2>
<p>Antes de derivar nuestros estimadores de mínimos cuadrados usando matrices, veremos que es posible encontrar los estimadores de manera similar que en el caso de regresión simple. Nuestro modelo está dado por:</p>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \sum_{j = 1}^{k-1} \beta_j x_{j,i} + \varepsilon_i\]</div>
<p>Así, definimos la función de perdida cómo:</p>
<div class="math notranslate nohighlight">
\[\mathcal{L}(\beta_0, ..., \beta_{k-1}) = \sum_i^n \varepsilon_i^2 = \sum_i^n \left(y_i - \beta_0 - \sum_{j = 1}^{k-1} \beta_j x_{j,i} \right)^2\]</div>
<p>Para encontrar los estimadores de MCO para <span class="math notranslate nohighlight">\(\beta_0, ..., \beta_{k-1}\)</span> debemos resolver el siguiente problema:</p>
<div class="math notranslate nohighlight">
\[\min_{\beta_0, ..., \beta_{k-1}} \mathcal{L}(\beta_0, ..., \beta_{k-1}) = \sum_i^n \varepsilon_i^2\]</div>
<p>Las condiciones de primer orden para este problema están dadas por:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{L}}{\partial\beta_0} \bigg|_{\hat\beta} = \sum_i (-2) \cdot ({y_i} - \beta_0 - \sum_{j = 1}^{k-1} \beta_j x_{j,i}) \bigg|_{\hat\beta} = 0\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{L}}{\partial\beta_1} \bigg|_{\hat\beta} = \sum_i (-2 x_{1,i}) \cdot ({y_i} - \beta_0 \sum_{j = 1}^{k-1} \beta_j x_{j,i}) \bigg|_{\hat\beta} = 0\]</div>
<div class="math notranslate nohighlight">
\[\vdots\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{L}}{\partial\beta_{k-1}} \bigg|_{\hat\beta} = \sum_i (-2 x_{k-1,i}) \cdot ({y_i} - \beta_0 - \sum_{j = 1}^{k-1} \beta_j x_{j,i}) \bigg|_{\hat\beta} = 0\]</div>
<p>Observe que tenemos <span class="math notranslate nohighlight">\(k\)</span> ecuaciones para estimar <span class="math notranslate nohighlight">\(k\)</span> parámetros.</p>
<p>Lo anterior nos permite concluir que este sistema de ecuaciones tiene solución. Sin embargo, solucionarlo alegabraicamente puede ser bastante tedioso. Por esta razón usaremos matrices.</p>
</section>
<section id="estimacion-de-beta">
<h2>2.13 Estimación de <span class="math notranslate nohighlight">\(\beta\)</span><a class="headerlink" href="#estimacion-de-beta" title="Link to this heading">#</a></h2>
<p>Observe que matricialmente podemos escribir</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\varepsilon' \varepsilon =
\begin{bmatrix}
\varepsilon_1 &amp; \varepsilon_2 &amp; \dots &amp; \varepsilon_n
\end{bmatrix}_{1 \times n}
\begin{bmatrix}
\varepsilon_1 \\
\varepsilon_2 \\
\vdots \\
\varepsilon_n
\end{bmatrix}_{\hspace{2pt} n \times 1} = 
\varepsilon_1^2 + \varepsilon_2^2 + ... + \varepsilon_n^2 =
\sum_{i = 1}^n \varepsilon_i^2
\end{split}\]</div>
<p>Luego nuestro problema de minimización se puede reescribir de la siguiente manera:</p>
<div class="math notranslate nohighlight">
\[\min_\beta \varepsilon'\varepsilon = \min_\beta (Y - X\beta)'(Y - X\beta) = \min_\beta Y'Y - 2\beta'X'Y + \beta' X'X\beta\]</div>
<p>Nota: <span class="math notranslate nohighlight">\(Y'X\beta = \beta'X'Y\)</span> ya que son escalares.</p>
<p>Las condiciones de primer orden están dadas por</p>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{(\varepsilon'\varepsilon)}}{\partial\beta} \bigg|_{\beta = \hat \beta} = -2 X'Y + 2 X'X\hat\beta = 0\]</div>
<p>Esto es así porque <span class="math notranslate nohighlight">\(\frac{\partial(X'Y)'\beta}{\partial\beta} = X'Y\)</span>, <span class="math notranslate nohighlight">\(\frac{\partial \beta' X'X\beta}{\partial\beta} = (X'X + (X'X)')\beta = 2X'X\beta\)</span></p>
<p>De esta manera, el estimador de MCO para <span class="math notranslate nohighlight">\(\beta\)</span> es</p>
<div class="math notranslate nohighlight">
\[\hat\beta = (X'X)^{-1}(X'Y)\]</div>
<p>Observe que a partir de las condiciones de primer orden podemos determinar que</p>
<div class="math notranslate nohighlight">
\[0 = X'Y - X'X\hat\beta = X'(Y - X'X\hat\beta) = X'e\]</div>
<section id="matrices-y-sumatorias">
<h3>2.13.1 Matrices y Sumatorias<a class="headerlink" href="#matrices-y-sumatorias" title="Link to this heading">#</a></h3>
<p>La matriz <span class="math notranslate nohighlight">\((X'X)^{-1}\)</span> es conocida usalmente como <strong>matriz de información</strong>. Observe que</p>
<div class="math notranslate nohighlight">
\[\begin{split}
X'X =
\begin{bmatrix}
n &amp; \sum_i x_{1i} &amp; \sum_i x_{2i} &amp; \sum_i x_{3i} &amp; \cdots &amp; \sum_i x_{k-1, i} \\
\sum_i x_{1i} &amp; \sum_i x_{1i}^2 &amp; \sum_i x_{1i}x_{2i} &amp; \sum_i x_{1i}x_{3i} &amp; \cdots &amp; \sum_i x_{1i}x_{k-1,i} \\
\sum_i x_{2i} &amp; \sum_i x_{2i}x_{1i} &amp; \sum_i x_{2i}^2 &amp; \sum_i x_{2i}x_{3i} &amp; \cdots &amp; \sum_i x_{2i}x_{k-1,i} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\sum_i x_{k-1,i} &amp; \sum_i x_{k-1,i}x_{1i} &amp; \sum_i x_{k-1,i}x_{2i} &amp; \sum_i x_{k-1,i}x_{3i} &amp; \cdots &amp; \sum_i x_{k-1,i}^2
\end{bmatrix} \hspace{5pt},\hspace{5pt} X'Y =
\begin{bmatrix}
\sum_i y_i \\
\sum_i x_{1i}y_i \\
\sum_i x_{2i}y_i \\
\vdots \\
\sum_i x_{k-1,i}y_i
\end{bmatrix}
\end{split}\]</div>
</section>
<section id="ejemplo">
<h3>2.13.2 Ejemplo<a class="headerlink" href="#ejemplo" title="Link to this heading">#</a></h3>
<p>Usando los siguientes datos queremos estimar el modelo <span class="math notranslate nohighlight">\(Y = X\beta + \varepsilon\)</span>, donde <span class="math notranslate nohighlight">\(\beta = [\beta_0,  \beta_1]'\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Y =
\begin{bmatrix}
8 \\
9 \\
4 \\
2 \\
7 \\
3 \\
\end{bmatrix} \hspace{2pt},\hspace{2pt} X =
\begin{bmatrix}
1 &amp; 4 \\
1 &amp; 3 \\
1 &amp; 10 \\
1 &amp; 11 \\
1 &amp; 6 \\
1 &amp; 9 \\
\end{bmatrix}
\end{split}\]</div>
<p>A partir de esta información debemos calcular las siguientes matrices:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
X'X =
\begin{bmatrix}
6 &amp; 43 \\
43 &amp; 363 \\
\end{bmatrix} \hspace{2pt},\hspace{2pt} (X'X)^{-1} = \frac{1}{329} \cdot
\begin{bmatrix}
363 &amp; -43 \\
-43 &amp; 6 \\
\end{bmatrix} \hspace{2pt},\hspace{2pt} X'Y =
\begin{bmatrix}
33 \\
190 \\
\end{bmatrix}
\end{split}\]</div>
<p>Recuerde que nuestro estimador de <span class="math notranslate nohighlight">\(\beta\)</span> es <span class="math notranslate nohighlight">\(\hat \beta = (X'X)^{-1}X'Y\)</span>. Así,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat\beta = \frac{1}{329} \cdot
\begin{bmatrix}
363 &amp; -43 \\
-43 &amp; 6 \\
\end{bmatrix} \cdot
\begin{bmatrix}
33 \\
190 \\
\end{bmatrix} =
\begin{bmatrix}
11.5775076 \\
-0.8480243 \\
\end{bmatrix}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Datos</span>
<span class="n">Y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
<span class="n">x1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="n">x2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">11</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">)</span>
<span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">)</span>

<span class="c1">#Matrices</span>
<span class="n">XX</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">%*%</span><span class="n">X</span>
<span class="n">XX1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
<span class="n">XY</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">%*%</span><span class="n">Y</span>

<span class="c1">#Estimacion de coeficientes de la regresion</span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XX1</span><span class="o">%*%</span><span class="n">XY</span><span class="p">;</span><span class="w"> </span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A matrix: 2 × 1 of type dbl</caption>
<tbody>
	<tr><th scope=row>x1</th><td>11.5775076</td></tr>
	<tr><th scope=row>x2</th><td>-0.8480243</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Estimar la regresion (excluyendo constante)</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Y ~ 0 + x1 + x2)

Residuals:
       1        2        3        4        5        6 
-0.18541 -0.03343  0.90274 -0.24924  0.51064 -0.94529 

Coefficients:
   Estimate Std. Error t value Pr(&gt;|t|)    
x1 11.57751    0.75506  15.333 0.000106 ***
x2 -0.84802    0.09707  -8.736 0.000946 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7188 on 4 degrees of freedom
Multiple R-squared:  0.9907,	Adjusted R-squared:  0.9861 
F-statistic: 213.8 on 2 and 4 DF,  p-value: 8.59e-05
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Estimar la regresion</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Y ~ x2)

Residuals:
       1        2        3        4        5        6 
-0.18541 -0.03343  0.90274 -0.24924  0.51064 -0.94529 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.57751    0.75506  15.333 0.000106 ***
x2          -0.84802    0.09707  -8.736 0.000946 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7188 on 4 degrees of freedom
Multiple R-squared:  0.9502,	Adjusted R-squared:  0.9377 
F-statistic: 76.31 on 1 and 4 DF,  p-value: 0.0009461
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="propiedades-de-hat-beta">
<h2>2.14 Propiedades de <span class="math notranslate nohighlight">\(\hat\beta\)</span><a class="headerlink" href="#propiedades-de-hat-beta" title="Link to this heading">#</a></h2>
<p>Mostremos ahora <span class="math notranslate nohighlight">\(E(\hat\beta) = \beta\)</span>. Observe que</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\hat\beta &amp;= (X'X)^{-1}X'Y \\
&amp;= (X'X)^{-1}X'(X\beta + \varepsilon) \\
&amp;= (X'X)^{-1}X'X\beta + (X'X)^{-1}X'\varepsilon) \\
&amp;= \beta + (X'X)^{-1}X'\varepsilon \\
\end{align*}\]</div>
<p>Luego, es fácil ver que</p>
<div class="math notranslate nohighlight">
\[E(\hat\beta | X) = \beta + (X'X)^{-1}X'E(\varepsilon | X)\]</div>
<p>Por el supuesto de independencia condicional <span class="math notranslate nohighlight">\(E(\varepsilon | X) = 0\)</span>. Lo que implica que <span class="math notranslate nohighlight">\(E(\hat\beta | X) = \beta\)</span></p>
<p>Por la ley de esperanzas iteradas podemos demostrar que</p>
<div class="math notranslate nohighlight">
\[E[E(\hat\beta | X)] = E[\hat\beta] = \beta\]</div>
</section>
<section id="matriz-de-varianza-y-covarianza">
<h2>2.15 Matriz de Varianza y Covarianza<a class="headerlink" href="#matriz-de-varianza-y-covarianza" title="Link to this heading">#</a></h2>
<p>Ahora queremos determinar la varianza de <span class="math notranslate nohighlight">\(\hat\beta\)</span>, en forma matricial procedemos de la siguiente manera:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
V(\hat{\beta}|X ) &amp;= E \big[(\hat{\beta} - E[\hat{\beta}])(\hat{\beta} - E[\hat{\beta}])' \,|\, X \big] \\
&amp;= E \big[(\beta + (X'X)^{-1}X'\varepsilon - \beta])(\beta + (X'X)^{-1}X'\varepsilon - \beta])' \,|\, X \big] \\
&amp;= E \big[((X'X)^{-1}X'\varepsilon)((X'X)^{-1}X'\varepsilon)' \,|\, X \big] \\
&amp;= E \big[(X'X)^{-1}X'\varepsilon\varepsilon'X(X'X)^{-1} \,|\, X \big] \\
&amp;= (X'X)^{-1}X' E[\varepsilon\varepsilon'|X] X (X'X)^{-1} \\
&amp;= (X'X)^{-1}X' \sigma^2 I X (X'X)^{-1} \\
&amp;=\sigma^2 (X'X)^{-1}X'X (X'X)^{-1} \\
&amp;= \sigma^2 (X'X)^{-1}
\end{align*}\]</div>
<p>Observe que la solución anterior no solo nos permite encontrar las varianzas para cada <span class="math notranslate nohighlight">\(\hat\beta_j\)</span>, <span class="math notranslate nohighlight">\(j \in \{0, 1, ..., k-1\}\)</span>, sino también la covarianza entre <span class="math notranslate nohighlight">\(\hat\beta_j\)</span> y <span class="math notranslate nohighlight">\(\hat\beta_l\)</span> para todo <span class="math notranslate nohighlight">\(j \neq l\)</span>. Es decir,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
V(\hat{\beta} | X) =
\begin{bmatrix}
Var(\hat{\beta}_0) &amp; Cov(\hat{\beta}_0, \hat{\beta}_1) &amp; \dots &amp; Cov(\hat{\beta}_0, \hat{\beta}_K) \\
Cov(\hat{\beta}_1, \hat{\beta}_0) &amp; Var(\hat{\beta}_1) &amp; \dots &amp; Cov(\hat{\beta}_1, \hat{\beta}_K) \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
Cov(\hat{\beta}_K, \hat{\beta}_0) &amp; Cov(\hat{\beta}_K, \hat{\beta}_1) &amp; \dots &amp; Var(\hat{\beta}_K)
\end{bmatrix} = \sigma^2 (X'X)^{-1}
\end{split}\]</div>
<p>Recuerde que un estimador para <span class="math notranslate nohighlight">\(\sigma^2\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\hat\sigma^2 = \frac{\sum_i e_i^2}{n-k} = \frac{e'e}{n-k}\]</div>
<p>Entonces,</p>
<div class="math notranslate nohighlight">
\[\widehat{V(\hat{\beta} | X)} = \frac{e'e}{n-k}(X'X)^{-1}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Residuales de la regresion (Continuación del ejemplo 2.13.2)</span>
<span class="n">Yhat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="o">%*%</span><span class="n">b</span>
<span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">-</span><span class="w">  </span><span class="n">Yhat</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="n">sigma2_hat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">%*%</span><span class="n">e</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="m">-2</span><span class="p">));</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;sigma2_hat = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">sigma2_hat</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="m">5</span><span class="p">))</span>

<span class="c1">#Matriz de varianza covarianza</span>
<span class="n">var_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sigma2_hat</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="o">*</span><span class="n">XX1</span><span class="p">;</span><span class="w"> </span><span class="n">var_b</span>

<span class="c1">#Error estandar de b1</span>
<span class="n">se_b1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">var_b</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">]);</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;SE(b1) = (0.009423416)^(1/2) =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">se_b1</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style=white-space:pre-wrap>'sigma2_hat =  0.51672'</span></div><div class="output text_html"><table class="dataframe">
<caption>A matrix: 2 × 2 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>x1</th><th scope=col>x2</th></tr>
</thead>
<tbody>
	<tr><th scope=row>x1</th><td> 0.57011668</td><td>-0.067534483</td></tr>
	<tr><th scope=row>x2</th><td>-0.06753448</td><td> 0.009423416</td></tr>
</tbody>
</table>
</div><div class="output text_html">'SE(b1) = (0.009423416)^(1/2) = 0.09707'</div></div>
</div>
<p>En nuestro ejemplo anterior</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Y = [8, 9, 4, 2, 7, 3]' \hspace{5pt},\hspace{5pt}
(X'X)^{-1} = \frac{1}{329} \cdot
\begin{bmatrix}
363 &amp; -43 \\
-43 &amp; 6 \\
\end{bmatrix} \hspace{5pt},\hspace{5pt} \hat\beta =
\begin{bmatrix}
11.58 \\
-0.85 \\
\end{bmatrix}
\end{split}\]</div>
<p>Usando esta información podemos calcular:</p>
<div class="math notranslate nohighlight">
\[\hat Y = X\hat\beta = [8.18, 9.03, 3.10, 2.25, 6.49, 3.94]\]</div>
<div class="math notranslate nohighlight">
\[e = Y - \hat Y = [-0.18, -0.03, 0.90, -0.25, 0.51, -0.94]\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\hat\sigma^2=\frac{e'e}{6-2} \approx 0.516 \hspace{5pt},\hspace{5pt} \widehat{V(\hat\beta)} = \hat\sigma^2 \cdot (X'X)^{-1} = \frac{1}{329} \cdot
\begin{bmatrix}
363 &amp; -43 \\
-43 &amp; 6 \\
\end{bmatrix} \approx
\begin{bmatrix}
0.570 &amp; -0.0675 \\
-0.0675 &amp; 0.009 \\
\end{bmatrix}\end{split}\]</div>
<p>Luego, ee<span class="math notranslate nohighlight">\((\beta_0) = \sqrt{0.570} = 0.7551\)</span>, ee<span class="math notranslate nohighlight">\((\beta_1) = \sqrt{0.009} = 0.0971\)</span>, <span class="math notranslate nohighlight">\(Cov(\beta_0, \beta_1) = -0.0675\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Crear una variable aleatoria independiente (ruido)</span>
<span class="n">x3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.401</span><span class="p">,</span><span class="w"> </span><span class="m">0.764</span><span class="p">,</span><span class="w"> </span><span class="m">0.889</span><span class="p">,</span><span class="w"> </span><span class="m">0.430</span><span class="p">,</span><span class="w"> </span><span class="m">0.076</span><span class="p">,</span><span class="w"> </span><span class="m">0.883</span><span class="p">)</span>

<span class="c1">#Estimar regresion</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Y ~ x2 + x3)

Residuals:
      1       2       3       4       5       6 
-0.2258  0.0804  1.0030 -0.3415  0.3222 -0.8383 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  11.7419     0.9768  12.021  0.00124 **
x2           -0.8390     0.1129  -7.428  0.00505 **
x3           -0.3998     1.1494  -0.348  0.75093   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.8138 on 3 degrees of freedom
Multiple R-squared:  0.9521,	Adjusted R-squared:  0.9202 
F-statistic: 29.83 on 2 and 3 DF,  p-value: 0.01047
</pre></div>
</div>
</div>
</div>
</section>
<section id="pruebas-de-significancia-individual">
<h2>2.16 Pruebas de Significancia Individual<a class="headerlink" href="#pruebas-de-significancia-individual" title="Link to this heading">#</a></h2>
<p>Para evaluar nuestro modelo, podemos considerar pruebas de hipótesis individuales para cada uno de los parámetros desconocidos <span class="math notranslate nohighlight">\(\beta_j\)</span>. Es decir, para todo <span class="math notranslate nohighlight">\(j \in \{0, ..., k-1\}\)</span> evaluamos:</p>
<div class="math notranslate nohighlight">
\[H_0 : \beta_j = 0\]</div>
<div class="math notranslate nohighlight">
\[H_1 : \beta_j \neq 0\]</div>
<p>Ya que asumimos que <span class="math notranslate nohighlight">\(\varepsilon  \sim N\left(0, \sigma^2 I\right)\)</span>, nuestros estimadores <span class="math notranslate nohighlight">\(\hat\beta \sim N\left(\beta, \sigma^2(X'X)^{-1}\right)\)</span>. Así, para evaluar nuestra hipótesis podemos usar el estadístico de prueba:</p>
<div class="math notranslate nohighlight">
\[T = \frac{\hat\beta_j}{\text{ee}(\hat\beta_j)} \sim t_{n-k}\]</div>
<p>Observe que <span class="math notranslate nohighlight">\(\text{ee}(\hat\beta_j)\)</span> se puede computar a partir de la matriz <span class="math notranslate nohighlight">\(\hat\sigma^2 (X'X)^{-1}\)</span>.</p>
</section>
<section id="bondad-de-ajuste-r-2-y-r-2-ajustado">
<h2>2.17 Bondad de Ajuste: <span class="math notranslate nohighlight">\(R^2\)</span> y <span class="math notranslate nohighlight">\(R^2\)</span>-Ajustado<a class="headerlink" href="#bondad-de-ajuste-r-2-y-r-2-ajustado" title="Link to this heading">#</a></h2>
<p>Al igual que en el caso de regresión simple, definimos</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
R^2 &amp;= \frac{\sum_i (\hat y_i -\bar{y})^2}{\sum_i (y_i -\bar{y})^2} = 1 - \frac{\sum_i (y_i - \hat y_i)^2}{\sum_i (y_i -\bar{y})^2} \\
&amp;= \frac{SSR}{SST} = 1 - \frac{SSE}{SST} 
\end{align*}\]</div>
<p>Sin embargo, <span class="math notranslate nohighlight">\(R^2\)</span> <strong>aumentará siempre que incluyamos una covariable adicional</strong>. Incluso si dicha covariable es ‘ruido’.</p>
<p>En el caso de regresión múltiple definimos un coeficiente ‘penaliza’ el poder predictivo del modelo cuando incluimos variables irrelevantes:</p>
<div class="math notranslate nohighlight">
\[R^2\text{- ajustado} = 1 - \frac{SSE\hspace{2pt}/\hspace{2pt}(n-k)}{SST\hspace{2pt}/\hspace{2pt}(n-1)}\]</div>
<p>Observe que al incluir una variable irrelevante, los residuales de nuestro modelo <span class="math notranslate nohighlight">\(e_i = y_i - \hat y_i\)</span> no cambiarán de manera considerable (con respecto al modelo que no incluye ruido). Sin embargo, ahora estamos dividiendo <span class="math notranslate nohighlight">\(SSE\)</span> por <span class="math notranslate nohighlight">\(n-k\)</span> (que penaliza el número de parámetros que queremos estimar).</p>
<p>Así, mientras <span class="math notranslate nohighlight">\(R^2\)</span> aumenta con el número de variables, <span class="math notranslate nohighlight">\(R^2\)</span>-ajustado puede disminuir. Veamos un ejemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#(Continuación del ejemplo 2.13.2)</span>
<span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">x3</span><span class="p">)</span>
<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">%*%</span><span class="n">X</span><span class="p">)</span><span class="o">%*%</span><span class="p">(</span><span class="nf">t</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">%*%</span><span class="n">Y</span><span class="p">)</span>
<span class="n">Yhat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="o">%*%</span><span class="n">b</span>
<span class="n">e</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Yhat</span>
<span class="c1">#Varianza total de la variable Y (SST)</span>
<span class="n">SST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="m">-1</span><span class="p">)</span>
<span class="c1">#Varianza Explicada (SSR)</span>
<span class="n">SSR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">Yhat</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="m">-1</span><span class="p">)</span>
<span class="c1">#Varianza No Explicada (SSE)</span>
<span class="n">SSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">var</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">n</span><span class="m">-1</span><span class="p">)</span>

<span class="c1">#Bondad de ajuste del modelo (R2)</span>
<span class="n">R2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SSR</span><span class="o">/</span><span class="n">SST</span><span class="p">;</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;R2 =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>
<span class="n">R2_adj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">SSE</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="m">-3</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">SST</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="m">-1</span><span class="p">));</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;R2 Ajustado =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">R2_adj</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'R2 = 0.9521'</div><div class="output text_html">'R2 Ajustado = 0.9202'</div></div>
</div>
</section>
<section id="prueba-de-signifiancia-global">
<h2>2.18 Prueba de Signifiancia Global<a class="headerlink" href="#prueba-de-signifiancia-global" title="Link to this heading">#</a></h2>
<p>Al igual que en el caso de regresión simple, queremos evaluar el modelo de manera conjunta. Para ello consideramos la siguiente prueba de hipótesis:</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_1 = \beta_2 = ... = \beta_{k-1}\]</div>
<div class="math notranslate nohighlight">
\[H_1: \beta_j \neq 0 \text{ para cualquier } j \in \{1, ..., k-1\}\]</div>
<p>Nuestro estadístico de prueba para evaluar esta hipótesis es:</p>
<div class="math notranslate nohighlight">
\[F = \frac{MSR}{MSE} = \frac{SSR/(k-1)}{SSE/(n-k)} = \frac{\sum_i(\hat y_i - \bar{y})^2/(k-1)}{\sum_i(y_i - \hat y_i)^2/(n-k)} \sim F_{k-1,n-k}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#(Continuación del ejemplo 2.13.2)</span>
<span class="c1"># Cuadrados medios de la regresion (MSR)</span>
<span class="n">MSR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">Yhat</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">Yhat</span><span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="m">3-1</span><span class="p">)</span>
<span class="c1">#Cuadrados medios del error (MSE)</span>
<span class="n">MSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="w"> </span><span class="n">e</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="m">-3</span><span class="p">)</span>

<span class="c1">#Estadistico F</span>
<span class="bp">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MSR</span><span class="o">/</span><span class="n">MSE</span><span class="p">;</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;F-stat =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>

<span class="c1">#P-valor</span>
<span class="n">pval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">-</span><span class="nf">pf</span><span class="p">(</span><span class="bp">F</span><span class="p">,</span><span class="w"> </span><span class="m">3-1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="m">-3</span><span class="p">);</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;pval =&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pval</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">'F-stat = 29.83'</div><div class="output text_html">'pval = 0.0104746102413015'</div></div>
</div>
</section>
<section id="otras-pruebas-de-hipotesis">
<h2>2.19 Otras Pruebas de Hipotesis<a class="headerlink" href="#otras-pruebas-de-hipotesis" title="Link to this heading">#</a></h2>
<p>En el modelo multivariado podemos evaluar hipótesis para cuaquier (sub-)conjunto de parámetros. Algunos ejemplos son:</p>
<p>Sean <span class="math notranslate nohighlight">\(j, l, t \in \{0, 1, ..., k-1\}\)</span> y <span class="math notranslate nohighlight">\(c_1, c_2, c_3 \in \mathbb{R}\)</span>,</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_j = \beta_{l} + c_1\]</div>
<div class="math notranslate nohighlight">
\[H_0: \beta_j + \beta_{l} = \beta_{t}\]</div>
<div class="math notranslate nohighlight">
\[H_0: \beta_j = c_1\beta_l + c_2 \beta_t + c_3\]</div>
<p>A continuación presentamos dos estadísticos de prueba con los cuales podemos evaluar nuestras hipótesis.</p>
<p>Para la prueba</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_j = \beta_{l} + c_1\]</div>
<div class="math notranslate nohighlight">
\[H_1: \beta_j \neq \beta_{l} + c_1\]</div>
<p>Podemos usar el estadístico</p>
<div class="math notranslate nohighlight">
\[T = \frac{\hat\beta_j - \hat\beta_l - c_1}{\text{ee}(\hat\beta_j - \hat\beta_l - c_1)} = \frac{\hat\beta_j - \hat\beta_l - c_1}{\sqrt{Var(\hat\beta_j) + Var(\hat\beta_l) - 2Cov(\hat\beta_j, \hat\beta_l)}} \sim t_{n-k}\]</div>
<p>Observe que el error estandar de esta prueba lo podemos calcular a partir de la matrix de varianza-covarianza: <span class="math notranslate nohighlight">\(V(\hat\beta)\)</span>.</p>
</section>
<section id="minimos-cuadrados-restringidos">
<h2>2.20 Mínimos Cuadrados Restringidos<a class="headerlink" href="#minimos-cuadrados-restringidos" title="Link to this heading">#</a></h2>
<p>Este tipo de pruebas también se pueden hacer usando una regresión auxiliar a la cual se aplica la restricción.</p>
<p>Suponga que tenemos el siguiente modelo:</p>
<div class="math notranslate nohighlight">
\[
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + \beta_4 x_{4i} + \varepsilon_i
\]</div>
<p>Nos interesa evaluar:</p>
<div class="math notranslate nohighlight">
\[
H_0 : \beta_1 = \beta_3 = 0
\]</div>
<p>Entonces el modelo restringido sería:</p>
<div class="math notranslate nohighlight">
\[
y_i = \beta_0 + \beta_2 x_{2i} + \beta_4 x_{4i} + \varepsilon_i
\]</div>
<p>El estadístico de prueba que podemos usar es:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
F_{J,n-K} &amp;= \frac{R^2_{NR} - R^2_{R}}{J} \Big/ \frac{(1 - R^2_{NR})}{n-k} \\
&amp;= \frac{SSE_{R} - SSE_{NR}}{J} \Big/ \frac{SSE_{NR}}{n-k} \\
&amp;= \frac{e'_{R}e_{R} - e'_{NR}e_{NR}}{J} \Big/ \frac{e'_{NR}e_{NR}}{n-k} \\
\end{align*}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#(Continuación del ejemplo 2.13.2)</span>
<span class="c1">#Modelo No Restringido</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Y ~ x2 + x3)

Residuals:
      1       2       3       4       5       6 
-0.2258  0.0804  1.0030 -0.3415  0.3222 -0.8383 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  11.7419     0.9768  12.021  0.00124 **
x2           -0.8390     0.1129  -7.428  0.00505 **
x3           -0.3998     1.1494  -0.348  0.75093   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.8138 on 3 degrees of freedom
Multiple R-squared:  0.9521,	Adjusted R-squared:  0.9202 
F-statistic: 29.83 on 2 and 3 DF,  p-value: 0.01047
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelo Restringido</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Y ~ x2)

Residuals:
       1        2        3        4        5        6 
-0.18541 -0.03343  0.90274 -0.24924  0.51064 -0.94529 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.57751    0.75506  15.333 0.000106 ***
x2          -0.84802    0.09707  -8.736 0.000946 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7188 on 4 degrees of freedom
Multiple R-squared:  0.9502,	Adjusted R-squared:  0.9377 
F-statistic: 76.31 on 1 and 4 DF,  p-value: 0.0009461
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3>2.20.1 Ejemplo<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>Calculemos el estadístico F asociado a la prueba <span class="math notranslate nohighlight">\(H_0: \beta_2 = 0\)</span> (continuando el ejemplo 2.13.2)</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
F_{J,n-K} &amp;= \frac{R^2_{NR} - R^2_{R}}{J} \Big/ \frac{(1 - R^2_{NR})}{n-k} \\
&amp;= \frac{0.9521 - 0.9502}{1} \Big/ \frac{(1 - 0.9521)}{3} \approx 0.12
\end{align*}\]</div>
<p>Tambien lo podemos calcular de la siguiente manera:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
F_{J,n-K} &amp;= \frac{SSE_{R} - SSE_{NR}}{J} \Big/ \frac{SSE_{NR}}{n-k} \\ \\
&amp;= \frac{2.067 - 1.987}{1} \Big/ \frac{(1.987)}{3} \approx 0.12
\end{align*}\]</div>
<p>Observe que:</p>
<div class="math notranslate nohighlight">
\[SSE_{NR} = MSE_{NR}*(n-k) = 0.8138^2 * (6-3) = 1.987\]</div>
<div class="math notranslate nohighlight">
\[SSE_{R} = MSE_{R}*(n-k) = 0.7188^2 * (6-2) = 2.067\]</div>
</section>
<section id="seleccion-de-variables">
<h3>2.20.2 Selección de Variables<a class="headerlink" href="#seleccion-de-variables" title="Link to this heading">#</a></h3>
<p>Este método es útil para saber qué variables deben entrar y cuáles no en un modelo.</p>
<ol class="arabic simple">
<li><p>Corremos el modelo completo.</p></li>
<li><p>Identificamos las variables que no son significativas o que tienen coeficientes raros.</p></li>
<li><p>Excluimos esas variables, y corremos el modelo sin ellas.</p></li>
<li><p>Hacemos una prueba F tal que:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
H_0 : \beta_{exc} = 0
\]</div>
<p><span class="math notranslate nohighlight">\(\hspace{15pt}\)</span> donde <span class="math notranslate nohighlight">\(\beta_{exc}\)</span> son los betas excluidos.</p>
<ol class="arabic simple" start="5">
<li><p>Si se rechaza <span class="math notranslate nohighlight">\(H_0\)</span>, entonces ese grupo de variables se debe dejar.</p></li>
<li><p>De lo contrario, las podemos sacar del modelo.</p></li>
</ol>
</section>
</section>
<section id="interpretacion-de-coeficientes">
<h2>2.21 Interpretación de Coeficientes<a class="headerlink" href="#interpretacion-de-coeficientes" title="Link to this heading">#</a></h2>
<p>Uno de los supuestos del modelo de regresión lineal es que es lineal en los parámetros. <strong>Sin embargo, los modelos de regresión sí pueden ser no lineales en las variables</strong>.</p>
<p>La forma funcional de las variables determinará la <strong>interpretación de los parámetros</strong>.</p>
<p>Vamos a ver cuatro tipos de modelos:</p>
<ul class="simple">
<li><p>Lin-Lin</p></li>
<li><p>Log-Lin</p></li>
<li><p>Lin-log</p></li>
<li><p>Log-Log</p></li>
</ul>
<section id="lin-lin">
<h3>2.21.1 Lin-Lin<a class="headerlink" href="#lin-lin" title="Link to this heading">#</a></h3>
<p>Un modelo Lin-Lin es de la forma:</p>
<div class="math notranslate nohighlight">
\[X_i = \beta_0 + \beta_1 X_i + \varepsilon\]</div>
<p>Observe que si diferenciamos <span class="math notranslate nohighlight">\(Y_i\)</span> con respecto a <span class="math notranslate nohighlight">\(X_i\)</span> obtenemos</p>
<div class="math notranslate nohighlight">
\[\frac{d Y_i}{d X_i} = \beta_1\]</div>
<p><strong>Interpretación</strong>: Si <span class="math notranslate nohighlight">\(X\)</span> aumenta en 1 unidad, entonces <span class="math notranslate nohighlight">\(Y\)</span> cambia en <span class="math notranslate nohighlight">\(\beta_1\)</span> unidades.</p>
<p>Los modelos Lin-Lin son los más fáciles de interpretar</p>
</section>
<section id="log-lin">
<h3>2.21.2 Log-Lin<a class="headerlink" href="#log-lin" title="Link to this heading">#</a></h3>
<p>Los modelos Log -Lin son de la forma:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\ln(Y_i) &amp;= \beta_0 + \beta_1 X_i + \varepsilon_i \\
\frac{1}{Y_i}\frac{d Y_i}{d X_i} &amp;= \beta_1 \\
\frac{d Y_i/y_i}{d X_i} &amp;= \beta_1 \\		 
\frac{\Delta Y_i/Y_i}{\Delta X_i} &amp;= \beta_1 \\
\end{align*}\]</div>
<p>Otra forma de decir esto es:</p>
<div class="math notranslate nohighlight">
\[\frac{\text{Cambio relativo en Y}}{\text{Cambio absoluto en X}} = \beta_1\]</div>
<p>Note que <span class="math notranslate nohighlight">\(100*\frac{\Delta Y}{Y}\)</span> es un cambio porcentual! Entonces:</p>
<div class="math notranslate nohighlight">
\[\frac{\Delta Y_i/Y_i}{\Delta X_i} *100 = \beta_1 *100\]</div>
<p><strong>Interpretación</strong>: Ante un incremento de una unidad en X, Y cambia en <span class="math notranslate nohighlight">\(100*\beta_1\%\)</span> (<strong>semielasticidad</strong>)</p>
</section>
<section id="lin-log">
<h3>2.21.3 Lin-Log<a class="headerlink" href="#lin-log" title="Link to this heading">#</a></h3>
<p>Los modelos Lin-Log son de la forma:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
Y_i &amp;= \beta_0 + \beta_1 \ln(X_i) + \varepsilon_i \\
\frac{d Y_i}{d X_i} &amp;= \beta_1 \frac{1}{X_i}\\
\frac{d Y_i}{d X_i/X_i} &amp;= \beta_1 \\		 
\frac{\Delta Y_i}{\Delta X_i/X_i} &amp;= \beta_1 \\
\end{align*}\]</div>
<p>Otra forma de decir esto es:</p>
<div class="math notranslate nohighlight">
\[\frac{\text{Cambio absoluto en y}}{\text{Cambio relativo en x}} = \beta_1\]</div>
<p>Noten que <span class="math notranslate nohighlight">\(100*\frac{\Delta X}{X}\)</span> es un cambio porcentual! Entonces:</p>
<div class="math notranslate nohighlight">
\[\frac{\Delta y_i}{\Delta x_i/x_i} \frac{1}{100} = \beta_1 \frac{1}{100}\]</div>
<p><strong>Interpretación</strong> : Ante un incremento del 1% en X, Y cambia en <span class="math notranslate nohighlight">\(\frac{1}{100}*\beta_1\)</span> unidades</p>
</section>
<section id="log-log">
<h3>2.21.4 Log-Log<a class="headerlink" href="#log-log" title="Link to this heading">#</a></h3>
<p>El modelo Log-Log se presenta de esta forma:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\ln(y_i) &amp;= \beta_0 + \beta_1 \ln(x_i) + \epsilon_i \\
\frac{d y_i}{d x_i} \frac{1}{y_i} &amp;= \beta_1 \frac{1}{x_i} \\
\frac{d y_i}{d x_i} \frac{x_i}{y_i} &amp;= \beta_1
\end{align*}\]</div>
<p><strong>Interpretación</strong>: Ante un aumento en 1% en X, Y cambia en <span class="math notranslate nohighlight">\(\beta_1\%\)</span></p>
</section>
</section>
<section id="aplicacion">
<h2>2.22 Aplicación:<a class="headerlink" href="#aplicacion" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://doi.org/10.1080/09645292.2024.2403570">Busso, Montaño, y Muñoz (2025)</a> estiman el efecto de varios tipos de habilidades sobre los salarios de los egresados de educación superior en Colombia. Los autores encuentran que los retornos laborales varían por tipo de programa y reputación de la institución educativa. Adicionalmente, un aumento de 1 desviación estándar en habilidades aumenta el salario entre 1 y 3 por ciento.</p>
<p>A continuación realizaremos una práctica en R usando la información de este artículo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;ggplot2&#39;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&#39;ggplot2&#39;</span><span class="p">)</span>

<span class="n">link_datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;https://www.dropbox.com/scl/fi/3p0dqe3dpoyh6lgu98e6u/skills_data.dta?rlkey=p38dvk2qr0dylbnebk5xcxnjm&amp;dl=1&#39;</span>
<span class="n">datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_dta</span><span class="p">(</span><span class="n">link_datos</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
&quot;package &#39;ggplot2&#39; is in use and will not be installed&quot;
</pre></div>
</div>
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'test_edition'</li><li>'grad_year'</li><li>'female'</li><li>'age'</li><li>'age_2'</li><li>'stratum'</li><li>'study_field'</li><li>'program_type_1'</li><li>'program_type_3'</li><li>'program_type_4'</li><li>'educ_madre'</li><li>'sb11_subject'</li><li>'sb11_literacy'</li><li>'sb11_numeracy'</li><li>'sb11_english'</li><li>'ln_fst_wage'</li><li>'lit'</li><li>'num'</li><li>'eng'</li></ol>
</div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The following objects are masked from datos (pos = 5):

    age, age_2, educ_madre, eng, female, grad_year, lit, ln_fst_wage,
    num, program_type_1, program_type_3, program_type_4, sb11_english,
    sb11_literacy, sb11_numeracy, sb11_subject, stratum, study_field,
    test_edition
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Numero de mujeres</span>
<span class="nf">table</span><span class="p">(</span><span class="n">female</span><span class="p">)</span>
<span class="c1">#Estadisticas descriptivas de las variables</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">datos</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;female&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;age&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;num&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;eng&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>female
   0    1 
5729 8673 
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     female            age             num                eng           
 Min.   :0.0000   Min.   :20.00   Min.   :-3.99532   Min.   :-2.329097  
 1st Qu.:0.0000   1st Qu.:25.00   1st Qu.:-0.65644   1st Qu.:-0.685924  
 Median :1.0000   Median :26.00   Median :-0.07552   Median :-0.295580  
 Mean   :0.6022   Mean   :26.82   Mean   : 0.01372   Mean   : 0.002152  
 3rd Qu.:1.0000   3rd Qu.:29.00   3rd Qu.: 0.57682   3rd Qu.: 0.397801  
 Max.   :1.0000   Max.   :40.00   Max.   : 5.61133   Max.   : 6.663444  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Histograma de Puntajes en Prueba</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">lit</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">),</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Comprension de Lectura (Saber Pro)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Probabilidad&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Puntaje Estandarizado&#39;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">density</span><span class="p">(</span><span class="n">lit</span><span class="p">),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lw</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1af917fbdbff8d568ff5333d0d23177d66c74496926338f079c15230fce2811d.png"><img alt="_images/1af917fbdbff8d568ff5333d0d23177d66c74496926338f079c15230fce2811d.png" src="_images/1af917fbdbff8d568ff5333d0d23177d66c74496926338f079c15230fce2811d.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Relacion entre comprension de lectura y </span>
<span class="n">markers</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">17</span><span class="p">,</span><span class="w"> </span><span class="m">19</span><span class="p">);</span><span class="w"> </span><span class="n">colors</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">lit</span><span class="p">,</span><span class="w"> </span><span class="n">ln_fst_wage</span><span class="p">,</span><span class="w">  </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">markers</span><span class="p">[</span><span class="nf">factor</span><span class="p">(</span><span class="n">female</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colors</span><span class="p">[</span><span class="nf">factor</span><span class="p">(</span><span class="n">female</span><span class="p">)]</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Comprension de Lectura&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Salario (logaritmo)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7</span><span class="p">)</span>
<span class="nf">legend</span><span class="p">(</span><span class="s">&quot;topleft&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Hombre&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Mujer&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colors</span><span class="p">,</span><span class="w">  </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">markers</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">,</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/02af1f2e33395f109255e17df5452eeaa70b49232879e44592bea4d33889bb28.png"><img alt="_images/02af1f2e33395f109255e17df5452eeaa70b49232879e44592bea4d33889bb28.png" src="_images/02af1f2e33395f109255e17df5452eeaa70b49232879e44592bea4d33889bb28.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Promedios</span>
<span class="n">bins_female</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="n">lit</span><span class="p">[</span><span class="n">female</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span><span class="p">),</span><span class="w"> </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ordered_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">);</span><span class="w"> </span><span class="n">means_female</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tapply</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="p">[</span><span class="n">female</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">bins_female</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="n">bins_male</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cut</span><span class="p">(</span><span class="n">lit</span><span class="p">[</span><span class="n">female</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span><span class="p">),</span><span class="w"> </span><span class="n">include.lowest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ordered_result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">);</span><span class="w"> </span><span class="n">means_male</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tapply</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="p">[</span><span class="n">female</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">bins_male</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="n">means</span><span class="w"> </span><span class="o">&lt;-</span><span class="nf">cbind</span><span class="p">(</span><span class="n">means_male</span><span class="p">,</span><span class="w"> </span><span class="n">means_female</span><span class="p">)</span>
<span class="c1">#Figura</span>
<span class="n">literacy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">seq</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span><span class="p">)[</span><span class="m">-1</span><span class="p">],</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.25</span><span class="p">)[</span><span class="m">-1</span><span class="p">])</span>
<span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">16</span><span class="p">),</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">16</span><span class="p">))</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">literacy</span><span class="p">,</span><span class="w"> </span><span class="n">means</span><span class="p">,</span><span class="w">  </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">markers</span><span class="p">[</span><span class="nf">factor</span><span class="p">(</span><span class="n">f</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colors</span><span class="p">[</span><span class="nf">factor</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Puntaje Compresion Lectura&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Logaritmo del Salario&#39;</span><span class="p">);</span><span class="w"> </span><span class="nf">legend</span><span class="p">(</span><span class="s">&quot;topleft&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Hombre&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Mujer&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colors</span><span class="p">,</span><span class="w">  </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">markers</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">,</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;n&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/d387adf263992d4cc56253b8acee5693cc2ef014229da7be0fbf1c9c22ef3d28.png"><img alt="_images/d387adf263992d4cc56253b8acee5693cc2ef014229da7be0fbf1c9c22ef3d28.png" src="_images/d387adf263992d4cc56253b8acee5693cc2ef014229da7be0fbf1c9c22ef3d28.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelo sin controles</span>
<span class="n">model1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">lit</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eng</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">model1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = ln_fst_wage ~ lit + num + eng, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.05224 -0.42972 -0.08334  0.35238  2.09447 

Coefficients:
             Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept) 10.471985   0.004144 2526.948  &lt; 2e-16 ***
lit          0.015534   0.004913    3.162  0.00157 ** 
num          0.049929   0.004953   10.080  &lt; 2e-16 ***
eng          0.042525   0.004959    8.575  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4973 on 14398 degrees of freedom
Multiple R-squared:  0.03057,	Adjusted R-squared:  0.03036 
F-statistic: 151.3 on 3 and 14398 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelo con controles</span>
<span class="n">model2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">lit</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eng</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sb11_literacy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sb11_numeracy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">sb11_english</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">model2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = ln_fst_wage ~ lit + num + eng + sb11_literacy + 
    sb11_numeracy + sb11_english + female + age, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.06904 -0.41704 -0.08248  0.34633  2.12034 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   10.138122   0.038077 266.252  &lt; 2e-16 ***
lit            0.015055   0.005107   2.948  0.00321 ** 
num            0.042050   0.005450   7.716 1.28e-14 ***
eng            0.032405   0.006176   5.247 1.57e-07 ***
sb11_literacy  0.011881   0.005002   2.375  0.01755 *  
sb11_numeracy  0.013071   0.005025   2.601  0.00929 ** 
sb11_english   0.012912   0.005942   2.173  0.02980 *  
female        -0.019775   0.008907  -2.220  0.02642 *  
age            0.012901   0.001378   9.364  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4949 on 14393 degrees of freedom
Multiple R-squared:  0.03988,	Adjusted R-squared:  0.03934 
F-statistic: 74.72 on 8 and 14393 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Decidamos si dejamos el modelo con controles</span>
<span class="n">SST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">ln_fst_wage</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>

<span class="n">SSE_R</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">model1</span><span class="o">$</span><span class="n">residuals</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="n">R2_R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SSE_R</span><span class="o">/</span><span class="n">SST</span><span class="p">;</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;R2 restringido = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">R2_R</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>

<span class="n">SSE_NR</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">model2</span><span class="o">$</span><span class="n">residuals</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">  </span>
<span class="n">R2_NR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SSE_NR</span><span class="o">/</span><span class="n">SST</span><span class="p">;</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;R2 no restringido = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">R2_NR</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>

<span class="c1">#Estadistico de Prueba</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="p">)</span>
<span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">model2</span><span class="o">$</span><span class="n">coefficients</span><span class="p">)</span>
<span class="n">F_stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">R2_NR</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">R2_R</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="m">1</span><span class="o">-</span><span class="n">R2_NR</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k</span><span class="p">));</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;F-stat = &quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">F_stat</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>
<span class="n">F_critico</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">qf</span><span class="p">(</span><span class="m">1-0.05</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;F critico =&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">F_critico</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">))</span>

<span class="c1">#Conclusion?</span>
<span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">F_stat</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">F_critico</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="s">&#39;Rechace H0 (con alpha = 5%)&#39;</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="s">&#39;No rechace H0 (con alpha = 5%)&#39;</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="c1">#entonces rechazamos H0 y nos quedamos con el modelo con controles</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><span style=white-space:pre-wrap>'R2 restringido =  0.0306'</span></div><div class="output text_html"><span style=white-space:pre-wrap>'R2 no restringido =  0.0399'</span></div><div class="output text_html"><span style=white-space:pre-wrap>'F-stat =  139.5764'</span></div><div class="output text_html">'F critico = 1.9391'</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Rechace H0 (con alpha = 5%)&quot;
</pre></div>
</div>
</div>
</div>
</section>
<section id="variables-binarias-y-categoricas">
<h2>2.23 Variables Binarias y Categoricas<a class="headerlink" href="#variables-binarias-y-categoricas" title="Link to this heading">#</a></h2>
<p>Hay muchas variables que no podemos incluir linealmente a un modelo porque son cualitativas. Sin embargo, podemos incluir variables categóricas.</p>
<p>Ejemplos: género, recibe subsidio o no, máximo nivel educativo, etc.</p>
<p>Para ello creamos variables binarias (tambien conocidas como variables <em>dummy</em>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
D_i = 1(\text{Genero}_i = \text{mujer}) = 
\begin{cases} 
1 &amp; \text{si mujer} \\ 
0 &amp; \text{si hombre} 
\end{cases}
\end{split}\]</div>
<p>En nuestra matrix <span class="math notranslate nohighlight">\(X\)</span> estas variables se representan a traves de vectores de 1 y 0. Por ejemplo:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
X =
\begin{bmatrix}
1 &amp; 0 &amp; 4 \\
1 &amp; 1 &amp; 5.6 \\
1 &amp; 0 &amp; 8.9 \\
1 &amp; 1 &amp; 3.2 \\
\end{bmatrix}
\end{split}\]</div>
<p>Las variables categóricas son fáciles de incluir en un modelo.</p>
<p>Para interpretar estas variables debemos considerar la <strong>categoría excluida</strong>.</p>
<ul class="simple">
<li><p>Si hay <span class="math notranslate nohighlight">\(m\)</span> categorías, entonces podemos incluir solo <span class="math notranslate nohighlight">\(m - 1\)</span> variables binarias.</p></li>
<li><p>De lo contrario, habría <strong>colinealidad perfecta</strong> (con el vector de 1s asociado al intercepto del modelo) y el modelo no se podría estimar.</p></li>
</ul>
</section>
<section id="aplicacion-retornos-a-la-educacion-edad-y-gaps">
<h2>2.24 Aplicación: Retornos a la Educación, Edad, y Gaps<a class="headerlink" href="#aplicacion-retornos-a-la-educacion-edad-y-gaps" title="Link to this heading">#</a></h2>
<p>Consideremos ahora la siguiente función de regresión:</p>
<div class="math notranslate nohighlight">
\[\log(wage_i) = \beta_0 + \beta_1 female_i + \beta_2 age_i + \beta_3 age_i^2 + \varepsilon_i\]</div>
<p>donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(wage_i\)</span> representa el ingreso laboral del individuo <span class="math notranslate nohighlight">\(i\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(female_i\)</span> es una variable binaria que toma el valor de 1 si <span class="math notranslate nohighlight">\(i\)</span> es mujer y <span class="math notranslate nohighlight">\(0\)</span> si no, y</p></li>
<li><p><span class="math notranslate nohighlight">\(age_i\)</span> es la edad</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">female</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = ln_fst_wage ~ female, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.66436 -0.46829 -0.09644  0.36028  2.11424 

Coefficients:
             Estimate Std. Error  t value Pr(&gt;|t|)    
(Intercept) 10.510749   0.006660 1578.303  &lt; 2e-16 ***
female      -0.062740   0.008582   -7.311 2.79e-13 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.5041 on 14400 degrees of freedom
Multiple R-squared:  0.003698,	Adjusted R-squared:  0.003629 
F-statistic: 53.45 on 1 and 14400 DF,  p-value: 2.793e-13
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Comparación entre Áreas de Estudio</span>
<span class="n">datos</span><span class="o">$</span><span class="n">field_names</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Business&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Architecture&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Arts&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Agricultural Sci&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Natural/Exact Sci&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Social Sci&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Communications&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Accounting&quot;</span><span class="p">,</span><span class="s">&quot;Law&quot;</span><span class="p">,</span><span class="s">&quot;Economics&quot;</span><span class="p">,</span><span class="s">&quot;Education&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Nursing&quot;</span><span class="p">,</span><span class="s">&quot;Humanities&quot;</span><span class="p">,</span><span class="s">&quot;Engineering&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Medicine&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Psychology&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Sports&quot;</span><span class="p">,</span><span class="s">&quot;Health&quot;</span><span class="p">)[</span><span class="n">datos</span><span class="o">$</span><span class="n">study_field</span><span class="p">]</span>
<span class="nf">table</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">field_names</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       Accounting  Agricultural Sci      Architecture              Arts 
              977               264               225               549 
         Business    Communications         Economics         Education 
             3263               506               221              1236 
      Engineering            Health        Humanities               Law 
             3389               948                70               736 
         Medicine Natural/Exact Sci           Nursing        Psychology 
              514               185               400               529 
       Social Sci            Sports 
              343                47 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Regresión con múltiples variables binarias</span>
<span class="n">datos</span><span class="o">$</span><span class="n">field_</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">relevel</span><span class="p">(</span><span class="nf">factor</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">field_names</span><span class="p">),</span><span class="w"> </span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Business&quot;</span><span class="p">)</span>
<span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">field_</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">)</span>

<span class="c1">#Resultados</span>
<span class="n">model_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">model_summary</span><span class="o">$</span><span class="n">coefficients</span><span class="p">);</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;R-squared:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">model_summary</span><span class="o">$</span><span class="n">r.squared</span><span class="p">));</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;F-statistic:&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">model_summary</span><span class="o">$</span><span class="n">fstatistic</span><span class="p">[</span><span class="m">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                           Estimate Std. Error      t value      Pr(&gt;|t|)
(Intercept)             10.43308765 0.00843100 1237.4673825  0.000000e+00
field_Accounting         0.03173168 0.01756365    1.8066678  7.083498e-02
field_Agricultural Sci  -0.13169725 0.03081626   -4.2736293  1.935544e-05
field_Architecture      -0.01696222 0.03319526   -0.5109833  6.093706e-01
field_Arts              -0.18213668 0.02221618   -8.1983800  2.640966e-16
field_Communications    -0.04171176 0.02301002   -1.8127655  6.988883e-02
field_Economics          0.12844939 0.03347511    3.8371609  1.249970e-04
field_Education         -0.08520926 0.01608525   -5.2973533  1.192248e-07
field_Engineering        0.09281518 0.01181189    7.8577750  4.186139e-15
field_Health            -0.02290484 0.01776919   -1.2890202  1.974118e-01
field_Humanities        -0.09579833 0.05817652   -1.6466838  9.964491e-02
field_Law                0.16355781 0.01965241    8.3225305  9.379114e-17
field_Medicine           0.65742192 0.02285446   28.7655809 5.655445e-177
field_Natural/Exact Sci -0.05034402 0.03639794   -1.3831556  1.666386e-01
field_Nursing            0.32046033 0.02551335   12.5604940  5.378294e-36
field_Psychology        -0.08024501 0.02257280   -3.5549428  3.792742e-04
field_Social Sci        -0.09617911 0.02733663   -3.5183241  4.356220e-04
field_Sports            -0.16813976 0.07075289   -2.3764367  1.749377e-02
[1] &quot;R-squared: 0.0915144359870832&quot;
[1] &quot;F-statistic: 85.2319313773986&quot;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">coeff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">model</span><span class="p">),</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="nf">coef</span><span class="p">(</span><span class="nf">summary</span><span class="p">(</span><span class="n">model</span><span class="p">))[,</span><span class="w"> </span><span class="s">&quot;Std. Error&quot;</span><span class="p">]);</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="m">-1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">B</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">B</span><span class="o">$</span><span class="n">coeff</span><span class="p">),</span><span class="w"> </span><span class="p">];</span><span class="w"> </span><span class="n">B</span><span class="o">$</span><span class="n">order</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">17</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="n">B</span><span class="o">$</span><span class="n">field</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">trimws</span><span class="p">(</span><span class="nf">sub</span><span class="p">(</span><span class="s">&quot;field_&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="nf">row.names</span><span class="p">(</span><span class="n">B</span><span class="p">)))</span>

<span class="c1">#Intervalos de confianza al 95%</span>
<span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.05</span><span class="p">;</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">female</span><span class="p">);</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="nf">coef</span><span class="p">(</span><span class="n">model</span><span class="p">))</span>
<span class="n">B</span><span class="o">$</span><span class="n">up_ci</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">B</span><span class="o">$</span><span class="n">coeff</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="o">$</span><span class="n">se</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="nf">qt</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">));</span><span class="w"> </span><span class="n">B</span><span class="o">$</span><span class="n">low_ci</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">B</span><span class="o">$</span><span class="n">coeff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">B</span><span class="o">$</span><span class="n">se</span><span class="o">*</span><span class="nf">abs</span><span class="p">(</span><span class="nf">qt</span><span class="p">(</span><span class="n">alpha</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">))</span>

<span class="c1">#Coeficientes</span>
<span class="nf">ggplot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coeff</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">linetype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;dashed&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">geom_errorbar</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">low_ci</span><span class="p">,</span><span class="w"> </span><span class="n">ymax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">up_ci</span><span class="p">),</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">    </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="o">$</span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="o">$</span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Diferencia Log Salario (vs Business)&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Área de Estudio&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">theme_minimal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">theme</span><span class="p">(</span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">angle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90</span><span class="p">,</span><span class="w"> </span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">vjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/e93e02efb3441bd21a64196fe85066d000aa4088754308967a155f1c5c73c75d.png"><img alt="_images/e93e02efb3441bd21a64196fe85066d000aa4088754308967a155f1c5c73c75d.png" src="_images/e93e02efb3441bd21a64196fe85066d000aa4088754308967a155f1c5c73c75d.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#No linealidad en covariables</span>
<span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age_2</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">)</span>
<span class="n">model_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">se.fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;confidence&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.99</span><span class="p">))</span>
<span class="nf">names</span><span class="p">(</span><span class="n">model_fit</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;yhat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;lwr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;upr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;se&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;df&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;residuals&#39;</span><span class="p">)</span>

<span class="n">means_age</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tapply</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="p">,</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="nf">seq</span><span class="p">(</span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">means_age</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Relación Salarios y Edad&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Edad&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Log(Wage)&#39;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">age</span><span class="p">),</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">yhat</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">age</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">age</span><span class="p">),</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">lwr</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">age</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">age</span><span class="p">),</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">upr</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">age</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/49165197f3e297d5f436020ddf2afbb48962e96111b86573daaa46787bbf847b.png"><img alt="_images/49165197f3e297d5f436020ddf2afbb48962e96111b86573daaa46787bbf847b.png" src="_images/49165197f3e297d5f436020ddf2afbb48962e96111b86573daaa46787bbf847b.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = ln_fst_wage ~ age + age_2, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.66978 -0.45218 -0.08871  0.35043  2.10632 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.6697026  0.2396706  36.173  &lt; 2e-16 ***
age          0.1219857  0.0170947   7.136 1.01e-12 ***
age_2       -0.0020146  0.0003021  -6.669 2.67e-11 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.5036 on 14399 degrees of freedom
Multiple R-squared:  0.005684,	Adjusted R-squared:  0.005546 
F-statistic: 41.16 on 2 and 14399 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="covariables-no-lineales">
<h2>2.25 Covariables No-lineales<a class="headerlink" href="#covariables-no-lineales" title="Link to this heading">#</a></h2>
<p>Observe que para interpretar el <strong>efecto de la edad</strong> en el salario, debemos suponer que las otras variables permanecen constantes:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \log(wage_i)}{\partial age_i} = \beta_2 + 2 \cdot \beta_3 age_i\]</div>
<p>Así, <em>ceteris paribus</em> (todo lo demás constante), un incremento en un año de experiencia, aumenta el salario en <span class="math notranslate nohighlight">\((\beta_2 + 2 \cdot age_i \cdot \beta_3)100\%\)</span>.</p>
<p>Note que para una persona que pasa de 20 a 21 años, el salario aumenta en <span class="math notranslate nohighlight">\((11.8\% - 2 \cdot 21 \cdot(0.2\%)) \approx 3.4\%\)</span>.</p>
<p>Para una persona que pasa de 34 a 35 años, el salario aumenta en <span class="math notranslate nohighlight">\((11.8\% - 2\cdot 35 \cdot(0.2\%)) \approx 2.2\%\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">female</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age_2</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = ln_fst_wage ~ female + age + age_2, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.70299 -0.44394 -0.08687  0.34903  2.09150 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  8.7629730  0.2396815  36.561  &lt; 2e-16 ***
female      -0.0585482  0.0085754  -6.827 8.99e-12 ***
age          0.1182726  0.0170763   6.926 4.51e-12 ***
age_2       -0.0019575  0.0003017  -6.488 8.97e-11 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.5028 on 14398 degrees of freedom
Multiple R-squared:  0.008893,	Adjusted R-squared:  0.008686 
F-statistic: 43.06 on 3 and 14398 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="interacciones">
<h2>2.26 Interacciones<a class="headerlink" href="#interacciones" title="Link to this heading">#</a></h2>
<p>Las variables binarias son una muy buena herramienta.</p>
<ul class="simple">
<li><p>Una aplicación muy útil son las <strong>interacciones</strong>.</p></li>
<li><p>Una interacción es simplemente el <strong>producto de una variable</strong> (categórica o no) con una variable categórica.</p></li>
<li><p>Las interacciones permiten medir <strong>cambios en pendiente</strong> y diferenciar grupos por varias características.</p></li>
</ul>
<p>Considere el siguiente modelo:</p>
<div class="math notranslate nohighlight">
\[\log(wage_i) = \beta_0 + \beta_1 female_i + \beta_2 STEM_i + \beta_3 age_i + \varepsilon_i\]</div>
<p>Donde</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(wage_i\)</span> es el salario del individuo <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(age_i\)</span> es su edad</p></li>
<li><p><span class="math notranslate nohighlight">\(female_i\)</span> toma el valor de 1 si es mujer, y <span class="math notranslate nohighlight">\(STEM_i\)</span> toma el valor de 1 si está en Ciencia, Tecnología, Ingeniería, o Matemáticas.</p></li>
</ul>
<section id="interaccion-entre-variables-binarias">
<h3>2.26.1 Interacción entre Variables Binarias<a class="headerlink" href="#interaccion-entre-variables-binarias" title="Link to this heading">#</a></h3>
<p>La interacción entre <span class="math notranslate nohighlight">\(female_i\)</span> y <span class="math notranslate nohighlight">\(STEM_i\)</span> nos permitirá diferenciar las <strong>mujeres casadas</strong>.</p>
<div class="math notranslate nohighlight">
\[\log(w_i) = \beta_0 + \beta_1 female_i + \beta_2 STEM_i + \beta_3 age_i + \delta (female_i \times STEM_i) + \varepsilon_i\]</div>
<p>Observe que:</p>
<div class="math notranslate nohighlight">
\[\Delta_{f_i=0}(S_i)  = E[\log(w_i) \mid f_i = 0, S_i = 1] - E[\log(w_i) \mid f_i = 0, S_i = 0] = \beta_2\]</div>
<div class="math notranslate nohighlight">
\[\Delta_{f_i=1}(S_i) = E[\log(w_i) \mid f_i = 1, S_i = 1] - E[\log(w_i) \mid f_i = 1, S_i = 0] = \beta_2 + \delta\]</div>
<p>Entonces,</p>
<div class="math notranslate nohighlight">
\[\delta = \Delta_{f_i=1}(S_i) - \Delta_{f_i=0}(S_i)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span>: cambio en el salario para hombres en STEM (vs hombres en no-STEM)</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span> + <span class="math notranslate nohighlight">\(\delta\)</span>: cambio en el salario para mujeres en STEM (vs mujeres en no-STEM)</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta\)</span>: cambio diferencial en el salario para mujeres por ser STEM (vs al cambio de hombres por ser STEM)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">datos</span><span class="o">$</span><span class="n">STEM</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ifelse</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">study_field</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="m">18</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">female</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">STEM</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="o">*</span><span class="n">STEM</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(ln_fst_wage) ~ female + STEM + female * STEM + 
    age, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.07582 -0.04181 -0.00711  0.03393  0.18853 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.3207720  0.0035792 648.410  &lt; 2e-16 ***
female      -0.0021734  0.0010339  -2.102   0.0356 *  
STEM         0.0135673  0.0012491  10.861  &lt; 2e-16 ***
age          0.0008951  0.0001271   7.040 2.01e-12 ***
female:STEM -0.0033142  0.0016799  -1.973   0.0485 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.04698 on 14397 degrees of freedom
Multiple R-squared:  0.01954,	Adjusted R-squared:  0.01927 
F-statistic: 71.73 on 4 and 14397 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="interaccion-entre-una-variable-binaria-y-una-continua">
<h3>2.26.2 Interacción entre una Variable Binaria y una Continua<a class="headerlink" href="#interaccion-entre-una-variable-binaria-y-una-continua" title="Link to this heading">#</a></h3>
<p>Considere ahora la interacción entre una variable categórica y una variable continua.</p>
<p>Esto identifica <strong>cambios en pendientes</strong> o efectos diferenciados.</p>
<div class="math notranslate nohighlight">
\[\log(wage_i) = \beta_0 + \beta_1 female_i + \beta_2 math_i + \beta_3 (female_i \times math_i) + \varepsilon_i\]</div>
<p>Podemos calcular la derivada:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \log(wage_i)}{\partial math_i} = \beta_2 + \beta_3 female_i
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span>: efecto de un punto adicional en matemáticas en el salario de los <strong>hombres</strong>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_2 + \beta_3\)</span>: efecto de un punto adicional en matemáticas en el salario de las <strong>mujeres</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">ln_fst_wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">female</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="o">*</span><span class="n">num</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">age</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(ln_fst_wage) ~ female + num + female * num + 
    age, data = datos)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.095167 -0.040817 -0.007281  0.033629  0.189426 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.3184309  0.0035378 655.339   &lt;2e-16 ***
female      -0.0015294  0.0008321  -1.838   0.0661 .  
num          0.0066596  0.0005886  11.314   &lt;2e-16 ***
age          0.0011285  0.0001278   8.827   &lt;2e-16 ***
female:num   0.0017257  0.0008133   2.122   0.0339 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.04676 on 14397 degrees of freedom
Multiple R-squared:  0.02887,	Adjusted R-squared:  0.0286 
F-statistic:   107 on 4 and 14397 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="teorema-de-gauss-markov">
<h2>2.27 Teorema de Gauss-Markov<a class="headerlink" href="#teorema-de-gauss-markov" title="Link to this heading">#</a></h2>
<div class="alert alert-block alert-info">
<b>TEOREMA:</b>
<p>
<p>El estimador de Mínimos Cuadrados Ordinarios <span class="math notranslate nohighlight">\(\hat{\beta} = (X'X)^{-1}X'Y\)</span> es el <strong>mejor estimador lineal insesgado (MELI)</strong>.</p>
</div>
<ul class="simple">
<li><p>Esto significa que es el estimador lineal más <strong>eficiente</strong> o con menor varianza</p></li>
<li><p>Esto ocurre <strong>si y solo si</strong> se cumplen los supuestos del modelo lineal</p></li>
</ul>
<p><strong>Demostación:</strong></p>
<p>Considere un estimador lineal insesgado <span class="math notranslate nohighlight">\(b\)</span>, tal que:</p>
<div class="math notranslate nohighlight">
\[b = CY \quad \text{y} \quad C \neq (X'X)^{-1}X'\]</div>
<p>De forma genérica podemos definir:</p>
<div class="math notranslate nohighlight">
\[
C = (D + A) \quad \text{tal que} \quad A = (X'X)^{-1}X'
\]</div>
<p>Entonces:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
b &amp;= CY = DY + AY \\
&amp;= D(X\beta + \varepsilon) + \hat{\beta}
\end{align*}\]</div>
<p>Como <span class="math notranslate nohighlight">\(b\)</span> es insesgado:</p>
<div class="math notranslate nohighlight">
\[
E[b|X] = \beta
\]</div>
<div class="math notranslate nohighlight">
\[
E[b|X] = DX\beta + D \cdot E[\varepsilon|X] + E[\hat{\beta}|X]
\]</div>
<p>Entonces debe cumplirse que:</p>
<div class="math notranslate nohighlight">
\[
DX = 0
\]</div>
<p>Podemos entonces escribir lo siguiente:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
b &amp;= DX\beta + D\varepsilon + \hat{\beta} \\
&amp;= D\varepsilon + \beta + A\varepsilon \\
&amp;= \beta + (D + A)\varepsilon
\end{align*}\]</div>
<p>Ahora saquemos la varianza de este estimador:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
Var(b) = (D + A)Var(\varepsilon)(D + A)' \\
&amp;= \sigma^2 (D + A)(D + A)' \\
&amp;= \sigma^2[DD' + DA' + AD' + AA'] \\
&amp;= \sigma^2DD' + \sigma^2(X'X)^{-1}\\
\end{align*}\]</div>
<p>Noten que <span class="math notranslate nohighlight">\(DD'\)</span> es un valor positivo.</p>
<p>Por lo tanto:</p>
<div class="math notranslate nohighlight">
\[
Var(b) \geq Var(\hat{\beta}) = \sigma^2 (X'X)^{-1}
\]</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Modulo_1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Parte I - Fundamentos</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-aprendizaje-y-tamano-de-clase">2.1 Aplicación: Aprendizaje y Tamaño de Clase</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regresion-simple-o-univariada">2.2 Regresión Simple o Univariada</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supuestos-del-modelo">2.3 Supuestos del Modelo</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linealidad-en-parametros">2.3.1 Linealidad en Parámetros</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-multicolinealidad-o-rango-completo">2.3.2 No Multicolinealidad o Rango Completo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#homoscedasticidad">2.3.3 Homoscedasticidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#no-autocorrelacion">2.3.4 No Autocorrelación</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-normal-de-los-errores">2.3.5 Distribución Normal de los Errores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#independencia-condicional-o-exogenidad">2.3.6 Independencia Condicional o Exogenidad</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametros-poblacionales">2.4 Parámetros Poblacionales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-por-mco">2.5 Estimación por MCO</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-relacion-entre-educacion-y-crecimiento">2.6 Aplicación : Relación entre Educación y Crecimiento</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#residuales-de-la-regresion-e-i-y-i-hat-y-i">2.7 Residuales de la Regresión: <span class="math notranslate nohighlight">\(e_i = Y_i - \hat Y_i\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propiedades-de-los-estimadores-hat-beta-k">2.8 Propiedades de los estimadores <span class="math notranslate nohighlight">\(\hat\beta_k\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inferencia-en-regresion-simple">2.9 Inferencia en Regresión Simple</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-hipotesis-sobre-hat-beta-k">2.9.1 Pruebas de Hipótesis sobre <span class="math notranslate nohighlight">\(\hat\beta_k\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varianza-de-hat-beta-k">2.9.2 Varianza de <span class="math notranslate nohighlight">\(\hat\beta_k\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#varianza-de-los-errores">2.9.3 Varianza de los Errores</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-hipotesis-individuales">2.9.4 Pruebas de Hipótesis Individuales</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#intervalo-de-confianza-para-beta-k">2.9.5 Intervalo de confianza para <span class="math notranslate nohighlight">\(\beta_k\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coeficiente-de-determinacion-r-2">2.9.6 Coeficiente de Determinación: <span class="math notranslate nohighlight">\(R^2\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-significancia-global">2.9.7 Prueba de Significancia Global</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-e-inferencia-para-hat-y-i">2.9.8 Predicción e Inferencia para <span class="math notranslate nohighlight">\(\hat Y_i\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-media">2.9.9 Predicción Media</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediccion-individual">2.9.10 Predicción Individual</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-por-maxima-verosimilitud">2.10 Estimación por Máxima Verosimilitud</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-multiple">2.11 Modelo de Regresión Multiple</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-en-forma-matricial">2.11.1 Modelo en Forma Matricial</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#supuestos-en-forma-matricial">2.11.2 Supuestos en forma Matricial</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-ordinarios">2.12 Mínimos Cuadrados Ordinarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-de-beta">2.13 Estimación de <span class="math notranslate nohighlight">\(\beta\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices-y-sumatorias">2.13.1 Matrices y Sumatorias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo">2.13.2 Ejemplo</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propiedades-de-hat-beta">2.14 Propiedades de <span class="math notranslate nohighlight">\(\hat\beta\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-varianza-y-covarianza">2.15 Matriz de Varianza y Covarianza</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-significancia-individual">2.16 Pruebas de Significancia Individual</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bondad-de-ajuste-r-2-y-r-2-ajustado">2.17 Bondad de Ajuste: <span class="math notranslate nohighlight">\(R^2\)</span> y <span class="math notranslate nohighlight">\(R^2\)</span>-Ajustado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-signifiancia-global">2.18 Prueba de Signifiancia Global</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otras-pruebas-de-hipotesis">2.19 Otras Pruebas de Hipotesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-restringidos">2.20 Mínimos Cuadrados Restringidos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">2.20.1 Ejemplo</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-variables">2.20.2 Selección de Variables</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretacion-de-coeficientes">2.21 Interpretación de Coeficientes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lin-lin">2.21.1 Lin-Lin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-lin">2.21.2 Log-Lin</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lin-log">2.21.3 Lin-Log</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#log-log">2.21.4 Log-Log</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion">2.22 Aplicación:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-binarias-y-categoricas">2.23 Variables Binarias y Categoricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-retornos-a-la-educacion-edad-y-gaps">2.24 Aplicación: Retornos a la Educación, Edad, y Gaps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covariables-no-lineales">2.25 Covariables No-lineales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interacciones">2.26 Interacciones</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interaccion-entre-variables-binarias">2.26.1 Interacción entre Variables Binarias</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interaccion-entre-una-variable-binaria-y-una-continua">2.26.2 Interacción entre una Variable Binaria y una Continua</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#teorema-de-gauss-markov">2.27 Teorema de Gauss-Markov</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sebastian Montano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>