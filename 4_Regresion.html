
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Modelo de Regresión Multiple &#8212; Microeconometria Aplicada</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4_Regresion';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Evaluación de Supuestos" href="5_Supuestos.html" />
    <link rel="prev" title="Modelo de Regresión Lineal" href="3_Regresion.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Microeconometria Aplicada - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Microeconometria Aplicada - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Microeconometría Aplicada
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_Motivacion.html">Qué es la Microeconometría?</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_Regresion.html">Modelo de Regresión Lineal</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Modelo de Regresión Multiple</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_Supuestos.html">Evaluación de Supuestos</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Respuesta_Cualitativa.html">Variables de Respuesta Cualitativa</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_Probabilidad.html">Fundamentos de Probabilidad</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Estadistica.html">Fundamentos de Estadística</a></li>
<li class="toctree-l1"><a class="reference internal" href="Taller_1_Sol.html">Taller 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Taller_2.html">Taller 2</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F4_Regresion.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/4_Regresion.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelo de Regresión Multiple</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-retornos-a-la-educacion-experiencia-y-gaps">Aplicación: Retornos a la Educación, Experiencia, y Gaps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covariables-no-lineales">Covariables No-lineales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covariables-binarias">Covariables Binarias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-en-forma-matricial">Modelo de Regresión en Forma Matricial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supuestos-en-forma-matricial">Supuestos en forma Matricial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-ordinarios">Mínimos Cuadrados Ordinarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Mínimos Cuadrados Ordinarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimadores-de-beta">Estimadores de <span class="math notranslate nohighlight">\(\beta\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices-y-sumatorias">Matrices y Sumatorias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo">Ejemplo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices-m-y-p">Matrices <span class="math notranslate nohighlight">\(M\)</span> y <span class="math notranslate nohighlight">\(P\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propiedades-de-p-y-m">Propiedades de <span class="math notranslate nohighlight">\(P\)</span> y <span class="math notranslate nohighlight">\(M\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propiedades-de-hat-beta">Propiedades de <span class="math notranslate nohighlight">\(\hat\beta\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relacion-entre-hat-beta-y-e-y-hat-y">Relación entre <span class="math notranslate nohighlight">\(\hat\beta\)</span> y <span class="math notranslate nohighlight">\(e = Y - \hat Y\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-varianza-y-covarianza">Matriz de Varianza y Covarianza</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-significancia-individual">Pruebas de Significancia Individual</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-continuacion">Ejemplo (Continuación)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bondad-de-ajuste-r-2-y-r-2-ajustado">Bondad de Ajuste: <span class="math notranslate nohighlight">\(R^2\)</span> y <span class="math notranslate nohighlight">\(R^2\)</span>-Ajustado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-signifiancia-global">Prueba de Signifiancia Global</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otras-pruebas-de-hipotesis">Otras Pruebas de Hipotesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estadistico-t">Estadístico T</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estadistico-f">Estadístico F</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Ejemplo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#varias-restricciones">Varias Restricciones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-restringidos">Minimos Cuadrados Restringidos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Ejemplo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-variables">Selección de Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-binarias-y-categoricas">Variables Binarias y Categoricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion">Aplicación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interacciones">Interacciones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaccion-entre-variables-binarias">Interacción entre Variables Binarias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaccion-entre-una-variable-binaria-y-una-continua">Interacción entre una Variable Binaria y una Continua</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#teorema-de-gauss-markov">Teorema de Gauss-Markov</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demostacion-del-teorema-de-gauss-markov">Demostación del Teorema de Gauss-Markov</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demostracion-del-teorema-de-gauss-markov">Demostración del Teorema de Gauss-Markov</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelo-de-regresion-multiple">
<h1>Modelo de Regresión Multiple<a class="headerlink" href="#modelo-de-regresion-multiple" title="Link to this heading">#</a></h1>
<p>Un modelo de regresión con múltiples covariables o predictores se puede escribir de la siguiente manera:</p>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \beta_1 x_{1,i} + ... + \beta_{k-1} x_{k-1, i} + \varepsilon_i\]</div>
<p>Observe que queremos estimar <span class="math notranslate nohighlight">\(k\)</span> parámetros (incluyendo a <span class="math notranslate nohighlight">\(\beta_0\)</span>), usando <span class="math notranslate nohighlight">\(k-1\)</span> covariables a partir de una base de datos con <span class="math notranslate nohighlight">\(n\)</span> observaciones</p>
<div class="math notranslate nohighlight">
\[\{y_i, x_{1,i}, x_{2,i}, ..., x_{k-1,i}\}_{i=1}^n\]</div>
<p>Pero antes de derivar los estimadores de los parámetros <span class="math notranslate nohighlight">\(\beta_j\)</span>, veamos una aplicación:</p>
<section id="aplicacion-retornos-a-la-educacion-experiencia-y-gaps">
<h2>Aplicación: Retornos a la Educación, Experiencia, y Gaps<a class="headerlink" href="#aplicacion-retornos-a-la-educacion-experiencia-y-gaps" title="Link to this heading">#</a></h2>
<p>Consideremos ahora la siguiente extensión del modelo minceriano:</p>
<div class="math notranslate nohighlight">
\[\log(w_i) = \beta_0 + \beta_1 s_i + \beta_2 x_i + \beta_3 x_i^2 + \beta_4 f_i + \varepsilon_i\]</div>
<p>donde:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w_i\)</span> representa el ingreso laboral del individuo <span class="math notranslate nohighlight">\(i\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(s_i\)</span> sus años de educación, <span class="math notranslate nohighlight">\(x_i\)</span> la experiencia laboral, y</p></li>
<li><p><span class="math notranslate nohighlight">\(f_i\)</span> es una variable binaria que toma el valor de 1 si <span class="math notranslate nohighlight">\(i\)</span> es mujer y <span class="math notranslate nohighlight">\(0\)</span> si no.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;wooldridge&quot;</span><span class="p">);</span><span class="w"> </span><span class="nf">library</span><span class="p">(</span><span class="n">wooldridge</span><span class="p">)</span>
<span class="nf">data</span><span class="p">(</span><span class="s">&#39;wage1&#39;</span><span class="p">);</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">wage1</span><span class="p">)</span><span class="w"> </span><span class="c1">#Cargar datos</span>
<span class="n">wage1</span><span class="o">$</span><span class="n">ln_wage</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="c1">#Limpiar Datos</span>
<span class="n">wage1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">wage1</span><span class="p">[</span><span class="n">wage1</span><span class="o">$</span><span class="n">ln_wage</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>
<span class="n">wage1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">wage1</span><span class="p">[</span><span class="n">wage1</span><span class="o">$</span><span class="n">educ</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing package into &#39;C:/Users/smontano/AppData/Local/R/win-library/4.3&#39;
(as &#39;lib&#39; is unspecified)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>package &#39;wooldridge&#39; successfully unpacked and MD5 sums checked
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The downloaded binary packages are in
	C:\Users\smontano\AppData\Local\Temp\Rtmpq08Qzl\downloaded_packages
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
&quot;package &#39;wooldridge&#39; was built under R version 4.3.3&quot;
</pre></div>
</div>
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'wage'</li><li>'educ'</li><li>'exper'</li><li>'tenure'</li><li>'nonwhite'</li><li>'female'</li><li>'married'</li><li>'numdep'</li><li>'smsa'</li><li>'northcen'</li><li>'south'</li><li>'west'</li><li>'construc'</li><li>'ndurman'</li><li>'trcommpu'</li><li>'trade'</li><li>'services'</li><li>'profserv'</li><li>'profocc'</li><li>'clerocc'</li><li>'servocc'</li><li>'lwage'</li><li>'expersq'</li><li>'tenursq'</li></ol>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">full_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">educ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expersq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">)</span><span class="w"> </span><span class="c1">#Correr modelo</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">full_model</span><span class="p">)</span><span class="w"> </span><span class="c1">#Presentar resultados</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(wage) ~ educ + exper + expersq + female, data = wage1)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.1629 -0.2765 -0.0211  0.2546  1.1970 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.3096151  0.1087687   2.847   0.0046 ** 
educ         0.0910553  0.0074975  12.145  &lt; 2e-16 ***
exper        0.0377801  0.0048163   7.844 2.56e-14 ***
expersq     -0.0006676  0.0001079  -6.186 1.26e-09 ***
female      -0.3310652  0.0360205  -9.191  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4059 on 512 degrees of freedom
Multiple R-squared:  0.4034,	Adjusted R-squared:  0.3987 
F-statistic: 86.54 on 4 and 512 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="covariables-no-lineales">
<h2>Covariables No-lineales<a class="headerlink" href="#covariables-no-lineales" title="Link to this heading">#</a></h2>
<p>Observe que para interpretar el <strong>efecto de la experiencia</strong> en el salario, debemos suponer que las otras variables permanenen constantes:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \log(w_i)}{\partial x_i} = \beta_2 + 2 \cdot \beta_3 x_i\]</div>
<p>Así, <em>ceteris paribus</em> (todo lo demás constante), un incremento en un año de experiencia, aumenta el salario en <span class="math notranslate nohighlight">\((\beta_2 + 2 \cdot x_i \cdot \beta_3)100\%\)</span>. Note que para una persona que pasa de 1 a 2 años, el salario aumenta en <span class="math notranslate nohighlight">\((3.8\% - 2\cdot2\cdot(0.06\%)) \approx 3.51\%\)</span>. Para una pesona que pasa de 2 a 3 años, el salario aumenta en <span class="math notranslate nohighlight">\((3.8\% - 2\cdot3\cdot(0.06\%)) \approx 3.37\%\)</span>.</p>
<p>A continuación estimamos el modelo (restringido) <span class="math notranslate nohighlight">\(\log(w_i) = \beta_0 + \beta_2 x_i + \beta_3 x_i^2\)</span>, que nos permite observar la <strong>no linealidad</strong> del efecto de la experiencia en el salario.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">exper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expersq</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">)</span>
<span class="n">model_fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="nf">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">se.fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;confidence&quot;</span><span class="p">,</span><span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.99</span><span class="p">))</span>
<span class="nf">names</span><span class="p">(</span><span class="n">model_fit</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;yhat&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;lwr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;upr&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;se&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;df&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;residuals&#39;</span><span class="p">)</span>

<span class="nf">plot</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">exper</span><span class="p">,</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">wage</span><span class="p">),</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Relación Salarios y Experiencia&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Experiencia&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Log(Wage)&#39;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">exper</span><span class="p">),</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">yhat</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">exper</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">exper</span><span class="p">),</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">lwr</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">exper</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">exper</span><span class="p">),</span><span class="w"> </span><span class="n">model_fit</span><span class="o">$</span><span class="n">upr</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">exper</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/f9e887d18099d6a779aa88c7bf05ac4199285665552a6f5c55c4777ccad1e86d.png"><img alt="_images/f9e887d18099d6a779aa88c7bf05ac4199285665552a6f5c55c4777ccad1e86d.png" src="_images/f9e887d18099d6a779aa88c7bf05ac4199285665552a6f5c55c4777ccad1e86d.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
</section>
<section id="covariables-binarias">
<h2>Covariables Binarias<a class="headerlink" href="#covariables-binarias" title="Link to this heading">#</a></h2>
<p>Cómo interpretamos el efecto de ser mujer en los salarios? Note que no podemos tomar derivadas porque <span class="math notranslate nohighlight">\(f_i\)</span> no es una variable continua.</p>
<p>Sin embargo observe que:</p>
<div class="math notranslate nohighlight">
\[E\left(\log(w_i) | f_i = 0 \right) = \beta_0 + \beta_1 s_i + \beta_2 x_i + \beta_3 x_i^2\]</div>
<div class="math notranslate nohighlight">
\[E\left(\log(w_i) | f_i = 1 \right) = \beta_0 + \beta_1 s_i + \beta_2 x_i + \beta_3 x_i^2 + \beta_4\]</div>
<p>Es facil ver que:</p>
<div class="math notranslate nohighlight">
\[E\left(\log(w_i) | f_i = 1 \right) - E\left(\log(w_i) | f_i = 0 \right) = \beta_4\]</div>
<p>Es decir, <span class="math notranslate nohighlight">\(\beta_4\)</span> es el cambio promedio en el salario por ser mujer.</p>
<p>A partir de nuestras estimaciones, ser mujer reduce el salario en 33%, <em>ceteris paribus</em>.</p>
<p>A continuación mostramos que nuestro modelo nos permite ajustar una línea (plano) para hombres y mujeres. Para ello usarémos el modelo (restringido) <span class="math notranslate nohighlight">\(\log(w_i) = \beta_0 + \beta_1 s_i + \beta_4 f_i\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">educ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">)</span>
<span class="n">males</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">model</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span><span class="n">wage1</span><span class="o">$</span><span class="n">educ</span>
<span class="n">females</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p">(</span><span class="n">model</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">model</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">3</span><span class="p">])</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">model</span><span class="o">$</span><span class="n">coefficients</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="o">*</span><span class="n">wage1</span><span class="o">$</span><span class="n">educ</span>

<span class="n">colors</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;#FDAE61&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#66BD63&quot;</span><span class="p">);</span><span class="w"> </span><span class="n">markers</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">19</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">educ</span><span class="p">,</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">wage</span><span class="p">),</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">markers</span><span class="p">[</span><span class="nf">factor</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">female</span><span class="p">)],</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">colors</span><span class="p">[</span><span class="nf">factor</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">female</span><span class="p">)],</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Relación Salarios y Educación&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Años de Educación&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Log(Wage)&#39;</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">educ</span><span class="p">),</span><span class="w"> </span><span class="n">males</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">educ</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;#FDAE61&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">educ</span><span class="p">),</span><span class="w"> </span><span class="n">females</span><span class="p">[</span><span class="nf">order</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">educ</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;#66BD63&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/9b1223299eb2bd51f8a0ae14d6f60fef88cda0aad43d7baff0f4a7c564c67c25.png"><img alt="_images/9b1223299eb2bd51f8a0ae14d6f60fef88cda0aad43d7baff0f4a7c564c67c25.png" src="_images/9b1223299eb2bd51f8a0ae14d6f60fef88cda0aad43d7baff0f4a7c564c67c25.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
</section>
<section id="modelo-de-regresion-en-forma-matricial">
<h2>Modelo de Regresión en Forma Matricial<a class="headerlink" href="#modelo-de-regresion-en-forma-matricial" title="Link to this heading">#</a></h2>
<p>En forma matricial, nuestro modelo de regresión se ve de la siguiente forma:</p>
<div class="math notranslate nohighlight">
\[Y = X\beta + \varepsilon\]</div>
<p>Observe que tenemos cuatro matrices:</p>
<div class="math notranslate nohighlight">
\[
Y_{[n \times 1]} = X_{[n \times k]} \, \beta_{[k \times 1]} + \varepsilon_{[n \times 1]}
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
y_1 \\
y_2 \\
\vdots \\
y_n
\end{bmatrix}
=
\begin{bmatrix}
1 &amp; x_{11} &amp; x_{21} &amp; \dots &amp; x_{k-1,1} \\
1 &amp; x_{12} &amp; x_{22} &amp; \dots &amp; x_{k-1,2} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; x_{1n} &amp; x_{2n} &amp; \dots &amp; x_{k-1,n}
\end{bmatrix}
\begin{bmatrix}
\beta_0 \\
\beta_1 \\
\vdots \\
\beta_{k-1}
\end{bmatrix}
+
\begin{bmatrix}
\varepsilon_1 \\
\varepsilon_2 \\
\vdots \\
\varepsilon_n
\end{bmatrix}
\end{split}\]</div>
<p>La forma matricial es una manera útil de presentar <span class="math notranslate nohighlight">\(n\)</span> <strong>ecuaciones</strong>, ya que:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{bmatrix}
y_1 \\
y_2 \\
\vdots \\
y_n
\end{bmatrix}
=
\begin{bmatrix}
\beta_0 + \sum_j^{k-1} \beta_j x_{j1} + \varepsilon_1 \\
\beta_0 + \sum_j^{k-1} \beta_j x_{j2} + \varepsilon_2 \\
\vdots \\
\beta_0 + \sum_j^{k-1} \beta_j x_{jn} + \varepsilon_n
\end{bmatrix}
\end{split}\]</div>
</section>
<section id="supuestos-en-forma-matricial">
<h2>Supuestos en forma Matricial<a class="headerlink" href="#supuestos-en-forma-matricial" title="Link to this heading">#</a></h2>
<p>¿Cómo se ven los supuestos sobre el error cuando tenemos matrices?</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\varepsilon \varepsilon' =
\begin{bmatrix}
\varepsilon_1 \\
\varepsilon_2 \\
\vdots \\
\varepsilon_n
\end{bmatrix}
\begin{bmatrix}
\varepsilon_1 &amp; \varepsilon_2 &amp; \dots &amp; \varepsilon_n
\end{bmatrix}
=
\begin{bmatrix}
\varepsilon_1^2 &amp; \varepsilon_1\varepsilon_2 &amp; \dots &amp; \varepsilon_1\varepsilon_n \\
\varepsilon_2\varepsilon_1 &amp; \varepsilon_2^2 &amp; \dots &amp; \varepsilon_2\varepsilon_n \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\varepsilon_n\varepsilon_1 &amp; \varepsilon_n\varepsilon_2 &amp; \dots &amp; \varepsilon_n^2
\end{bmatrix}
\end{split}\]</div>
<p>Observe que bajo homoscedasticidad y no autocorrelación:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
E[\varepsilon \varepsilon'] =
\begin{bmatrix}
\sigma^2 &amp; 0 &amp; \dots &amp; 0 \\
0 &amp; \sigma^2 &amp; \dots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
0 &amp; 0 &amp; \dots &amp; \sigma^2
\end{bmatrix}
= \sigma^2 I_n
\end{split}\]</div>
<p>Si asumimos independencia condicional y además que los errores son normales, entonces:</p>
<div class="math notranslate nohighlight">
\[E(\varepsilon | x_1, ...., x_{k-1}) = E(\varepsilon | X) = 0\]</div>
<div class="math notranslate nohighlight">
\[\varepsilon \sim N(0, \sigma^2 I_n)\]</div>
</section>
<section id="minimos-cuadrados-ordinarios">
<h2>Mínimos Cuadrados Ordinarios<a class="headerlink" href="#minimos-cuadrados-ordinarios" title="Link to this heading">#</a></h2>
<p>Antes de derivar nuestros estimadores de mínimos cuadrados usando matrices, veremos que es posible encontrar los estimadores de manera similar que en el caso de regresión simple. Nuestro modelo está dado por:</p>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \sum_{j = 1}^{k-1} \beta_j x_{j,i} + \varepsilon_i\]</div>
<p>Así, definimos la función de perdida cómo:</p>
<div class="math notranslate nohighlight">
\[\mathcal{L}(\beta_0, ..., \beta_{k-1}) = \sum_i^n \varepsilon_i^2 = \sum_i^n \left(y_i - \beta_0 - \sum_{j = 1}^{k-1} \beta_j x_{j,i} \right)^2\]</div>
<p>Para encontrar los estimadores de MCO para <span class="math notranslate nohighlight">\(\beta_0, ..., \beta_{k-1}\)</span> debemos resolver el siguiente problema:</p>
<div class="math notranslate nohighlight">
\[\min_{\beta_0, ..., \beta_{k-1}} \mathcal{L}(\beta_0, ..., \beta_{k-1}) = \sum_i^n \varepsilon_i^2\]</div>
<p>Las condiciones de primer orden para este problema están dadas por:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{L}}{\partial\beta_0} \bigg|_{\hat\beta} = \sum_i (-2) \cdot ({y_i} - \beta_0 - \sum_{j = 1}^{k-1} \beta_j x_{j,i}) \bigg|_{\hat\beta} = 0\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{L}}{\partial\beta_1} \bigg|_{\hat\beta} = \sum_i (-2 x_{1,i}) \cdot ({y_i} - \beta_0 \sum_{j = 1}^{k-1} \beta_j x_{j,i}) \bigg|_{\hat\beta} = 0\]</div>
<div class="math notranslate nohighlight">
\[\vdots\]</div>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{L}}{\partial\beta_{k-1}} \bigg|_{\hat\beta} = \sum_i (-2 x_{k-1,i}) \cdot ({y_i} - \beta_0 - \sum_{j = 1}^{k-1} \beta_j x_{j,i}) \bigg|_{\hat\beta} = 0\]</div>
<p>Observe que tenemos <span class="math notranslate nohighlight">\(k\)</span> ecuaciones para estimar <span class="math notranslate nohighlight">\(k\)</span> parámetros.</p>
<p>Lo anterior nos permite concluir que este sistema de ecuaciones tiene solución. Sin embargo, solucionarlo alegabraicamente puede ser bastante tedioso. Por esta razón usaremos matrices.</p>
</section>
<section id="id1">
<h2>Mínimos Cuadrados Ordinarios<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Observe que matricialmente</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\varepsilon' \varepsilon =
\begin{bmatrix}
\varepsilon_1 &amp; \varepsilon_2 &amp; \dots &amp; \varepsilon_n
\end{bmatrix}_{1 \times n}
\begin{bmatrix}
\varepsilon_1 \\
\varepsilon_2 \\
\vdots \\
\varepsilon_n
\end{bmatrix}_{\hspace{2pt} n \times 1} = 
\varepsilon_1^2 + \varepsilon_2^2 + ... + \varepsilon_n^2 =
\sum_{i = 1}^n \varepsilon_i^2
\end{split}\]</div>
<p>Luego nuestro problema de minimización se puede reescribir de la siguiente manera:</p>
<div class="math notranslate nohighlight">
\[\min_\beta \varepsilon'\varepsilon = \min_\beta (Y - X\beta)'(Y - X\beta) = \min_\beta Y'Y - 2\beta'X'Y + \beta' X'X\beta\]</div>
<p>Nota: <span class="math notranslate nohighlight">\(Y'X\beta = \beta'X'Y\)</span> ya que son escalares.</p>
</section>
<section id="estimadores-de-beta">
<h2>Estimadores de <span class="math notranslate nohighlight">\(\beta\)</span><a class="headerlink" href="#estimadores-de-beta" title="Link to this heading">#</a></h2>
<p>Las condiciones de primer orden están dadas por</p>
<div class="math notranslate nohighlight">
\[\frac{\partial\mathcal{(\varepsilon'\varepsilon)}}{\partial\beta} \bigg|_{\beta = \hat \beta} = -2 X'Y + 2 X'X\hat\beta = 0\]</div>
<p>Esto es así porque <span class="math notranslate nohighlight">\(\frac{\partial(X'Y)'\beta}{\partial\beta} = X'Y\)</span>, <span class="math notranslate nohighlight">\(\frac{\partial \beta' X'X\beta}{\partial\beta} = (X'X + (X'X)')\beta = 2X'X\beta\)</span></p>
<p>De esta manera, el estimador de MCO para <span class="math notranslate nohighlight">\(\beta\)</span> es</p>
<div class="math notranslate nohighlight">
\[\hat\beta = (X'X)^{-1}(X'Y)\]</div>
<p>Observe que a partir de las condiciones de primer orden podemos determinar que</p>
<div class="math notranslate nohighlight">
\[0 = X'Y - X'X\hat\beta = X'(Y - X'X\hat\beta) = X'e\]</div>
</section>
<section id="matrices-y-sumatorias">
<h2>Matrices y Sumatorias<a class="headerlink" href="#matrices-y-sumatorias" title="Link to this heading">#</a></h2>
<p>La matriz <span class="math notranslate nohighlight">\((X'X)^{-1}\)</span> es conocida usalmente como <strong>matriz de información</strong>. Observe que</p>
<div class="math notranslate nohighlight">
\[\begin{split}
X'X =
\begin{bmatrix}
n &amp; \sum_i x_{1i} &amp; \sum_i x_{2i} &amp; \sum_i x_{3i} &amp; \cdots &amp; \sum_i x_{k-1, i} \\
\sum_i x_{1i} &amp; \sum_i x_{1i}^2 &amp; \sum_i x_{1i}x_{2i} &amp; \sum_i x_{1i}x_{3i} &amp; \cdots &amp; \sum_i x_{1i}x_{k-1,i} \\
\sum_i x_{2i} &amp; \sum_i x_{2i}x_{1i} &amp; \sum_i x_{2i}^2 &amp; \sum_i x_{2i}x_{3i} &amp; \cdots &amp; \sum_i x_{2i}x_{k-1,i} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\sum_i x_{k-1,i} &amp; \sum_i x_{k-1,i}x_{1i} &amp; \sum_i x_{k-1,i}x_{2i} &amp; \sum_i x_{k-1,i}x_{3i} &amp; \cdots &amp; \sum_i x_{k-1,i}^2
\end{bmatrix} \hspace{5pt},\hspace{5pt} X'Y =
\begin{bmatrix}
\sum_i y_i \\
\sum_i x_{1i}y_i \\
\sum_i x_{2i}y_i \\
\vdots \\
\sum_i x_{k-1,i}y_i
\end{bmatrix}
\end{split}\]</div>
</section>
<section id="ejemplo">
<h2>Ejemplo<a class="headerlink" href="#ejemplo" title="Link to this heading">#</a></h2>
<p>Usando los siguientes datos queremos estimar el modelo <span class="math notranslate nohighlight">\(Y = X\beta + \varepsilon\)</span>, donde <span class="math notranslate nohighlight">\(\beta = [\beta_0,  \beta_1]'\)</span> :</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Y =
\begin{bmatrix}
8 \\
9 \\
4 \\
2 \\
7 \\
3 \\
\end{bmatrix} \hspace{2pt},\hspace{2pt} X =
\begin{bmatrix}
1 &amp; 4 \\
1 &amp; 3 \\
1 &amp; 10 \\
1 &amp; 11 \\
1 &amp; 6 \\
1 &amp; 9 \\
\end{bmatrix}
\end{split}\]</div>
<p>A partir de esta información debemos calcular las siguientes matrices:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
X'X =
\begin{bmatrix}
6 &amp; 43 \\
43 &amp; 363 \\
\end{bmatrix} \hspace{2pt},\hspace{2pt} (X'X)^{-1} = \frac{1}{329} \cdot
\begin{bmatrix}
363 &amp; -43 \\
-43 &amp; 6 \\
\end{bmatrix} \hspace{2pt},\hspace{2pt} X'Y =
\begin{bmatrix}
33 \\
190 \\
\end{bmatrix}
\end{split}\]</div>
<p>Recuerde que nuestro estimador de <span class="math notranslate nohighlight">\(\beta\)</span> es <span class="math notranslate nohighlight">\(\hat \beta = (X'X)^{-1}X'Y\)</span>. Así,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\hat\beta = \frac{1}{329} \cdot
\begin{bmatrix}
363 &amp; -43 \\
-43 &amp; 6 \\
\end{bmatrix} \cdot
\begin{bmatrix}
33 \\
190 \\
\end{bmatrix} =
\begin{bmatrix}
11.5775076 \\
-0.8480243 \\
\end{bmatrix}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
<span class="n">x1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="n">x2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">11</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">)</span>
<span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">)</span>

<span class="n">XX</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">%*%</span><span class="n">X</span>
<span class="n">XX1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">solve</span><span class="p">(</span><span class="n">XX</span><span class="p">)</span>
<span class="n">XY</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">t</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">%*%</span><span class="n">Y</span>

<span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">XX1</span><span class="o">%*%</span><span class="n">XY</span><span class="p">;</span><span class="w"> </span><span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A matrix: 2 × 1 of type dbl</caption>
<tbody>
	<tr><th scope=row>x1</th><td>11.5775076</td></tr>
	<tr><th scope=row>x2</th><td>-0.8480243</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Y ~ x2)

Residuals:
       1        2        3        4        5        6 
-0.18541 -0.03343  0.90274 -0.24924  0.51064 -0.94529 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.57751    0.75506  15.333 0.000106 ***
x2          -0.84802    0.09707  -8.736 0.000946 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7188 on 4 degrees of freedom
Multiple R-squared:  0.9502,	Adjusted R-squared:  0.9377 
F-statistic: 76.31 on 1 and 4 DF,  p-value: 0.0009461
</pre></div>
</div>
</div>
</div>
</section>
<section id="matrices-m-y-p">
<h2>Matrices <span class="math notranslate nohighlight">\(M\)</span> y <span class="math notranslate nohighlight">\(P\)</span><a class="headerlink" href="#matrices-m-y-p" title="Link to this heading">#</a></h2>
<p>Las siguientes matrices tienen propiedades importantes:</p>
<p>La <strong>matriz proyección</strong>, <span class="math notranslate nohighlight">\(P\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\hat Y &amp;= X\hat\beta \\
&amp;= \underbrace{X(X'X)^{-1}X'}_PY \\
&amp;= PY
\end{align*}\]</div>
<p>La <strong>matriz generadora de residuos</strong>, <span class="math notranslate nohighlight">\(M\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
e &amp;= Y - X\hat\beta \\
&amp;= Y - X(X'X)^{-1}X'Y \\
&amp;= (I - X(X'X)^{-1}X') Y \\
&amp;= \underbrace{(I - P)}_M Y \\
&amp;= MY
\end{align*}\]</div>
</section>
<section id="propiedades-de-p-y-m">
<h2>Propiedades de <span class="math notranslate nohighlight">\(P\)</span> y <span class="math notranslate nohighlight">\(M\)</span><a class="headerlink" href="#propiedades-de-p-y-m" title="Link to this heading">#</a></h2>
<p><span class="math notranslate nohighlight">\(P\)</span> y <span class="math notranslate nohighlight">\(M\)</span> son simétricas e idempotentes, es decir,</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(P = P'\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(M = M'\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(P'P = P\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(M'M = M\)</span></p></li>
</ol>
<p>Por otro lado,</p>
<ol class="arabic simple" start="5">
<li><p><span class="math notranslate nohighlight">\(PX = X\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(MX = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(PM = 0\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(Y = PY + MY\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(e = M\varepsilon\)</span></p></li>
</ol>
<p><strong>Demuestren</strong> 5, 6, 8, y 9.</p>
</section>
<section id="propiedades-de-hat-beta">
<h2>Propiedades de <span class="math notranslate nohighlight">\(\hat\beta\)</span><a class="headerlink" href="#propiedades-de-hat-beta" title="Link to this heading">#</a></h2>
<p>Mostremos ahora <span class="math notranslate nohighlight">\(E(\hat\beta) = \beta\)</span>. Observe que</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\hat\beta &amp;= (X'X)^{-1}X'Y \\
&amp;= (X'X)^{-1}X'(X\beta + \varepsilon) \\
&amp;= (X'X)^{-1}X'X\beta + (X'X)^{-1}X'\varepsilon) \\
&amp;= \beta + (X'X)^{-1}X'\varepsilon \\
\end{align*}\]</div>
<p>Luego, es fácil ver que</p>
<div class="math notranslate nohighlight">
\[E(\hat\beta | X) = \beta + (X'X)^{-1}X'E(\varepsilon | X)\]</div>
<p>Por el supuesto de independencia condicional <span class="math notranslate nohighlight">\(E(\varepsilon | X) = 0\)</span>. Lo que implica que <span class="math notranslate nohighlight">\(E(\hat\beta | X) = \beta\)</span></p>
<p>Por la ley de esperanzas iteradas podemos demostrar que</p>
<div class="math notranslate nohighlight">
\[E[E(\hat\beta | X)] = E[\hat\beta] = \beta\]</div>
</section>
<section id="relacion-entre-hat-beta-y-e-y-hat-y">
<h2>Relación entre <span class="math notranslate nohighlight">\(\hat\beta\)</span> y <span class="math notranslate nohighlight">\(e = Y - \hat Y\)</span><a class="headerlink" href="#relacion-entre-hat-beta-y-e-y-hat-y" title="Link to this heading">#</a></h2>
<p>Usando las propiedes vistas anteriormente, mostremos que la covarianza entre <span class="math notranslate nohighlight">\(\hat\beta\)</span> y <span class="math notranslate nohighlight">\(e\)</span> es 0.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
Cov(\hat\beta, e) &amp;= E[(\hat\beta - E(\hat\beta))(e - E(e))'] \\
&amp;= E[(\hat\beta - \beta)(M\varepsilon - E(M\varepsilon))'] \\
&amp;= E[(\hat\beta - \beta)\varepsilon'M'] \\
&amp;= E[\hat\beta\varepsilon'M'] - \beta E[\varepsilon'M'] \\
&amp;= E[(X'X)^{-1}X'Y\varepsilon'M'] \\
&amp;= E[(X'X)^{-1}X'(X\beta + \varepsilon)\varepsilon'M'] \\
&amp;= E[(X'X)^{-1}X'\varepsilon\varepsilon'M'] \\
&amp;= (X'X)^{-1}X'E[\varepsilon\varepsilon']M' \\
&amp;= \sigma^2(X'X)^{-1}X'M' \\
&amp;= \sigma^2(X'X)^{-1}(MX)' = 0 \\
\end{align*}\]</div>
</section>
<section id="matriz-de-varianza-y-covarianza">
<h2>Matriz de Varianza y Covarianza<a class="headerlink" href="#matriz-de-varianza-y-covarianza" title="Link to this heading">#</a></h2>
<p>Ahora queremos determinar la varianza de <span class="math notranslate nohighlight">\(\hat\beta\)</span>, en forma matricial procedemos de la siguiente manera:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
V(\hat{\beta}|X ) &amp;= E \big[(\hat{\beta} - E[\hat{\beta}])(\hat{\beta} - E[\hat{\beta}])' \,|\, X \big] \\
&amp;= E \big[(\beta + (X'X)^{-1}X'\varepsilon - \beta])(\beta + (X'X)^{-1}X'\varepsilon - \beta])' \,|\, X \big] \\
&amp;= E \big[((X'X)^{-1}X'\varepsilon)((X'X)^{-1}X'\varepsilon)' \,|\, X \big] \\
&amp;= E \big[(X'X)^{-1}X'\varepsilon\varepsilon'X(X'X)^{-1} \,|\, X \big] \\
&amp;= (X'X)^{-1}X' E[\varepsilon\varepsilon'|X] X (X'X)^{-1} \\
&amp;= (X'X)^{-1}X' \sigma^2 I X (X'X)^{-1} \\
&amp;=\sigma^2 (X'X)^{-1}X'X (X'X)^{-1} \\
&amp;= \sigma^2 (X'X)^{-1}
\end{align*}\]</div>
<p>Observe que la solución anterior no solo nos permite encontrar las varianzas para cada <span class="math notranslate nohighlight">\(\hat\beta_j\)</span>, <span class="math notranslate nohighlight">\(j \in \{0, 1, ..., k-1\}\)</span>, sino también la covarianza entre <span class="math notranslate nohighlight">\(\hat\beta_j\)</span> y <span class="math notranslate nohighlight">\(\hat\beta_l\)</span> para todo <span class="math notranslate nohighlight">\(j \neq l\)</span>. Es decir,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
V(\hat{\beta} | X) =
\begin{bmatrix}
Var(\hat{\beta}_0) &amp; Cov(\hat{\beta}_0, \hat{\beta}_1) &amp; \dots &amp; Cov(\hat{\beta}_0, \hat{\beta}_K) \\
Cov(\hat{\beta}_1, \hat{\beta}_0) &amp; Var(\hat{\beta}_1) &amp; \dots &amp; Cov(\hat{\beta}_1, \hat{\beta}_K) \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
Cov(\hat{\beta}_K, \hat{\beta}_0) &amp; Cov(\hat{\beta}_K, \hat{\beta}_1) &amp; \dots &amp; Var(\hat{\beta}_K)
\end{bmatrix} = \sigma^2 (X'X)^{-1}
\end{split}\]</div>
<p>Recuerde que un estimador para <span class="math notranslate nohighlight">\(\sigma^2\)</span> es:</p>
<div class="math notranslate nohighlight">
\[\hat\sigma^2 = \frac{\sum_i e_i^2}{n-k} = \frac{e'e}{n-k}\]</div>
<p>Entonces,</p>
<div class="math notranslate nohighlight">
\[\widehat{V(\hat{\beta} | X)} = \frac{e'e}{n-k}(X'X)^{-1}\]</div>
</section>
<section id="pruebas-de-significancia-individual">
<h2>Pruebas de Significancia Individual<a class="headerlink" href="#pruebas-de-significancia-individual" title="Link to this heading">#</a></h2>
<p>Para evaluar nuestro modelo, podemos considerar pruebas de hipótesis individuales para cada uno de los parámetros desconocidos <span class="math notranslate nohighlight">\(\beta_j\)</span>. Es decir, para todo <span class="math notranslate nohighlight">\(j \in \{0, ..., k-1\}\)</span> evaluamos:</p>
<div class="math notranslate nohighlight">
\[H_0 : \beta_j = 0\]</div>
<div class="math notranslate nohighlight">
\[H_1 : \beta_j \neq 0\]</div>
<p>Ya que asumimos que <span class="math notranslate nohighlight">\(\varepsilon  \sim N\left(0, \sigma^2 I\right)\)</span>, nuestros estimadores <span class="math notranslate nohighlight">\(\hat\beta \sim N\left(\beta, \sigma^2(X'X)^{-1}\right)\)</span>. Así, para evaluar nuestra hipótesis podemos usar el estadístico de prueba:</p>
<div class="math notranslate nohighlight">
\[T = \frac{\hat\beta_j}{\text{ee}(\hat\beta_j)} \sim t_{n-k}\]</div>
<p>Observe que <span class="math notranslate nohighlight">\(\text{ee}(\hat\beta_j)\)</span> se puede computar a partir de la matriz <span class="math notranslate nohighlight">\(\hat\sigma^2 (X'X)^{-1}\)</span>.</p>
</section>
<section id="ejemplo-continuacion">
<h2>Ejemplo (Continuación)<a class="headerlink" href="#ejemplo-continuacion" title="Link to this heading">#</a></h2>
<p>En nuestro ejemplo</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Y = [8, 9, 4, 2, 7, 3]' \hspace{5pt},\hspace{5pt}
(X'X)^{-1} = \frac{1}{329} \cdot
\begin{bmatrix}
363 &amp; -43 \\
-43 &amp; 6 \\
\end{bmatrix} \hspace{5pt},\hspace{5pt} \hat\beta =
\begin{bmatrix}
11.58 \\
-0.85 \\
\end{bmatrix}
\end{split}\]</div>
<p>Usando esta información podemos calcular:</p>
<div class="math notranslate nohighlight">
\[\hat Y = X\hat\beta = [8.18, 9.03, 3.10, 2.25, 6.49, 3.94]\]</div>
<div class="math notranslate nohighlight">
\[e = Y - \hat Y = [-0.18, -0.03, 0.90, -0.25, 0.51, -0.94]\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\hat\sigma^2=\frac{e'e}{6-2} = 0.516 \hspace{5pt},\hspace{5pt} \widehat{V(\hat\beta)} = \hat\sigma^2 \cdot (X'X)^{-1} = \frac{1}{329} \cdot
\begin{bmatrix}
363 &amp; -43 \\
-43 &amp; 6 \\
\end{bmatrix} =
\begin{bmatrix}
0.570 &amp; -0.0675 \\
-0.0675 &amp; 0.009 \\
\end{bmatrix}\end{split}\]</div>
<p>Luego, ee<span class="math notranslate nohighlight">\((\beta_0) = \sqrt{0.570} = 0.7551\)</span>, ee<span class="math notranslate nohighlight">\((\beta_1) = \sqrt{0.009} = 0.0971\)</span>, <span class="math notranslate nohighlight">\(Cov(\beta_0, \beta_1) = -0.0675\)</span></p>
</section>
<section id="bondad-de-ajuste-r-2-y-r-2-ajustado">
<h2>Bondad de Ajuste: <span class="math notranslate nohighlight">\(R^2\)</span> y <span class="math notranslate nohighlight">\(R^2\)</span>-Ajustado<a class="headerlink" href="#bondad-de-ajuste-r-2-y-r-2-ajustado" title="Link to this heading">#</a></h2>
<p>Al igual que en el caso de regresión simple, definimos</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
R^2 &amp;= \frac{\sum_i (\hat y_i -\bar{y})^2}{\sum_i (y_i -\bar{y})^2} = 1 - \frac{\sum_i (y_i - \hat y_i)^2}{\sum_i (y_i -\bar{y})^2} \\
&amp;= \frac{SSR}{SST} = 1 - \frac{SSE}{SST} 
\end{align*}\]</div>
<p>Sin embargo, <span class="math notranslate nohighlight">\(R^2\)</span> <strong>aumentará siempre que incluyamos una covariable adicional</strong>. Incluso si dicha covariable es ‘ruido’.</p>
<p>En el caso de regresión múltiple definimos un coeficiente ‘penaliza’ el poder predictivo del modelo cuando incluimos variables irrelevantes:</p>
<div class="math notranslate nohighlight">
\[R^2\text{- ajustado} = 1 - \frac{SSE\hspace{2pt}/\hspace{2pt}(n-k)}{SST\hspace{2pt}/\hspace{2pt}(n-1)}\]</div>
<p>Observe que al incluir una variable irrelevante, los residuales de nuestro modelo <span class="math notranslate nohighlight">\(e_i = y_i - \hat y_i\)</span> no cambiarán de manera considerable (con respecto al modelo que no incluye ruido). Sin embargo, ahora estamos dividiendo <span class="math notranslate nohighlight">\(SSE\)</span> por <span class="math notranslate nohighlight">\(n-k\)</span> (que penaliza el número de parámetros que queremos estimar).</p>
<p>Así, mientras <span class="math notranslate nohighlight">\(R^2\)</span> aumenta con el número de variables, <span class="math notranslate nohighlight">\(R^2\)</span>-ajustado puede disminuir. Veamos un ejemplo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">educ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expersq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(wage) ~ educ + exper + expersq + female, data = wage1)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.1629 -0.2765 -0.0211  0.2546  1.1970 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.3096151  0.1087687   2.847   0.0046 ** 
educ         0.0910553  0.0074975  12.145  &lt; 2e-16 ***
exper        0.0377801  0.0048163   7.844 2.56e-14 ***
expersq     -0.0006676  0.0001079  -6.186 1.26e-09 ***
female      -0.3310652  0.0360205  -9.191  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4059 on 512 degrees of freedom
Multiple R-squared:  0.4034,	Adjusted R-squared:  0.3987 
F-statistic: 86.54 on 4 and 512 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">wage1</span><span class="o">$</span><span class="n">wage</span><span class="p">)</span>
<span class="n">wage1</span><span class="o">$</span><span class="n">noise</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">educ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expersq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">noise</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(wage) ~ educ + exper + expersq + female + noise, 
    data = wage1)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.16978 -0.27463 -0.02081  0.25523  1.18248 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.2945035  0.1137148   2.590  0.00988 ** 
educ         0.0911575  0.0075066  12.144  &lt; 2e-16 ***
exper        0.0378379  0.0048217   7.847 2.51e-14 ***
expersq     -0.0006688  0.0001080  -6.191 1.23e-09 ***
female      -0.3311857  0.0360492  -9.187  &lt; 2e-16 ***
noise        0.0278812  0.0606946   0.459  0.64616    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4063 on 511 degrees of freedom
Multiple R-squared:  0.4036,	Adjusted R-squared:  0.3978 
F-statistic: 69.17 on 5 and 511 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="prueba-de-signifiancia-global">
<h2>Prueba de Signifiancia Global<a class="headerlink" href="#prueba-de-signifiancia-global" title="Link to this heading">#</a></h2>
<p>Al igual que en el caso de regresión simple, queremos evaluar el modelo de manera conjunta. Para ello consideramos la siguiente prueba de hipótesis:</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_1 = \beta_2 = ... = \beta_{k-1}\]</div>
<div class="math notranslate nohighlight">
\[H_1: \beta_j \neq 0 \text{ para cualquier } j \in \{1, ..., k-1\}\]</div>
<p>Nuestro estadístico de prueba para evaluar esta hipótesis es:</p>
<div class="math notranslate nohighlight">
\[F = \frac{MSR}{MSE} = \frac{SSR/(k-1)}{SSE/(n-k)} = \frac{\sum_i(\hat y_i - \bar{y})^2/(k-1)}{\sum_i(y_i - \hat y_i)^2/(n-k)} \sim F_{k-1,n-k}\]</div>
</section>
<section id="otras-pruebas-de-hipotesis">
<h2>Otras Pruebas de Hipotesis<a class="headerlink" href="#otras-pruebas-de-hipotesis" title="Link to this heading">#</a></h2>
<p>En el modelo multivariado podemos evaluar hipótesis para cuaquier (sub-)conjunto de parámetros. Algunos ejemplos son:</p>
<p>Sean <span class="math notranslate nohighlight">\(j, l, t \in \{0, 1, ..., k-1\}\)</span> y <span class="math notranslate nohighlight">\(c_1, c_2, c_3 \in \mathbb{R}\)</span>,</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_j = \beta_{l} + c_1\]</div>
<div class="math notranslate nohighlight">
\[H_0: \beta_j + \beta_{l} = \beta_{t}\]</div>
<div class="math notranslate nohighlight">
\[H_0: \beta_j = c_1\beta_l + c_2 \beta_t + c_3\]</div>
<p>A continuación presentamos dos estadísticos de prueba con los cuales podemos evaluar nuestras hipótesis.</p>
</section>
<section id="estadistico-t">
<h2>Estadístico T<a class="headerlink" href="#estadistico-t" title="Link to this heading">#</a></h2>
<p>Para la prueba</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_j = \beta_{l} + c_1\]</div>
<div class="math notranslate nohighlight">
\[H_1: \beta_j \neq \beta_{l} + c_1\]</div>
<p>Podemos usar el estadístico</p>
<div class="math notranslate nohighlight">
\[T = \frac{\hat\beta_j - \hat\beta_l - c_1}{\text{ee}(\hat\beta_j - \hat\beta_l - c_1)} = \frac{\hat\beta_j - \hat\beta_l - c_1}{\sqrt{Var(\hat\beta_j) + Var(\hat\beta_l) - 2Cov(\hat\beta_j, \hat\beta_l)}} \sim t_{n-k}\]</div>
<p>Observe que el error estandar de esta prueba lo podemos calcular a partir de la matrix de varianza-covarianza: <span class="math notranslate nohighlight">\(V(\hat\beta)\)</span>.</p>
</section>
<section id="estadistico-f">
<h2>Estadístico F<a class="headerlink" href="#estadistico-f" title="Link to this heading">#</a></h2>
<p>Para cualquier prueba que involucre combinaciones lineales de parámetros (i.e., pruebas similares a los ejemplos anteriores) podemos usar el siguiente estadístico:</p>
<div class="math notranslate nohighlight">
\[F = \frac{(R\hat\beta - r)'[R(X'X)^{-1}R']^{-1}(R\hat\beta - r)}{JS^2} \sim F_{J, n-k}\]</div>
<p>Donde</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(J\)</span> es el número de restricciones.</p></li>
<li><p><span class="math notranslate nohighlight">\(R\)</span> es una <strong>matriz de restricciones</strong> cuya dimensión es <span class="math notranslate nohighlight">\(J \times k\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(r\)</span> es una <strong>matriz de constantes</strong> o valores hipoteticos, y que tiene dimensión <span class="math notranslate nohighlight">\(J \times 1\)</span>. Note que esta puede ser una matriz de ceros.</p></li>
<li><p><span class="math notranslate nohighlight">\(S^2\)</span> es la varianza del modelo</p></li>
</ul>
<p>Considere la siguiente hipótesis:</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_j = c\]</div>
<div class="math notranslate nohighlight">
\[H_1: \beta_j \neq c\]</div>
<p>Entonces,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R\beta - r = [0 ... 0 \hspace{4pt} 1 \hspace{4pt} 0 ... 0] 
\begin{bmatrix}
\hat\beta_0 \\
\vdots \\
\hat\beta_{j-1} \\
\hat\beta_j \\
\hat\beta_{j+1} \\
\vdots \\
\hat\beta_{k-1} \\
\end{bmatrix} - c
\end{split}\]</div>
<p>Considere la siguiente hipótesis:</p>
<div class="math notranslate nohighlight">
\[H_0: \beta_j = \beta_l\]</div>
<div class="math notranslate nohighlight">
\[H_1: \beta_j \neq \beta_l\]</div>
<p>Entonces,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R\beta - r = [0 ... 1 ... 1 ... 0] \begin{bmatrix}
\hat\beta_0 \\
\vdots \\
\hat\beta_j \\
\vdots \\
\hat\beta_l \\
\vdots \\
\hat\beta_{k-1} \\
\end{bmatrix} - 0
\end{split}\]</div>
</section>
<section id="id2">
<h2>Ejemplo<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<p>Consideremos el modelo <span class="math notranslate nohighlight">\(Y = X\beta + \varepsilon\)</span> donde:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
Y =
\begin{bmatrix}
8 \\
9 \\
4 \\
2 \\
7 \\
3 \\
\end{bmatrix} \hspace{2pt},\hspace{2pt} X =
\begin{bmatrix}
1 &amp; 4 &amp; 0.401 \\
1 &amp; 3 &amp; 0.764 \\
1 &amp; 10 &amp; 0.889 \\
1 &amp; 11 &amp; 0.430 \\
1 &amp; 6 &amp; 0.076 \\
1 &amp; 9 &amp; 0.883 \\
\end{bmatrix}
\end{split}\]</div>
<p>Entonces</p>
<div class="math notranslate nohighlight">
\[\begin{split}
(X'X)^{-1} = 
\begin{bmatrix}
1.4407 &amp; -0.1120 &amp; -0.8204 \\
-0.1120 &amp; 0.0192 &amp; -0.0452 \\
-0.8204 &amp; -0.0452 &amp; 1.9950 \\
\end{bmatrix} \hspace{5pt},\hspace{5pt} \hat\beta =
\begin{bmatrix}
11.741 \\
-0.838 \\
-0.399 \\
\end{bmatrix} \hspace{5pt},\hspace{5pt} 
\sqrt{MSE} = \sqrt{S^2} = 0.814
\end{split}\]</div>
<p>Consideremos la prueba de hipótesis <span class="math notranslate nohighlight">\(H_0: \beta_2 = 0\)</span>. En este caso,</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((R\hat\beta - r) = \hat\beta_2\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(R(X'X)^{-1}R' = 1.9950\)</span></p></li>
</ol>
<p>Entonces,</p>
<div class="math notranslate nohighlight">
\[F = \frac{(R\hat\beta - r)'[R(X'X)^{-1}R']^{-1}(R\hat\beta - r)}{JS^2} = \frac{\hat\beta_2\cdot\hat\beta_2}{1.9950 \cdot 0.814^2} \approx 0.12 \sim F_{1, 3}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;car&#39;</span><span class="p">);</span><span class="w"> </span><span class="nf">library</span><span class="p">(</span><span class="s">&#39;car&#39;</span><span class="p">)</span>
<span class="n">x3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.401</span><span class="p">,</span><span class="w"> </span><span class="m">0.764</span><span class="p">,</span><span class="w"> </span><span class="m">0.889</span><span class="p">,</span><span class="w"> </span><span class="m">0.430</span><span class="p">,</span><span class="w"> </span><span class="m">0.076</span><span class="p">,</span><span class="w"> </span><span class="m">0.883</span><span class="p">)</span>
<span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x3</span><span class="p">);</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing package into &#39;C:/Users/smontano/AppData/Local/R/win-library/4.3&#39;
(as &#39;lib&#39; is unspecified)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>package &#39;car&#39; successfully unpacked and MD5 sums checked
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The downloaded binary packages are in
	C:\Users\smontano\AppData\Local\Temp\Rtmpq08Qzl\downloaded_packages
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
&quot;package &#39;car&#39; was built under R version 4.3.3&quot;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading required package: carData
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Y ~ x2 + x3)

Residuals:
      1       2       3       4       5       6 
-0.2258  0.0804  1.0030 -0.3415  0.3222 -0.8383 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  11.7419     0.9768  12.021  0.00124 **
x2           -0.8390     0.1129  -7.428  0.00505 **
x3           -0.3998     1.1494  -0.348  0.75093   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.8138 on 3 degrees of freedom
Multiple R-squared:  0.9521,	Adjusted R-squared:  0.9202 
F-statistic: 29.83 on 2 and 3 DF,  p-value: 0.01047
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">linearHypothesis</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">hypothesis.matrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">rhs</span><span class="o">=</span><span class="m">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A anova: 2 × 6</caption>
<thead>
	<tr><th></th><th scope=col>Res.Df</th><th scope=col>RSS</th><th scope=col>Df</th><th scope=col>Sum of Sq</th><th scope=col>F</th><th scope=col>Pr(&gt;F)</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>4</td><td>2.066869</td><td>NA</td><td>        NA</td><td>       NA</td><td>       NA</td></tr>
	<tr><th scope=row>2</th><td>3</td><td>1.986735</td><td> 1</td><td>0.08013399</td><td>0.1210035</td><td>0.7509251</td></tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="varias-restricciones">
<h2>Varias Restricciones<a class="headerlink" href="#varias-restricciones" title="Link to this heading">#</a></h2>
<p>Suponga que tenemos un modelo con 4 covariables y queremos evaluar la hipótesis:</p>
<div class="math notranslate nohighlight">
\[H_0 : \beta_1 = \beta_2 = \beta_4 = 0\]</div>
<p>En este caso tenemos 3 restricciones, luego <span class="math notranslate nohighlight">\(J = 3\)</span>. Además,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
R = 
\begin{bmatrix}
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 \\
\end{bmatrix}
\end{split}\]</div>
<div class="alert alert-block alert-warning"> 
<b>Ejercicio:</b>
<p>
<p>¿Cuál es la matriz R si queremos evaluar <span class="math notranslate nohighlight">\(H_0: \beta_2 = \beta_3\)</span> , <span class="math notranslate nohighlight">\(3\beta_1 - 5\beta_2 = \beta_4\)</span></p>
</div></section>
<section id="minimos-cuadrados-restringidos">
<h2>Minimos Cuadrados Restringidos<a class="headerlink" href="#minimos-cuadrados-restringidos" title="Link to this heading">#</a></h2>
<p>Este tipo de pruebas también se pueden hacer usando una regresión auxiliar a la cual se aplica la restricción.</p>
<p>Suponga que tenemos el siguiente modelo:</p>
<div class="math notranslate nohighlight">
\[
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + \beta_4 x_{4i} + \varepsilon_i
\]</div>
<p>Nos interesa evaluar:</p>
<div class="math notranslate nohighlight">
\[
H_0 : \beta_1 = \beta_3 = 0
\]</div>
<p>Entonces el modelo restringido sería:</p>
<div class="math notranslate nohighlight">
\[
y_i = \beta_0 + \beta_2 x_{2i} + \beta_4 x_{4i} + \varepsilon_i
\]</div>
<p>Hay varias formas de evaluar estas pruebas sin usar la matriz <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>Sin embargo, todas requieren de una regresión auxiliar donde usemos la restricción.</p>
<p>Los estadísticos que podemos usar son:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
F_{J,n-K} &amp;= \frac{R^2_{NR} - R^2_{R}}{J} \Big/ \frac{(1 - R^2_{NR})}{n-k} \\
&amp;= \frac{SSE_{R} - SSE_{NR}}{J} \Big/ \frac{SSE_{NR}}{n-k} \\
&amp;= \frac{e'_{R}e_{R} - e'_{NR}e_{NR}}{J} \Big/ \frac{e'_{NR}e_{NR}}{n-k} \\
\end{align*}\]</div>
<p>Todas estas son fórmulas equivalentes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelo No Restringido</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Y ~ x2 + x3)

Residuals:
      1       2       3       4       5       6 
-0.2258  0.0804  1.0030 -0.3415  0.3222 -0.8383 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  11.7419     0.9768  12.021  0.00124 **
x2           -0.8390     0.1129  -7.428  0.00505 **
x3           -0.3998     1.1494  -0.348  0.75093   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.8138 on 3 degrees of freedom
Multiple R-squared:  0.9521,	Adjusted R-squared:  0.9202 
F-statistic: 29.83 on 2 and 3 DF,  p-value: 0.01047
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelo Restringido</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">Y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Y ~ x2)

Residuals:
       1        2        3        4        5        6 
-0.18541 -0.03343  0.90274 -0.24924  0.51064 -0.94529 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 11.57751    0.75506  15.333 0.000106 ***
x2          -0.84802    0.09707  -8.736 0.000946 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.7188 on 4 degrees of freedom
Multiple R-squared:  0.9502,	Adjusted R-squared:  0.9377 
F-statistic: 76.31 on 1 and 4 DF,  p-value: 0.0009461
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h2>Ejemplo<a class="headerlink" href="#id3" title="Link to this heading">#</a></h2>
<p>Calculemos el estadístico F asociado a la prueba <span class="math notranslate nohighlight">\(H_0: \beta_2 = 0\)</span></p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
F_{J,n-K} &amp;= \frac{R^2_{NR} - R^2_{R}}{J} \Big/ \frac{(1 - R^2_{NR})}{n-k} \\
&amp;= \frac{0.9521 - 0.9502}{1} \Big/ \frac{(1 - 0.9521)}{3} \approx 0.12
\end{align*}\]</div>
<p>Tambien lo podemos calcular de la siguiente manera:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
F_{J,n-K} &amp;= \frac{SSE_{R} - SSE_{NR}}{J} \Big/ \frac{SSE_{NR}}{n-k} \\ \\
&amp;= \frac{2.067 - 1.987}{1} \Big/ \frac{(1.987)}{3} \approx 0.12
\end{align*}\]</div>
<p>Observe que:</p>
<div class="math notranslate nohighlight">
\[SSE_{NR} = MSE_{NR}*(n-k) = 0.8138^2 * (6-3) = 1.987\]</div>
<div class="math notranslate nohighlight">
\[SSE_{R} = MSE_{R}*(n-k) = 0.7188^2 * (6-2) = 2.067\]</div>
</section>
<section id="seleccion-de-variables">
<h2>Selección de Variables<a class="headerlink" href="#seleccion-de-variables" title="Link to this heading">#</a></h2>
<p>Este método es útil para saber qué variables deben entrar y cuáles no en un modelo.</p>
<ol class="arabic simple">
<li><p>Corremos el modelo completo.</p></li>
<li><p>Identificamos las variables que no son significativas o que tienen coeficientes raros.</p></li>
<li><p>Excluimos esas variables, y corremos el modelo sin ellas.</p></li>
<li><p>Hacemos una prueba F tal que:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
H_0 : \beta_{exc} = 0
\]</div>
<p><span class="math notranslate nohighlight">\(\hspace{15pt}\)</span> donde <span class="math notranslate nohighlight">\(\beta_{exc}\)</span> son los betas excluidos.</p>
<ol class="arabic simple" start="5">
<li><p>Si se rechaza <span class="math notranslate nohighlight">\(H_0\)</span>, entonces ese grupo de variables se debe dejar.</p></li>
<li><p>De lo contrario, las podemos sacar del modelo.</p></li>
</ol>
</section>
<section id="variables-binarias-y-categoricas">
<h2>Variables Binarias y Categoricas<a class="headerlink" href="#variables-binarias-y-categoricas" title="Link to this heading">#</a></h2>
<p>Hay muchas variables que no podemos incluir linealmente a un modelo porque son cualitativas. Sin embargo, podemos incluir variables categóricas.</p>
<p>Ejemplos: género, recibe subsidio o no, máximo nivel educativo, etc.</p>
<p>Para ello creamos variables binarias (tambien conocidas como variables <em>dummy</em>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
D_i = 1(\text{Genero}_i = \text{mujer}) = 
\begin{cases} 
1 &amp; \text{si mujer} \\ 
0 &amp; \text{si hombre} 
\end{cases}
\end{split}\]</div>
<p>En nuestra matrix <span class="math notranslate nohighlight">\(X\)</span> estas variables se representan a traves de vectores de 1 y 0. Por ejemplo:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
X =
\begin{bmatrix}
1 &amp; 0 &amp; 4 \\
1 &amp; 1 &amp; 5.6 \\
1 &amp; 0 &amp; 8.9 \\
1 &amp; 1 &amp; 3.2 \\
\end{bmatrix}
\end{split}\]</div>
<p>Las variables categóricas son fáciles de incluir en un modelo.</p>
<p>Para interpretar estas variables debemos considerar la <strong>categoría excluida</strong>.</p>
<ul class="simple">
<li><p>Si hay <span class="math notranslate nohighlight">\(m\)</span> categorías, entonces podemos incluir solo <span class="math notranslate nohighlight">\(m - 1\)</span> variables binarias.</p></li>
<li><p>De lo contrario, habría <strong>colinealidad perfecta</strong> (con el vector de 1s asociado al intercepto del modelo) y el modelo no se podría estimar.</p></li>
</ul>
</section>
<section id="aplicacion">
<h2>Aplicación<a class="headerlink" href="#aplicacion" title="Link to this heading">#</a></h2>
<p>Consideremos la siguiente extensión del modelo minceriano:</p>
<div class="math notranslate nohighlight">
\[\log(w_i) = \beta_0 + \beta_1 s_i + \beta_2 x_i + \beta_3 x_i^2 + \beta_4 f_i + \sum_{j=2}^4 \mu_j 1(\text{Occup}_i = j) + \varepsilon_i\]</div>
<p>Donde <span class="math notranslate nohighlight">\(\text{Occup}_i\)</span> es la ocupacion del individuo <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>Observe que la sumatoria no inicia en la categoria 1 porque debemos fijar una <strong>grupo de comparación</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">wage1</span><span class="o">$</span><span class="n">occup</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">wage1</span><span class="o">$</span><span class="n">occup</span><span class="p">[</span><span class="n">wage1</span><span class="o">$</span><span class="n">profocc</span><span class="o">==</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="n">wage1</span><span class="o">$</span><span class="n">occup</span><span class="p">[</span><span class="n">wage1</span><span class="o">$</span><span class="n">clerocc</span><span class="o">==</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="n">wage1</span><span class="o">$</span><span class="n">occup</span><span class="p">[</span><span class="n">wage1</span><span class="o">$</span><span class="n">servocc</span><span class="o">==</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">4</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">educ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expersq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">I</span><span class="p">(</span><span class="n">occup</span><span class="o">==</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">I</span><span class="p">(</span><span class="n">occup</span><span class="o">==</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">I</span><span class="p">(</span><span class="n">occup</span><span class="o">==</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">I</span><span class="p">(</span><span class="n">occup</span><span class="o">==</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(wage) ~ educ + exper + expersq + female + I(occup == 
    2) + I(occup == 3) + I(occup == 4) + I(occup == 1), data = wage1)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.17295 -0.25694 -0.01026  0.24168  1.16078 

Coefficients: (1 not defined because of singularities)
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        0.5734513  0.1150516   4.984 8.54e-07 ***
educ               0.0675872  0.0086602   7.804 3.42e-14 ***
exper              0.0338830  0.0047376   7.152 2.99e-12 ***
expersq           -0.0006099  0.0001056  -5.775 1.34e-08 ***
female            -0.3063134  0.0386295  -7.930 1.40e-14 ***
I(occup == 2)TRUE  0.1975666  0.0491984   4.016 6.82e-05 ***
I(occup == 3)TRUE  0.0465311  0.0574950   0.809    0.419    
I(occup == 4)TRUE -0.1473799  0.0584312  -2.522    0.012 *  
I(occup == 1)TRUE         NA         NA      NA       NA    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.394 on 509 degrees of freedom
Multiple R-squared:  0.4411,	Adjusted R-squared:  0.4335 
F-statistic:  57.4 on 7 and 509 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">educ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expersq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">factor</span><span class="p">(</span><span class="n">occup</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(wage) ~ educ + exper + expersq + female + factor(occup), 
    data = wage1)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.17295 -0.25694 -0.01026  0.24168  1.16078 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     0.5734513  0.1150516   4.984 8.54e-07 ***
educ            0.0675872  0.0086602   7.804 3.42e-14 ***
exper           0.0338830  0.0047376   7.152 2.99e-12 ***
expersq        -0.0006099  0.0001056  -5.775 1.34e-08 ***
female         -0.3063134  0.0386295  -7.930 1.40e-14 ***
factor(occup)2  0.1975666  0.0491984   4.016 6.82e-05 ***
factor(occup)3  0.0465311  0.0574950   0.809    0.419    
factor(occup)4 -0.1473799  0.0584312  -2.522    0.012 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.394 on 509 degrees of freedom
Multiple R-squared:  0.4411,	Adjusted R-squared:  0.4335 
F-statistic:  57.4 on 7 and 509 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="interacciones">
<h2>Interacciones<a class="headerlink" href="#interacciones" title="Link to this heading">#</a></h2>
<p>Las variables binarias son una muy buena herramienta.</p>
<ul class="simple">
<li><p>Una aplicación muy útil son las <strong>interacciones</strong>.</p></li>
<li><p>Una interacción es simplemente el <strong>producto de una variable</strong> (categórica o no) con una variable categórica.</p></li>
<li><p>Las interacciones permiten medir <strong>cambios en pendiente</strong> y diferenciar grupos por varias características.</p></li>
</ul>
<p>Considere el siguiente modelo:</p>
<div class="math notranslate nohighlight">
\[\log(w_i) = \beta_0 + \beta_1 f_i + \beta_2 c_i + \beta_3 s_i + \varepsilon_i\]</div>
<p>Donde</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(w_i\)</span> es el salario del individuo <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(s_i\)</span> los años de educación</p></li>
<li><p><span class="math notranslate nohighlight">\(f_i\)</span> toma el valor de 1 si es mujer, y <span class="math notranslate nohighlight">\(c_i\)</span> toma el valor de 1 si está casado (o casada).</p></li>
</ul>
</section>
<section id="interaccion-entre-variables-binarias">
<h2>Interacción entre Variables Binarias<a class="headerlink" href="#interaccion-entre-variables-binarias" title="Link to this heading">#</a></h2>
<p>La interacción entre <span class="math notranslate nohighlight">\(f_i\)</span> y <span class="math notranslate nohighlight">\(c_i\)</span> nos permitirá diferenciar las <strong>mujeres casadas</strong>.</p>
<div class="math notranslate nohighlight">
\[\log(w_i) = \beta_0 + \beta_1 f_i + \beta_2 c_i + \beta_3 s_i + \delta (f_i \times c_i) + \varepsilon_i\]</div>
<p>Observe que:</p>
<div class="math notranslate nohighlight">
\[\Delta_{f_i=0}(c_i)  = E[\log(w_i) \mid f_i = 0, c_i = 1] - E[\log(w_i) \mid f_i = 0, c_i = 0] = \beta_2\]</div>
<div class="math notranslate nohighlight">
\[\Delta_{f_i=1}(c_i) = E[\log(w_i) \mid f_i = 1, c_i = 1] - E[\log(w_i) \mid f_i = 1, c_i = 0] = \beta_2 + \delta\]</div>
<p>Entonces,</p>
<div class="math notranslate nohighlight">
\[\delta = \Delta_{f_i=1}(c_i) - \Delta_{f_i=0}(c_i)\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span>: cambio en el salario para hombres casados (vs hombres solteros)</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span> + <span class="math notranslate nohighlight">\(\delta\)</span>: cambio en el salario para mujeres casadas (vs mujeres solteras)</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta\)</span>: cambio diferencial en el salario para mujeres casadas (vs al cambio para hombres casados)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">female</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">married</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">educ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="o">*</span><span class="n">married</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(wage) ~ female + married + educ + female * married, 
    data = wage1)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.03967 -0.28527 -0.04102  0.24971  1.22614 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     0.494205   0.103971   4.753 2.60e-06 ***
female         -0.088502   0.059281  -1.493    0.136    
married         0.401559   0.054683   7.343 8.25e-13 ***
educ            0.081515   0.007399  11.018  &lt; 2e-16 ***
female:married -0.388100   0.076030  -5.105 4.68e-07 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4162 on 512 degrees of freedom
Multiple R-squared:  0.3728,	Adjusted R-squared:  0.3679 
F-statistic: 76.09 on 4 and 512 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="interaccion-entre-una-variable-binaria-y-una-continua">
<h2>Interacción entre una Variable Binaria y una Continua<a class="headerlink" href="#interaccion-entre-una-variable-binaria-y-una-continua" title="Link to this heading">#</a></h2>
<p>Considere ahora la interacción entre una variable categórica y una variable continua.</p>
<p>Esto identifica <strong>cambios en pendientes</strong> o efectos diferenciados.</p>
<div class="math notranslate nohighlight">
\[\log(w_i) = \beta_0 + \beta_1 f_i + \beta_2 s_i + \beta_3 (f_i \times s_i) + \varepsilon_i\]</div>
<p>Podemos calcular la derivada:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial \log(w_i)}{\partial s_i} = \beta_2 + \beta_3 f_i
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_2\)</span>: efecto de la educación en el salario de los <strong>hombres</strong>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta_2 + \beta_3\)</span>: efecto de la educación en el salario promedio de las <strong>mujeres</strong>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">female</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">educ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="o">*</span><span class="n">educ</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log(wage) ~ female + educ + female * educ, data = wage1)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.11013 -0.28558 -0.03855  0.25787  1.35097 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.796631   0.129084   6.171 1.38e-09 ***
female      -0.542574   0.206464  -2.628  0.00885 ** 
educ         0.079374   0.009744   8.146 2.88e-15 ***
female:educ  0.014891   0.016048   0.928  0.35392    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4368 on 513 degrees of freedom
Multiple R-squared:  0.3079,	Adjusted R-squared:  0.3038 
F-statistic: 76.07 on 3 and 513 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
</section>
<section id="teorema-de-gauss-markov">
<h2>Teorema de Gauss-Markov<a class="headerlink" href="#teorema-de-gauss-markov" title="Link to this heading">#</a></h2>
<div class="alert alert-block alert-info">
<b>TEOREMA:</b>
<p>
<p>El estimador de Mínimos Cuadrados Ordinarios <span class="math notranslate nohighlight">\(\hat{\beta} = (X'X)^{-1}X'Y\)</span> es el <strong>mejor estimador lineal insesgado (MELI)</strong>.</p>
</div>
<ul class="simple">
<li><p>Esto significa que es el estimador lineal más <strong>eficiente</strong> o con menor varianza</p></li>
<li><p>Esto ocurre <strong>si y solo si</strong> se cumplen los supuestos del modelo lineal</p></li>
</ul>
</section>
<section id="demostacion-del-teorema-de-gauss-markov">
<h2>Demostación del Teorema de Gauss-Markov<a class="headerlink" href="#demostacion-del-teorema-de-gauss-markov" title="Link to this heading">#</a></h2>
<p>Considere un estimador lineal insesgado <span class="math notranslate nohighlight">\(b\)</span>, tal que:</p>
<div class="math notranslate nohighlight">
\[b = CY \quad \text{y} \quad C \neq (X'X)^{-1}X'\]</div>
<p>De forma genérica podemos definir:</p>
<div class="math notranslate nohighlight">
\[
C = (D + A) \quad \text{tal que} \quad A = (X'X)^{-1}X'
\]</div>
<p>Entonces:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
b &amp;= CY = DY + AY \\
&amp;= D(X\beta + \varepsilon) + \hat{\beta}
\end{align*}\]</div>
<p>Como <span class="math notranslate nohighlight">\(b\)</span> es insesgado:</p>
<div class="math notranslate nohighlight">
\[
E[b|X] = \beta
\]</div>
<div class="math notranslate nohighlight">
\[
E[b|X] = DX\beta + D \cdot E[\varepsilon|X] + E[\hat{\beta}|X]
\]</div>
<p>Entonces debe cumplirse que:</p>
<div class="math notranslate nohighlight">
\[
DX = 0
\]</div>
</section>
<section id="demostracion-del-teorema-de-gauss-markov">
<h2>Demostración del Teorema de Gauss-Markov<a class="headerlink" href="#demostracion-del-teorema-de-gauss-markov" title="Link to this heading">#</a></h2>
<p>Podemos entonces escribir lo siguiente:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
b &amp;= DX\beta + D\varepsilon + \hat{\beta} \\
&amp;= D\varepsilon + \beta + A\varepsilon \\
&amp;= \beta + (D + A)\varepsilon
\end{align*}\]</div>
<p>Ahora saquemos la varianza de este estimador:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
Var(b) = (D + A)Var(\varepsilon)(D + A)' \\
&amp;= \sigma^2 (D + A)(D + A)' \\
&amp;= \sigma^2[DD' + DA' + AD' + AA'] \\
&amp;= \sigma^2DD' + \sigma^2(X'X)^{-1}\\
\end{align*}\]</div>
<p>Noten que <span class="math notranslate nohighlight">\(DD'\)</span> es un valor positivo.</p>
<p>Por lo tanto:</p>
<div class="math notranslate nohighlight">
\[
Var(b) \geq Var(\hat{\beta}) = \sigma^2 (X'X)^{-1}
\]</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3_Regresion.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Modelo de Regresión Lineal</p>
      </div>
    </a>
    <a class="right-next"
       href="5_Supuestos.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Evaluación de Supuestos</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion-retornos-a-la-educacion-experiencia-y-gaps">Aplicación: Retornos a la Educación, Experiencia, y Gaps</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covariables-no-lineales">Covariables No-lineales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covariables-binarias">Covariables Binarias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modelo-de-regresion-en-forma-matricial">Modelo de Regresión en Forma Matricial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supuestos-en-forma-matricial">Supuestos en forma Matricial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-ordinarios">Mínimos Cuadrados Ordinarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Mínimos Cuadrados Ordinarios</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimadores-de-beta">Estimadores de <span class="math notranslate nohighlight">\(\beta\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices-y-sumatorias">Matrices y Sumatorias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo">Ejemplo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices-m-y-p">Matrices <span class="math notranslate nohighlight">\(M\)</span> y <span class="math notranslate nohighlight">\(P\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propiedades-de-p-y-m">Propiedades de <span class="math notranslate nohighlight">\(P\)</span> y <span class="math notranslate nohighlight">\(M\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#propiedades-de-hat-beta">Propiedades de <span class="math notranslate nohighlight">\(\hat\beta\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relacion-entre-hat-beta-y-e-y-hat-y">Relación entre <span class="math notranslate nohighlight">\(\hat\beta\)</span> y <span class="math notranslate nohighlight">\(e = Y - \hat Y\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-varianza-y-covarianza">Matriz de Varianza y Covarianza</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-significancia-individual">Pruebas de Significancia Individual</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ejemplo-continuacion">Ejemplo (Continuación)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bondad-de-ajuste-r-2-y-r-2-ajustado">Bondad de Ajuste: <span class="math notranslate nohighlight">\(R^2\)</span> y <span class="math notranslate nohighlight">\(R^2\)</span>-Ajustado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-signifiancia-global">Prueba de Signifiancia Global</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#otras-pruebas-de-hipotesis">Otras Pruebas de Hipotesis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estadistico-t">Estadístico T</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estadistico-f">Estadístico F</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Ejemplo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#varias-restricciones">Varias Restricciones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-restringidos">Minimos Cuadrados Restringidos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Ejemplo</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#seleccion-de-variables">Selección de Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variables-binarias-y-categoricas">Variables Binarias y Categoricas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aplicacion">Aplicación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interacciones">Interacciones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaccion-entre-variables-binarias">Interacción entre Variables Binarias</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interaccion-entre-una-variable-binaria-y-una-continua">Interacción entre una Variable Binaria y una Continua</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#teorema-de-gauss-markov">Teorema de Gauss-Markov</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demostacion-del-teorema-de-gauss-markov">Demostación del Teorema de Gauss-Markov</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demostracion-del-teorema-de-gauss-markov">Demostración del Teorema de Gauss-Markov</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sebastian Montano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>