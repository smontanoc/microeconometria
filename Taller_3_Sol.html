
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Taller 3 &#8212; Microeconometria Aplicada</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Taller_3_Sol';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Taller 2" href="Taller_2_Sol.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Microeconometria Aplicada - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Microeconometria Aplicada - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Microeconometría Aplicada
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_Motivacion.html">Qué es la Microeconometría?</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_Regresion.html">Modelo de Regresión Lineal</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_Regresion.html">Modelo de Regresión Multiple</a></li>
<li class="toctree-l1"><a class="reference internal" href="5_Supuestos.html">Evaluación de Supuestos</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Respuesta_Cualitativa.html">Variables de Respuesta Cualitativa</a></li>

<li class="toctree-l1"><a class="reference internal" href="7_RepeatedCross.html">Modelo de Cortes Transversales Repetidos</a></li>
<li class="toctree-l1"><a class="reference internal" href="8_DatosPanel.html">Modelos de Datos Panel</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_Probabilidad.html">Fundamentos de Probabilidad</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Estadistica.html">Fundamentos de Estadística</a></li>
<li class="toctree-l1"><a class="reference internal" href="Taller_1_Sol.html">Taller 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Taller_2_Sol.html">Taller 2</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Taller 3</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FTaller_3_Sol.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Taller_3_Sol.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Taller 3</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pregunta-1">Pregunta 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion">Solución</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pregunta-2">Pregunta 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Solución</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pregunta-3">Pregunta 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Solución</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="taller-3">
<h1>Taller 3<a class="headerlink" href="#taller-3" title="Link to this heading">#</a></h1>
<p><strong>Fecha de entrega:</strong> 28 de Septiembre</p>
<p><strong>Instrucciones:</strong> Este taller debe ser entregado de manera individual a través de <a class="reference external" href="https://tecnologia.uniandes.edu.co/bloqueneon/">Bloque Neón</a>. A pesar de que la entrega es individual, se promueve el trabajo en grupos.</p>
<section id="pregunta-1">
<h2>Pregunta 1<a class="headerlink" href="#pregunta-1" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>El siguiente modelo estudia la manera en que los ingresos dependen del género (una variable binaria igual a 1 si <span class="math notranslate nohighlight">\(i\)</span> es hombre) y el origen étnico (una variable binaria igual a 1 si <span class="math notranslate nohighlight">\(i\)</span> es latino).</p></li>
</ol>
<div class="math notranslate nohighlight">
\[ingreso_i = \beta_0 + \beta_1 hombre_i + \beta_2 latino + \beta_3 hombre_i \times latino_i + u_i\]</div>
<ul class="simple">
<li><p>Es <span class="math notranslate nohighlight">\(\beta_0 + \beta_3\)</span> el ingreso esperado para los hombres no-latinos? Explique su respuesta.</p></li>
<li><p>Cómo se interpreta el coeficiente <span class="math notranslate nohighlight">\(\beta_3\)</span>?</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>Suponga que su modelo de interés es:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i} + u_i\]</div>
<p>Es cierto que la regresión a estimar en la prueba de White para heteróscedasticidad está dada por la siguiente expresión?</p>
<div class="math notranslate nohighlight">
\[e^2_i = \alpha_0 + \alpha_1 x_{1i} + \alpha_2 x_{2i} + \alpha_3 x_{3i} + \alpha_4 x^2_{1i} + \alpha_5 x^2_{2i} + \alpha_6 x^2_{3i} + v_i\]</div>
<p>Explique que intuición hay detrás de la regresión anterior en la prueba de White.</p>
<ol class="arabic simple" start="3">
<li><p>Es necesario suponer que <span class="math notranslate nohighlight">\(E(u_i^2 | X) = \sigma^2\)</span> para concluir que los estimadores de MCO son insesgados? Explique</p></li>
<li><p>Podemos interpretar el p-valor cómo la probabilidad de que nuestra hipótesis nula sea verdadera? Explique</p></li>
<li><p>Cuáles de los siguientes son supuestos <em>clásicos</em> en el modelo de regresión? Explique su importancia.</p></li>
</ol>
<div class="math notranslate nohighlight">
\[E(u_i | X) = 0 ; \qquad V(u_i | X) = 0 \hspace{5pt} \forall i ; \qquad Cov(u_i, u_j) = \sigma  \hspace{5pt} \forall i \neq j; \qquad (X'X)^{-1} \neq 0\]</div>
<ol class="arabic simple" start="6">
<li><p>En presencia de heteroscedasticidad, cuáles de los siguientes enunciados son ciertos? Justifique su respuesta</p></li>
</ol>
<ul class="simple">
<li><p>MCO genera coeficientes insesgados.</p></li>
<li><p>Los intervalos de confianza son válidos, pero los errores estandar no lo son.</p></li>
<li><p>MCO es menos eficiente que Mínimos Cuadrados Ponderados.</p></li>
</ul>
<ol class="arabic simple" start="7">
<li><p>Explique por qué si los supuestos <em>clásicos</em> de regresión se cumplen, entonces MCO es el “mejor estimador lineal”</p></li>
</ol>
</section>
<section id="solucion">
<h2>Solución<a class="headerlink" href="#solucion" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Falso. El ingreso esperado de los hombres no-latinos está dado por:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[E(ingreso | hombre = 1, latino = 0) = \beta_0 + \beta_1\]</div>
<p><span class="math notranslate nohighlight">\(\beta_3\)</span> se puede interpretrar como el cambio adicional en el ingreso de los hombres por ser latino (respecto al cambio en el ingreso de las mujeres por ser latinas).</p>
<div class="math notranslate nohighlight">
\[\Delta_{1}(latino) = E(ingreso | hombre = 1, latino = 1) - E(ingreso | hombre = 1, latino = 0) = \beta_2 + \beta_3\]</div>
<div class="math notranslate nohighlight">
\[\Delta_{0}(latino) = E(ingreso | hombre = 0, latino = 1) - E(ingreso | hombre = 0, latino = 0) = \beta_2\]</div>
<ol class="arabic simple" start="2">
<li><p>Falso. La regresión en la prueba de White está dada por:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[e^2_i = \alpha_0 + \alpha_1 x_{1i} + \alpha_2 x_{2i} + \alpha_3 x_{3i} + \alpha_4 x^2_{1i} + \alpha_5 x^2_{2i} + \alpha_6 x^2_{3i} + \color{red}{\alpha_7 x_{1i}x_{2i} + \alpha_8 x_{1i}x_{3i} + \alpha_9 x_{2i}x_{3i}} + v_i\]</div>
<p>Un modelo es heteroscedástico si la varianza de los errores depende de las variables independientes. La intuición detrás de la prueba de White es justamente tratar de relacionar los errores y dichas variables. Usamos un modelo interactuado debido a que desconocemos la verdadera relación entre los errores y las variables independientes; este modelo es suficientemente flexible para capturar relaciones no lineales. Ya que tampoco conocemos los errores debemos usar como estimador los residuales del modelo al cuadrado.</p>
<ol class="arabic simple" start="3">
<li><p>Falso. No es necesario suponer homoscedasticidad (i.e, <span class="math notranslate nohighlight">\(E(u_i^2 | X) = \sigma^2\)</span>) para concluir que los estimadores de MCO son insesgados. Para probar insesgamiento es necesario que se cumpla el supuesto de independencia condicional, es decir, <span class="math notranslate nohighlight">\(E(u_i | X) = 0\)</span>.</p></li>
<li><p>Falso. El p-valor es la probabilidad de obtener un estadístico de prueba igual o más extremo que el observado, cuando la hipótesis nula fuera cierta.</p></li>
<li><p><span class="math notranslate nohighlight">\(E(u_i | X) = 0\)</span> y <span class="math notranslate nohighlight">\((X'X)^{-1} \neq 0\)</span> son supuestos clásicos en el modelo de regresión lineal. <span class="math notranslate nohighlight">\(E(u_i | X) = 0\)</span> se conoce como exogenidad (o independencia condicional) y es necesario para que los estimadores de MCO sean insesgados. <span class="math notranslate nohighlight">\((X'X)^{-1} \neq 0\)</span> se conoce como no-multicolinealidad (y rango completo) y es necesario para que el modelo sea estimable.</p></li>
</ol>
<p>Observe que si <span class="math notranslate nohighlight">\(V(u_i | X) = 0 \hspace{5pt} \forall i\)</span>, entonces <span class="math notranslate nohighlight">\(u_i\)</span> no es una variable aleatoria. Por otro lado, <span class="math notranslate nohighlight">\(Cov(u_i, u_j) = \sigma  \hspace{5pt} \forall i \neq j\)</span> señala que la correlación de los errores de constante. Ninguna de estas condiciones hacen parte de los supuestos clásicos de regresión.</p>
<ol class="arabic simple" start="6">
<li><p>En presencia de heteroscedasticidad:</p></li>
</ol>
<ul class="simple">
<li><p>Verdadero. MCO puede generar estimaciones insesgadas si <span class="math notranslate nohighlight">\(E(u_i | X) = 0\)</span>.</p></li>
<li><p>Falso. Los errores estándar no invalidos y por consiguiente los intervalos de confianza también lo son.</p></li>
<li><p>Verdadero. MCO es menos eficiente que Mínimos Cuadrados Ponderados</p></li>
</ul>
<ol class="arabic simple" start="7">
<li><p>Los supuestos clásicos de regresión lineal permiten que el modelo sea estimable y que los estimadores sean insesgados. Adicionalmente, se puede mostrar que los estimadores son eficientes, es decir, si los supuestos se cumplen entonces los estimadores de MCO son de mínima varianza (Ver demostración del Teorema de Gauss-Markov en las notas de clase). En este sentido, los estimadores de MCO son ‘los mejores estimadores lineales’.</p></li>
</ol>
</section>
<section id="pregunta-2">
<h2>Pregunta 2<a class="headerlink" href="#pregunta-2" title="Link to this heading">#</a></h2>
<p>Suponga que usted está interesado en estudiar la relación entre <code class="docutils literal notranslate"><span class="pre">edad</span></code> y <code class="docutils literal notranslate"><span class="pre">salario</span></code> y para ello tiene la siguiente función:</p>
<div class="math notranslate nohighlight">
\[log(salario) = 2.6 + 0.2 \cdot edad - 0.0035 \cdot edad^2 + u \qquad (1)\]</div>
<p>donde <span class="math notranslate nohighlight">\(edad \sim N(35, 10)\)</span> y <span class="math notranslate nohighlight">\(u \sim N(0, 1)\)</span>.</p>
<p>Ahora suponga que usted desconoce la función y decide estimar el siguiente modelo:</p>
<div class="math notranslate nohighlight">
\[log(salario_i) = \beta_0 + \beta_1 \cdot edad_i + \varepsilon_i  \qquad (2)\]</div>
<ol class="arabic simple">
<li><p>Usando R, simule una base de datos con 1000 observaciones. Para crear sus datos, fije la semilla <code class="docutils literal notranslate"><span class="pre">092025</span></code>, considere las distribuciones de la <code class="docutils literal notranslate"><span class="pre">edad</span></code>, los errores, y la ecuación (1).</p></li>
<li><p>Cree una tabla con estadisticas descriptivas y un diagrama de dispersión que describa la relación de interés.</p></li>
<li><p>Estime su modelo usando el comando <code class="docutils literal notranslate"><span class="pre">lm()</span></code>.</p></li>
<li><p>Interprete los resultados encontrados. No se limite a señalar las magnitudes de sus estimaciones puntales, considere también las diferentes pruebas de significancia y la bondad de ajuste del modelo.</p></li>
<li><p>Explique por qué su modelo no hace un buen trabajo al estimar la función desconocida. Señale qué supuestos <em>clásicos</em> del modelo de regresión viola sus estimaciones. Presente evidencia clara de la violación de supuestos.</p></li>
<li><p>Re-estime su modelo incluyendo <span class="math notranslate nohighlight">\(edad_i^2\)</span> como variable independiente. Interprete el efecto marginal de la edad en el salario.</p></li>
<li><p>Usando estos resultados, realice dos pruebas de hipótesis para evaluar si los errores siguen una distribución normal. Presente un histograma y la densidad estimada de los errores, al igual que los gráficos asociados a las pruebas de normalidad.</p></li>
</ol>
</section>
<section id="id1">
<h2>Solución<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Los resultados de los numerales 1 a 3 se pueden ver abajo.</p>
<ol class="arabic simple" start="4">
<li><p>Los resultados observados indican que un año adicional en la edad reduce el salario en 4.5 por ciento. Este resultado es estadísticamente significativo a un nivel del 0.1 por ciento. Adicionalmente, el modelo es globalmente significativo (p-valor &lt; 0.001) y tiene un poder explicativo del 15 por ciento.</p></li>
<li><p>Observe que existe una relación no-lineal entre edad y salario (ver ecuación (1) y diagrama de dispersión).</p></li>
</ol>
<p>Nuestro modelo establece una relación lineal al omitir la variable <span class="math notranslate nohighlight">\(edad_i^2\)</span>, y por lo tanto tiene un mal desempeño. En otras palabras, las estimaciones presentan sesgo por variable omitida y se viola el supuesto de exogenidad:</p>
<div class="math notranslate nohighlight">
\[E(\varepsilon_i | edad_i) = E(-0.0035 \cdot edad_i^2 + u_i | edad_i) = -0.0035 \cdot edad_i^2 \leq 0\]</div>
<ol class="arabic simple" start="6">
<li><p>El efecto marginal de la edad en el logarítmo del salario está dada por:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\frac{\partial log(salario_i)}{\partial edad_i} = \hat\beta_1 + \hat\beta_2 \cdot (2) \cdot edad_i = 0.162 - 0.003\cdot(2)\cdot edad_i\]</div>
<p>Ya que el efecto marginal depende de la edad, podemos usar la edad promedio: 35 años. De esta manera, pasar de 34 a 35 reduce el salario en 4.4 por ciento. Por otro lado, si un individuo pasa de 24 a 25 años, su salario aumenta en 1.5 por ciento.</p>
<ol class="arabic simple" start="7">
<li><p>Los resultados de las pruebas de normalidad de Shapiro-Wilk y Kolmogorov-Smirnov sugieren que hay evidencia para concluir que los errores se distribuyen normal. De manera más precisa, con p-valores de 0.8559 y 0.6472, no podemos rechazar la hipotesis nula de que los errores se distribuyan normales.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Limpiar espacio de trabajo</span>
<span class="nf">rm</span><span class="p">(</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ls</span><span class="p">())</span>
<span class="c1">#Semilla de replicacion</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">092025</span><span class="p">)</span>

<span class="c1">#Simular datos</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1000</span>
<span class="n">edad</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">35</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">)</span>
<span class="n">edad2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">edad</span><span class="o">^</span><span class="m">2</span>
<span class="n">u</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="n">salario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">exp</span><span class="p">(</span><span class="m">2.6</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0.2</span><span class="o">*</span><span class="n">edad</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">0.0035</span><span class="o">*</span><span class="n">edad2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u</span><span class="p">)</span>
<span class="n">log_salario</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">salario</span><span class="p">)</span>

<span class="c1">#base de datos</span>
<span class="n">datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="n">salario</span><span class="p">,</span><span class="w"> </span><span class="n">log_salario</span><span class="p">,</span><span class="w"> </span><span class="n">edad</span><span class="p">,</span><span class="w"> </span><span class="n">edad2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Estadisticas descriptivas</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">datos</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;salario&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;edad&#39;</span><span class="p">)])</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">edad</span><span class="p">,</span><span class="w"> </span><span class="n">log_salario</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    salario              edad       
 Min.   :   0.172   Min.   : 1.186  
 1st Qu.:  67.329   1st Qu.:28.527  
 Median : 155.567   Median :35.602  
 Mean   : 258.308   Mean   :35.361  
 3rd Qu.: 303.742   3rd Qu.:42.272  
 Max.   :5396.044   Max.   :63.000  
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/0e2585a5ec57f94ee93cb62e9fb6e60a1e870d49bc7bfe6dc880238502fac432.png"><img alt="_images/0e2585a5ec57f94ee93cb62e9fb6e60a1e870d49bc7bfe6dc880238502fac432.png" src="_images/0e2585a5ec57f94ee93cb62e9fb6e60a1e870d49bc7bfe6dc880238502fac432.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelo</span>
<span class="n">modelo1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">log_salario</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">edad</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">modelo1</span><span class="p">)</span>

<span class="c1">#Modelo con edad2</span>
<span class="n">modelo2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">log_salario</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">edad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">edad2</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">modelo2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log_salario ~ edad)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.5124 -0.7233  0.0507  0.7293  3.6269 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  6.535526   0.123050   53.11   &lt;2e-16 ***
edad        -0.044949   0.003344  -13.44   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 1.077 on 998 degrees of freedom
Multiple R-squared:  0.1533,	Adjusted R-squared:  0.1525 
F-statistic: 180.7 on 1 and 998 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = log_salario ~ edad + edad2)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.6975 -0.6663  0.0050  0.6725  3.3208 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.2067794  0.2678850   11.97   &lt;2e-16 ***
edad         0.1620947  0.0154176   10.51   &lt;2e-16 ***
edad2       -0.0029483  0.0002151  -13.70   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.9888 on 997 degrees of freedom
Multiple R-squared:  0.2875,	Adjusted R-squared:  0.2861 
F-statistic: 201.2 on 2 and 997 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Normalidad de los errores</span>
<span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">modelo2</span><span class="o">$</span><span class="n">residuals</span>

<span class="c1">#Histogramas y Densidad Acumulada</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Residuals&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">probability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="c1">#Histograma de esiduales</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">density</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="bp">T</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># Densidad estimada de los residuales</span>
<span class="nf">curve</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="bp">T</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="bp">T</span><span class="p">)),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">#Distribucion normal</span>

<span class="nf">qqnorm</span><span class="p">(</span><span class="nf">rstandard</span><span class="p">(</span><span class="n">modelo2</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="c1">##Q-Q plot</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>

<span class="c1">#Pruebas de normalidad</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="nf">ks.test</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pnorm&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Shapiro-Wilk normality test

data:  e
W = 0.99897, p-value = 0.8559
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Asymptotic one-sample Kolmogorov-Smirnov test

data:  e
D = 0.023341, p-value = 0.6472
alternative hypothesis: two-sided
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/2453edf85f7815cbb97388d95b9b7471e60c27e5c6f1fb59e637f61a070c87b5.png"><img alt="_images/2453edf85f7815cbb97388d95b9b7471e60c27e5c6f1fb59e637f61a070c87b5.png" src="_images/2453edf85f7815cbb97388d95b9b7471e60c27e5c6f1fb59e637f61a070c87b5.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
</section>
<section id="pregunta-3">
<h2>Pregunta 3<a class="headerlink" href="#pregunta-3" title="Link to this heading">#</a></h2>
<p>La base de datos <code class="docutils literal notranslate"><span class="pre">Saber11_Colegios.dta</span></code> (<a class="reference external" href="https://github.com/smontanoc/microeconometria/blob/main/Datos/Saber11_Colegios.dta">Descargar</a>) contiene la siguiente información para el año 2015:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">codigo_dane</span></code>: Colegio ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">edad</span></code>: Edad promedio de los estudiantes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mujer</span></code>: % Estudiantes que son mujeres</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">estrato</span></code>: Estrato promedio de los estudiantes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trabaja</span></code>: % Estudiantes que trabajan</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">meduc_preg</span></code>: % Madres con pregrado</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">meduc_sec</span></code>: % Madres con secundaria</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">meduc_prim</span></code>: % Madres con primaria</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">promedio</span></code>: Promedio de los estudiante en el examen Saber 11</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc_mujer</span></code>: % Docentes que son mujeres</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc_exper</span></code>: Experiencia promedio de los docentes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc_normal</span></code>: % Docentes que son normalistas</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc_preg</span></code>: % Docentes que tienen título de pregrado</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc_posg</span></code>: % Docentes que tienen título de posgrado</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">doc_examen</span></code>: Puntaje en el examen de ingreso a la carrera docente</p></li>
</ul>
<p>Usted está interesado en estudiar la relación entre el puntaje que obtienen los maestros de colegios públicos durante su proceso de contratación (<code class="docutils literal notranslate"><span class="pre">doc_examen</span></code>) y el puntaje que obtienen los estudiantes que toman el examen Saber 11 (<code class="docutils literal notranslate"><span class="pre">promedio</span></code>). Su intuición es que maestros más preparados son más efectivos en transmitir sus conocimientos.</p>
<p>Para ello usted estima el siguiente modelo:</p>
<div class="math notranslate nohighlight">
\[\text{promedio}_s = \alpha + \beta \hspace{2pt} \text{doc_examen}_s + X_s'\gamma + W_s'\delta + \varepsilon_s\]</div>
<p>donde <span class="math notranslate nohighlight">\(X_s\)</span> son variables de control relacionadas con los estudiantes que toman el examen Saber 11 y <span class="math notranslate nohighlight">\(W_s\)</span> son variables de control relacionadas con los docentes que trabajan en cada colegio <span class="math notranslate nohighlight">\(s\)</span>.</p>
<ol class="arabic simple">
<li><p>Cree una tabla con estadísticas descriptivas de la base de datos. Presente un diagrama de dispersión de la relación de interés.</p></li>
<li><p>Estime el modelo anterior suponiendo que <span class="math notranslate nohighlight">\(\gamma = 0\)</span> y <span class="math notranslate nohighlight">\(\delta = 0\)</span>.</p></li>
<li><p>Estime el modelo suponiendo ahora que solo <span class="math notranslate nohighlight">\(\delta = 0\)</span>. Realice una prueba de hipótesis para determinar si usted debe controlar por <span class="math notranslate nohighlight">\(X_s\)</span>.</p></li>
<li><p>Estime el modelo completo. Realice una prueba de hipótesis para determinar si usted debe controlar por <span class="math notranslate nohighlight">\(W_s\)</span>.</p></li>
<li><p>Realice pruebas de hipótesis para determinar si los errores del modelo se distribuyen normal. Presente un histograma y la densidad estimada de los errores, al igual que los gráficos asociados a las pruebas de normalidad.</p></li>
<li><p>En una tabla presente las estimaciones de los numerales 2 al 4. Interprete sus resultados.</p></li>
<li><p>Explique por qué el coeficiente <span class="math notranslate nohighlight">\(\beta\)</span> decrece cuando usted controla primero por <span class="math notranslate nohighlight">\(X_s\)</span> y luego por <span class="math notranslate nohighlight">\(W_s\)</span>. En su explicación haga uso del concepto de sesgo por variable omitida. Cree usted que el supuesto de exogeneidad, <span class="math notranslate nohighlight">\(E(\varepsilon_i | \text{doc_examen}_s, X_s, W_s) = 0\)</span>, se cumple en este caso? Justifique su respuesta</p></li>
<li><p>Determine si existe evidencia para concluir que este modelo es heteroscedástico, para ello considere las pruebas de Goldfeld-Quandt, Breusch-Pagan, y White. A la luz de estos resultados, son válidas las pruebas de significancia del numeral 4?</p></li>
<li><p>Re-estime su modelo corrigiendo por heteroscedasticidad con el método de White. Qué diferencias observa usted entre los resultados del numeral 4 y estas nuevas estimaciones? Son éstas diferencias esperables?</p></li>
</ol>
</section>
<section id="id2">
<h2>Solución<a class="headerlink" href="#id2" title="Link to this heading">#</a></h2>
<ol class="arabic simple" start="3">
<li><p>Con p-valor &lt; 0.001 (<span class="math notranslate nohighlight">\(F_{stat} = 639.97\)</span>), podemos concluir que se debe incluir las variables de control <span class="math notranslate nohighlight">\(X_s\)</span> en la regresión.</p></li>
<li><p>Con p-valor &lt; 0.001 (<span class="math notranslate nohighlight">\(F_{stat} = 99.4\)</span>), podemos concluir que se debe incluir las variables de control <span class="math notranslate nohighlight">\(W_s\)</span>.</p></li>
<li><p>Los resultados de las pruebas de normalidad de Shapiro-Wilk y Kolmogorov-Smirnov sugieren que no hay evidencia para concluir que los errores se distribuyen normal. De manera más precisa, con p-valores &lt; 0.001 y 0.003, rechazamos la hipotesis nula de que los errores se distribuyan normales.</p></li>
<li><p>La columna 1 sugiere que un incremento de una unidad en las pruebas de ingreso a la carrera docente, incrementa en 0.46 puntos las pruebas del Saber 11 de los estudiantes. Esta relación es estadísticamente significativa al 0.1 por ciento.</p></li>
</ol>
<p>Luego de controlar por características de los estudiantes y características de los docentes, un incremento de una unidad en las pruebas de ingreso a la carrera docente, incrementa en 0.11 puntos las pruebas del Saber 11 de los estudiantes.</p>
<ol class="arabic simple" start="7">
<li><p>Es muy probable que el supuesto de exogenidad no se cumpla en esta aplicación, es decir,  <span class="math notranslate nohighlight">\(E(\varepsilon_i | \text{doc_examen}_s, X_s, W_s) \neq 0\)</span>. Específicamente, el puntaje en el examen de ingreso a la carrera docente puede estar relacionado con características de los estudiantes y también con características de los mismos docentes. La principal razón es que <strong>los docentes eligen el colegio donde quieren trabajar</strong> y, por lo tanto, pueden escoger colegios donde los estudiantes obtienen mejores puntajes en el Saber 11. En otras palabras, el puntaje de los docentes es endogeno (al puntaje en pruebas).</p></li>
</ol>
<p>No incluir las variables <span class="math notranslate nohighlight">\(X_s\)</span> y <span class="math notranslate nohighlight">\(W_s\)</span> en la regresión puede causar sesgos de selección. Parece existir una correlación positiva entre el puntaje en el examen de ingreso (variable incluida) y las características de los estudiantes y docentes (variables omitidas), lo que genera un sesgo positivo en las estimaciones (del modelo 1).</p>
<ol class="arabic simple" start="8">
<li><p>Las diferentes prueas de heteroscedasticidad sugieren que el modelo no es homoscedastico, es decir, en las tres pruebas (G-Q, B-P, White) rechazamos la hipotesis nula de homoscedasticidad. Por lo tanto, los errores estándar y la inferencia de nuestras estimaciones iniciales no son válidas.</p></li>
<li><p>Los resultados de reestimar el modelo corrigiendo por errores estándar robustos son como esperamos. Es decir, la magnitud de los coeficientes no cambia y los errores estándar son más conservadores (más grandes).</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Limpiar espacio de trabajo</span>
<span class="nf">rm</span><span class="p">(</span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">ls</span><span class="p">())</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&#39;haven&#39;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&#39;haven&#39;</span><span class="p">)</span>

<span class="c1">#Cargar datos</span>
<span class="n">link_datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;https://www.dropbox.com/scl/fi/83tubficanfbebflaekwi/Saber11_Colegios.dta?rlkey=o6p9e75c2zuqpt86ivjvezwzs&amp;dl=1&#39;</span>
<span class="n">datos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read_dta</span><span class="p">(</span><span class="n">link_datos</span><span class="p">)</span>
<span class="nf">attach</span><span class="p">(</span><span class="n">datos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing package into &#39;C:/Users/smontano/AppData/Local/R/win-library/4.3&#39;
(as &#39;lib&#39; is unspecified)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  There is a binary version available but the source version is later:
      binary source needs_compilation
haven  2.5.4  2.5.5              TRUE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>installing the source package &#39;haven&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in install.packages(&quot;haven&quot;):
&quot;installation of package &#39;haven&#39; had non-zero exit status&quot;
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="ow">in</span> <span class="n">library</span><span class="p">(</span><span class="s2">&quot;haven&quot;</span><span class="p">):</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">package</span> <span class="n">called</span> <span class="s1">&#39;haven&#39;</span>
<span class="ne">Traceback</span>:

<span class="mi">1</span><span class="o">.</span> <span class="n">stop</span><span class="p">(</span><span class="n">packageNotFoundError</span><span class="p">(</span><span class="n">package</span><span class="p">,</span> <span class="n">lib</span><span class="o">.</span><span class="n">loc</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">call</span><span class="p">()))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Estadisticas descriptivas</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">datos</span><span class="p">[,</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;mujer&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;edad&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;promedio&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;doc_mujer&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;doc_exper&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;doc_examen&#39;</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     mujer             edad          promedio       doc_mujer      
 Min.   :0.0000   Min.   :16.44   Min.   :36.18   Min.   :0.04348  
 1st Qu.:0.4728   1st Qu.:17.38   1st Qu.:44.95   1st Qu.:0.57576  
 Median :0.5455   Median :17.67   Median :47.61   Median :0.65540  
 Mean   :0.5460   Mean   :18.09   Mean   :47.69   Mean   :0.64064  
 3rd Qu.:0.6154   3rd Qu.:18.23   3rd Qu.:50.32   3rd Qu.:0.72222  
 Max.   :1.0000   Max.   :35.83   Max.   :60.05   Max.   :1.00000  
   doc_exper       doc_examen   
 Min.   : 0.00   Min.   :45.18  
 1st Qu.:10.19   1st Qu.:58.43  
 Median :14.15   Median :60.61  
 Mean   :14.24   Mean   :60.31  
 3rd Qu.:18.04   3rd Qu.:62.49  
 Max.   :30.43   Max.   :72.00  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Diagrama de dispersión de la relación de interés</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">promedio</span><span class="p">,</span><span class="w"> </span><span class="n">doc_examen</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Saber 11 Promedio del Colegio&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#39;Puntaje Promedio de Docentes en Concurso&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/76839e5615c94956c2b12c41a3fadc1597f6280580e05cc61aa9e80aedcde1fd.png"><img alt="_images/76839e5615c94956c2b12c41a3fadc1597f6280580e05cc61aa9e80aedcde1fd.png" src="_images/76839e5615c94956c2b12c41a3fadc1597f6280580e05cc61aa9e80aedcde1fd.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelo sin controles</span>
<span class="n">modelo1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">promedio</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">doc_examen</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">modelo1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = promedio ~ doc_examen, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-13.2199  -2.4400  -0.0656   2.4131  12.4911 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 19.92760    0.94136   21.17   &lt;2e-16 ***
doc_examen   0.46040    0.01559   29.54   &lt;2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 3.713 on 5796 degrees of freedom
Multiple R-squared:  0.1308,	Adjusted R-squared:  0.1307 
F-statistic: 872.4 on 1 and 5796 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelo controlando por características de los estudiantes</span>
<span class="n">modelo2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">promedio</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">doc_examen</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">              </span><span class="n">mujer</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">edad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">estrato</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">trabaja</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">meduc_prim</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">meduc_sec</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">meduc_preg</span><span class="p">,</span><span class="w"> </span>
<span class="w">              </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">modelo2</span><span class="p">)</span>

<span class="c1">#Prueba F</span>
<span class="n">SST</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">datos</span><span class="o">$</span><span class="n">promedio</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">promedio</span><span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>

<span class="n">SSE_NR</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">modelo2</span><span class="o">$</span><span class="n">residuals</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">  </span>
<span class="n">R2_NR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SSE_NR</span><span class="o">/</span><span class="n">SST</span><span class="p">;</span><span class="w"> </span><span class="n">R2_NR</span>

<span class="n">SSE_R</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">modelo1</span><span class="o">$</span><span class="n">residuals</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="n">R2_R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SSE_R</span><span class="o">/</span><span class="n">SST</span><span class="p">;</span><span class="w"> </span><span class="n">R2_R</span>

<span class="c1">#Estadistico de Prueba</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">promedio</span><span class="p">)</span>
<span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">modelo2</span><span class="o">$</span><span class="n">coefficients</span><span class="p">)</span>
<span class="n">J</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">7</span>
<span class="n">F_stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">R2_NR</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">R2_R</span><span class="p">)</span><span class="o">/</span><span class="n">J</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="m">1</span><span class="o">-</span><span class="n">R2_NR</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k</span><span class="p">));</span><span class="w"> </span><span class="n">F_stat</span>
<span class="n">F_critico</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">qf</span><span class="p">(</span><span class="m">1-0.05</span><span class="p">,</span><span class="w"> </span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"> </span><span class="n">F_critico</span>

<span class="c1">#Conclusion?</span>
<span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">F_stat</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">F_critico</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="s">&#39;Rechace H0 (con alpha = 5%)&#39;</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="s">&#39;No rechace H0 (con alpha = 5%)&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">#P-valor </span>
<span class="nf">pf</span><span class="p">(</span><span class="n">F_stat</span><span class="p">,</span><span class="w"> </span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = promedio ~ doc_examen + mujer + edad + estrato + 
    trabaja + meduc_prim + meduc_sec + meduc_preg, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.5601  -1.8893  -0.0566   1.7276  13.4679 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 44.06053    1.04108  42.322  &lt; 2e-16 ***
doc_examen   0.16731    0.01300  12.874  &lt; 2e-16 ***
mujer        1.44477    0.27058   5.340 9.67e-08 ***
edad        -0.84449    0.03059 -27.611  &lt; 2e-16 ***
estrato      3.17522    0.09838  32.275  &lt; 2e-16 ***
trabaja      2.10488    0.34299   6.137 8.97e-10 ***
meduc_prim   2.25168    0.45915   4.904 9.65e-07 ***
meduc_sec    2.96435    0.44897   6.603 4.40e-11 ***
meduc_preg  11.67233    0.59693  19.554  &lt; 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.789 on 5789 degrees of freedom
Multiple R-squared:   0.51,	Adjusted R-squared:  0.5093 
F-statistic: 753.2 on 8 and 5789 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
<div class="output text_html">0.510006723559911</div><div class="output text_html">0.13082742679409</div><div class="output text_html">639.970574093532</div><div class="output text_html">2.01116580676607</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Rechace H0 (con alpha = 5%)&quot;
</pre></div>
</div>
<div class="output text_html">1</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelo controlando por caracteristicas de estudiantes y caracteristicas de docentes </span>
<span class="n">modelo3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">promedio</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">doc_examen</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">              </span><span class="n">mujer</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">edad</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">estrato</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">trabaja</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">meduc_prim</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">meduc_sec</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">meduc_preg</span><span class="w"> </span><span class="o">+</span>
<span class="w">               </span><span class="n">doc_mujer</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">doc_exper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">doc_normal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">doc_preg</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">doc_posg</span><span class="p">,</span><span class="w"> </span>
<span class="w">              </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">datos</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">modelo3</span><span class="p">)</span>

<span class="c1">#Prueba F</span>
<span class="n">SSE_NR</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">modelo3</span><span class="o">$</span><span class="n">residuals</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w">  </span>
<span class="n">R2_NR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SSE_NR</span><span class="o">/</span><span class="n">SST</span><span class="p">;</span><span class="w"> </span><span class="n">R2_NR</span>

<span class="n">SSE_R</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">modelo2</span><span class="o">$</span><span class="n">residuals</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="n">R2_R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">SSE_R</span><span class="o">/</span><span class="n">SST</span><span class="p">;</span><span class="w"> </span><span class="n">R2_R</span>

<span class="c1">#Estadistico de Prueba</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">datos</span><span class="o">$</span><span class="n">promedio</span><span class="p">)</span>
<span class="n">k</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">modelo3</span><span class="o">$</span><span class="n">coefficients</span><span class="p">)</span>
<span class="n">J</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">5</span>
<span class="n">F_stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">R2_NR</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">R2_R</span><span class="p">)</span><span class="o">/</span><span class="n">J</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="m">1</span><span class="o">-</span><span class="n">R2_NR</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k</span><span class="p">));</span><span class="w"> </span><span class="n">F_stat</span>
<span class="n">F_critico</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">qf</span><span class="p">(</span><span class="m">1-0.05</span><span class="p">,</span><span class="w"> </span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">k</span><span class="p">);</span><span class="w"> </span><span class="n">F_critico</span>

<span class="c1">#Conclusion?</span>
<span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="n">F_stat</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">F_critico</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="s">&#39;Rechace H0 (con alpha = 5%)&#39;</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">print</span><span class="p">(</span><span class="s">&#39;No rechace H0 (con alpha = 5%)&#39;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">#P-valor </span>
<span class="nf">pf</span><span class="p">(</span><span class="n">F_stat</span><span class="p">,</span><span class="w"> </span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = promedio ~ doc_examen + mujer + edad + estrato + 
    trabaja + meduc_prim + meduc_sec + meduc_preg + doc_mujer + 
    doc_exper + doc_normal + doc_preg + doc_posg, data = datos)

Residuals:
     Min       1Q   Median       3Q      Max 
-10.4115  -1.7789  -0.0823   1.6588  13.2181 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 46.762068   1.183147  39.523  &lt; 2e-16 ***
doc_examen   0.108890   0.013257   8.214 2.62e-16 ***
mujer        1.111196   0.263477   4.217 2.51e-05 ***
edad        -0.781786   0.029643 -26.373  &lt; 2e-16 ***
estrato      2.793228   0.098402  28.386  &lt; 2e-16 ***
trabaja      1.418454   0.332558   4.265 2.03e-05 ***
meduc_prim   1.971494   0.441749   4.463 8.24e-06 ***
meduc_sec    2.638058   0.432358   6.102 1.12e-09 ***
meduc_preg  11.437615   0.578539  19.770  &lt; 2e-16 ***
doc_mujer   -0.506354   0.322911  -1.568   0.1169    
doc_exper   -0.080605   0.009113  -8.845  &lt; 2e-16 ***
doc_normal  -1.489506   0.771798  -1.930   0.0537 .  
doc_preg     1.018492   0.609142   1.672   0.0946 .  
doc_posg     5.765619   0.605433   9.523  &lt; 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 2.678 on 5784 degrees of freedom
Multiple R-squared:  0.5488,	Adjusted R-squared:  0.5478 
F-statistic: 541.1 on 13 and 5784 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
<div class="output text_html">0.548779446743456</div><div class="output text_html">0.510006723559911</div><div class="output text_html">99.4021346213443</div><div class="output text_html">2.21564477242357</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Rechace H0 (con alpha = 5%)&quot;
</pre></div>
</div>
<div class="output text_html">1</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Normalidad de los errores</span>
<span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">modelo3</span><span class="o">$</span><span class="n">residuals</span>

<span class="c1">#Histogramas y Densidad Acumulada</span>
<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Residuals&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">probability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.2</span><span class="p">),</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">)</span><span class="w"> </span><span class="c1">#Histograma de esiduales</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">density</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="bp">T</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># Densidad estimada de los residuales</span>
<span class="nf">curve</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="bp">T</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="bp">T</span><span class="p">)),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">#Distribucion normal</span>

<span class="nf">qqnorm</span><span class="p">(</span><span class="nf">rstandard</span><span class="p">(</span><span class="n">modelo3</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="c1">##Q-Q plot</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>

<span class="c1">#Pruebas de normalidad</span>
<span class="nf">shapiro.test</span><span class="p">(</span><span class="nf">sample</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="m">5000</span><span class="p">))</span>
<span class="nf">ks.test</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pnorm&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Shapiro-Wilk normality test

data:  sample(e, 5000)
W = 0.99529, p-value = 1.165e-11
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Asymptotic one-sample Kolmogorov-Smirnov test

data:  e
D = 0.02361, p-value = 0.003117
alternative hypothesis: two-sided
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/4854c98fa5e063527c706723adf38c590fae13fa32413a425057d74840527b14.png"><img alt="_images/4854c98fa5e063527c706723adf38c590fae13fa32413a425057d74840527b14.png" src="_images/4854c98fa5e063527c706723adf38c590fae13fa32413a425057d74840527b14.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;modelsummary&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">modelsummary</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Modelos estimados</span>
<span class="n">models</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="s">&quot;Modelo 1&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modelo1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Modelo 2&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modelo2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Modelo 3&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modelo3</span><span class="p">)</span>
<span class="w">    </span>
<span class="c1">#Labels</span>
<span class="n">my_coef_map</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;doc_examen&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Puntaje en Carrera Docente&quot;</span><span class="p">)</span>

<span class="c1">#Tabla para comparar coeficientes</span>
<span class="nf">modelsummary</span><span class="p">(</span><span class="n">models</span><span class="p">,</span><span class="w"> </span><span class="n">coef_map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_coef_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------------------------+------------+------------+------------+
|                            | Modelo 1   | Modelo 2   | Modelo 3   |
+============================+============+============+============+
| Puntaje en Carrera Docente | 0.460      | 0.167      | 0.109      |
+----------------------------+------------+------------+------------+
|                            | (0.016)    | (0.013)    | (0.013)    |
+----------------------------+------------+------------+------------+
| Num.Obs.                   | 5798       | 5798       | 5798       |
+----------------------------+------------+------------+------------+
| R2                         | 0.131      | 0.510      | 0.549      |
+----------------------------+------------+------------+------------+
| R2 Adj.                    | 0.131      | 0.509      | 0.548      |
+----------------------------+------------+------------+------------+
| AIC                        | 31669.9    | 28360.8    | 27892.8    |
+----------------------------+------------+------------+------------+
| BIC                        | 31689.9    | 28427.4    | 27992.8    |
+----------------------------+------------+------------+------------+
| Log.Lik.                   | -15831.953 | -14170.391 | -13931.411 |
+----------------------------+------------+------------+------------+
| RMSE                       | 3.71       | 2.79       | 2.67       |
+----------------------------+------------+------------+------------+ 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;lmtest&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;skedastic&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;lmtest&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;skedastic&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The downloaded binary packages are in
	/var/folders/b8/49g109jd3q9fzp3y0ccjzdbw0000gn/T//Rtmpvgrtnx/downloaded_packages
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>also installing the dependencies ‘globals’, ‘future’, ‘shape’, ‘future.apply’, ‘progressr’, ‘SQUAREM’, ‘diagram’, ‘lava’, ‘cli’, ‘rlang’, ‘prodlim’, ‘iterators’, ‘clock’, ‘gower’, ‘hardhat’, ‘ipred’, ‘sparsevctrs’, ‘timeDate’, ‘rbibutils’, ‘zigg’, ‘RcppParallel’, ‘RcppArmadillo’, ‘foreach’, ‘ModelMetrics’, ‘plyr’, ‘pROC’, ‘recipes’, ‘reshape2’, ‘registry’, ‘Rdpack’, ‘pracma’, ‘CompQuadForm’, ‘quadprog’, ‘inflection’, ‘Rfast’, ‘caret’, ‘quadprogXT’, ‘slam’, ‘ROI’, ‘osqp’, ‘ROI.plugin.qpoases’
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The downloaded binary packages are in
	/var/folders/b8/49g109jd3q9fzp3y0ccjzdbw0000gn/T//Rtmpvgrtnx/downloaded_packages
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message:
“package ‘lmtest’ was built under R version 4.3.3”
Loading required package: zoo

Warning message:
“package ‘zoo’ was built under R version 4.3.3”

Attaching package: ‘zoo’


The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric


Warning message:
“package ‘skedastic’ was built under R version 4.3.3”
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Pruebas de Heteroscedasticidad</span>

<span class="c1">#Goldfeld-Quant</span>
<span class="nf">gqtest</span><span class="p">(</span><span class="n">modelo3</span><span class="p">)</span>

<span class="c1">#Breush-Pagan</span>
<span class="nf">bptest</span><span class="p">(</span><span class="n">modelo3</span><span class="p">)</span>

<span class="c1">#Prueba de White</span>
<span class="nf">white</span><span class="p">(</span><span class="n">mainlm</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">modelo3</span><span class="p">,</span><span class="w"> </span><span class="n">interactions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	Goldfeld-Quandt test

data:  modelo3
GQ = 1.2819, df1 = 2885, df2 = 2885, p-value = 1.357e-11
alternative hypothesis: variance increases from segment 1 to 2
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	studentized Breusch-Pagan test

data:  modelo3
BP = 168.7, df = 13, p-value &lt; 2.2e-16
</pre></div>
</div>
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 1 × 5</caption>
<thead>
	<tr><th scope=col>statistic</th><th scope=col>p.value</th><th scope=col>parameter</th><th scope=col>method</th><th scope=col>alternative</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;chr&gt;</th><th scope=col>&lt;chr&gt;</th></tr>
</thead>
<tbody>
	<tr><td>473.7618</td><td>1.377128e-48</td><td>104</td><td>White's Test</td><td>greater</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">#Tabla con errores robustos (de White)</span>
<span class="nf">modelsummary</span><span class="p">(</span><span class="n">models</span><span class="p">,</span><span class="w"> </span><span class="n">coef_map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">my_coef_map</span><span class="p">,</span><span class="w"> </span><span class="n">vcov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;HC1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>+----------------------------+------------+------------+------------+
|                            | Modelo 1   | Modelo 2   | Modelo 3   |
+============================+============+============+============+
| Puntaje en Carrera Docente | 0.460      | 0.167      | 0.109      |
+----------------------------+------------+------------+------------+
|                            | (0.017)    | (0.015)    | (0.015)    |
+----------------------------+------------+------------+------------+
| Num.Obs.                   | 5798       | 5798       | 5798       |
+----------------------------+------------+------------+------------+
| R2                         | 0.131      | 0.510      | 0.549      |
+----------------------------+------------+------------+------------+
| R2 Adj.                    | 0.131      | 0.509      | 0.548      |
+----------------------------+------------+------------+------------+
| AIC                        | 31669.9    | 28360.8    | 27892.8    |
+----------------------------+------------+------------+------------+
| BIC                        | 31689.9    | 28427.4    | 27992.8    |
+----------------------------+------------+------------+------------+
| Log.Lik.                   | -15831.953 | -14170.391 | -13931.411 |
+----------------------------+------------+------------+------------+
| RMSE                       | 3.71       | 2.79       | 2.67       |
+----------------------------+------------+------------+------------+
| Std.Errors                 | HC1        | HC1        | HC1        |
+----------------------------+------------+------------+------------+ 
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Taller_2_Sol.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Taller 2</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pregunta-1">Pregunta 1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solucion">Solución</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pregunta-2">Pregunta 2</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Solución</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pregunta-3">Pregunta 3</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Solución</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sebastian Montano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>