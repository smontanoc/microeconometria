
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Evaluación de Supuestos &#8212; Microeconometria Aplicada</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '5_Supuestos';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Variables de Respuesta Cualitativa" href="6_Respuesta_Cualitativa.html" />
    <link rel="prev" title="Modelo de Regresión Multiple" href="4_Regresion.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Microeconometria Aplicada - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Microeconometria Aplicada - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Microeconometría Aplicada
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="0_Motivacion.html">Qué es la Microeconometría?</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_Regresion.html">Modelo de Regresión Lineal</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_Regresion.html">Modelo de Regresión Multiple</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Evaluación de Supuestos</a></li>
<li class="toctree-l1"><a class="reference internal" href="6_Respuesta_Cualitativa.html">Variables de Respuesta Cualitativa</a></li>

<li class="toctree-l1"><a class="reference internal" href="7_RepeatedCross.html">Modelo de Cortes Transversales Repetidos</a></li>
<li class="toctree-l1"><a class="reference internal" href="1_Probabilidad.html">Fundamentos de Probabilidad</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Estadistica.html">Fundamentos de Estadística</a></li>
<li class="toctree-l1"><a class="reference internal" href="Taller_1_Sol.html">Taller 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="Taller_2_Sol.html">Taller 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Taller_3_Sol.html">Taller 3</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F5_Supuestos.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/5_Supuestos.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Evaluación de Supuestos</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multicolinealidad">Multicolinealidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#como-identificar-multicolinealidad">¿Cómo identificar multicolinealidad?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#no-normalidad-de-errores">No-normalidad de Errores</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-normalidad">Pruebas de Normalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heteroscedasticidad">Heteroscedasticidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#por-que-nos-interesa-la-heteroscedasticidad">¿Por qué nos interesa la heteroscedasticidad?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-goldfeld-quandt">Prueba de Goldfeld-Quandt</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-breusch-pagan">Prueba de Breusch-Pagan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procedimiento-prueba-de-breusch-pagan">Procedimiento: Prueba de Breusch-Pagan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-white">Prueba de White</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heteroscedasticidad-y-error-de-especificacion">Heteroscedasticidad y Error de Especificación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-ponderados">Mínimos Cuadrados Ponderados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-factibles">Minimos Cuadrados Factibles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#errores-estandar-robustos">Errores Estándar Robustos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sesgo-por-error-de-especificacion">Sesgo por Error de Especificación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#error-de-medicion-variable-dependiente">Error de Medición: Variable Dependiente</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#error-de-medicion-variable-independiente">Error de Medición: Variable Independiente</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="evaluacion-de-supuestos">
<h1>Evaluación de Supuestos<a class="headerlink" href="#evaluacion-de-supuestos" title="Link to this heading">#</a></h1>
<p>Debido al <strong>Teorema de Gauss-Markov</strong>, queremos que los supuestos del modelo se cumplan.</p>
<p>En las siguientes clases consideraremos las implicaciones de la <strong>violación de supuestos</strong>:</p>
<ul class="simple">
<li><p>¿Cómo identificamos si se está violando un supuesto?</p></li>
<li><p>¿Qué debemos hacer cuando no se cumple alguno de los supuestos?</p></li>
<li><p>¿Cómo solucionamos el problema?</p></li>
</ul>
<section id="multicolinealidad">
<h2>Multicolinealidad<a class="headerlink" href="#multicolinealidad" title="Link to this heading">#</a></h2>
<p>Si se presenta una fuerte correlación entre dos o más variables de la matrix <span class="math notranslate nohighlight">\(X\)</span>, es posible que se viole el supuesto de <strong>no multicolinealidad</strong>.</p>
<p>Suponga que queremos estimar el modelo:</p>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \varepsilon_i\]</div>
<p>Si <span class="math notranslate nohighlight">\(x_2\)</span> se puede escribir como una <strong>combinación lineal</strong> de la variable <span class="math notranslate nohighlight">\(x_1\)</span>, entonces la multicolinealidad es <strong>perfecta</strong> y el modelo <strong>no es estimable</strong>. Ejemplo:</p>
<div class="math notranslate nohighlight">
\[x_{2i} = c_1 + c_2 x_{1i}, \hspace{5pt}\text{con}\hspace{5pt} c_1, c_2 \in \mathbb{R}\]</div>
<p>Si existe una <strong>correlación fuerte</strong> (pero no perfecta) entre <span class="math notranslate nohighlight">\(x_1\)</span> y <span class="math notranslate nohighlight">\(x_2\)</span>, la multicolinealidad es <strong>imperfecta</strong>. En este caso, el modelo es <strong>estimable</strong>, pero la precisión de nuestros estimadores se ve comprometida. Esto afecta los intervalos de confianza y las pruebas de hipótesis (o significancia estadística).</p>
</section>
<section id="como-identificar-multicolinealidad">
<h2>¿Cómo identificar multicolinealidad?<a class="headerlink" href="#como-identificar-multicolinealidad" title="Link to this heading">#</a></h2>
<p>En nuestro modelo con 2 variables independientes, se puede mostrar que</p>
<div class="math notranslate nohighlight">
\[V(\hat\beta_1) = \frac{\sigma^2}{\sum_{i = 1}^n x^2_{1i} (1 - \rho_{1, 2})}\]</div>
<p>donde <span class="math notranslate nohighlight">\(\rho_{1, 2}\)</span> es el coeficiente de correlación entre <span class="math notranslate nohighlight">\(x_1\)</span> y <span class="math notranslate nohighlight">\(x_2\)</span>.</p>
<p>Observe que si la correlación entre ambas variables es cercana a 1, <span class="math notranslate nohighlight">\(V(\hat\beta_1)\)</span> es muy grande y, por lo tanto, es difícil rechazar la hipotesis nula <span class="math notranslate nohighlight">\(H_0: \beta_1 = 0\)</span>.</p>
<p>Podemos sospechar que existe multicolinealidad cuando tenemos <strong>pruebas individuales no significativas</strong>, pero el estadístico <span class="math notranslate nohighlight">\(F\)</span> y coeficiente de determinacion <span class="math notranslate nohighlight">\(R^2\)</span> son muy grandes.</p>
<p>También podemos calcular <span class="math notranslate nohighlight">\(|\rho_{1, 2}|\)</span> y determinar si este valor es cercano a 1.</p>
<p><strong>Solución</strong>: excluir una de las variables!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">w</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.8</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1.4</span><span class="p">,</span><span class="w"> </span><span class="m">1.2</span><span class="p">,</span><span class="w"> </span><span class="m">1.8</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1.8</span><span class="p">,</span><span class="w"> </span><span class="m">2.1</span><span class="p">,</span><span class="w"> </span><span class="m">2.7</span><span class="p">,</span><span class="w"> </span><span class="m">3.0</span><span class="p">)</span><span class="w"> </span><span class="c1">#Salarios</span>
<span class="n">s</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c1">#educacion</span>
<span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="c1">#mujer=1, hombre=0</span>
<span class="n">s_mp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">2</span><span class="o">*</span><span class="n">s</span>
<span class="n">s_imp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">)</span>

<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">w</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">s</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = w ~ s)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.4350 -0.1113  0.0150  0.1163  0.3100 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.41500    0.16490   2.517    0.036 *  
s            0.45500    0.04972   9.152 1.64e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2223 on 8 degrees of freedom
Multiple R-squared:  0.9128,	Adjusted R-squared:  0.9019 
F-statistic: 83.75 on 1 and 8 DF,  p-value: 1.639e-05
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">s_mp</span><span class="p">);</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;Correlacion entre s y s_mp = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">))</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">w</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s_mp</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Correlacion entre s y s_mp = 1&quot;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = w ~ s + s_mp)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.4350 -0.1113  0.0150  0.1163  0.3100 

Coefficients: (1 not defined because of singularities)
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  0.41500    0.16490   2.517    0.036 *  
s            0.45500    0.04972   9.152 1.64e-05 ***
s_mp              NA         NA      NA       NA    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2223 on 8 degrees of freedom
Multiple R-squared:  0.9128,	Adjusted R-squared:  0.9019 
F-statistic: 83.75 on 1 and 8 DF,  p-value: 1.639e-05
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="w"> </span><span class="n">s_imp</span><span class="p">);</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="nf">paste0</span><span class="p">(</span><span class="s">&#39;Correlacion entre s y s_imp = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">rho</span><span class="p">))</span>
<span class="nf">summary</span><span class="p">(</span><span class="nf">lm</span><span class="p">(</span><span class="n">w</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s_imp</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] &quot;Correlacion entre s y s_imp = 0.981265558383595&quot;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = w ~ s + s_imp)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.44235 -0.07456  0.00765  0.08868  0.31000 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)   0.4518     0.1833   2.465   0.0432 *
s             0.3006     0.2694   1.116   0.3013  
s_imp         0.1471     0.2518   0.584   0.5775  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.2321 on 7 degrees of freedom
Multiple R-squared:  0.9169,	Adjusted R-squared:  0.8931 
F-statistic:  38.6 on 2 and 7 DF,  p-value: 0.0001657
</pre></div>
</div>
</div>
</div>
</section>
<section id="no-normalidad-de-errores">
<h2>No-normalidad de Errores<a class="headerlink" href="#no-normalidad-de-errores" title="Link to this heading">#</a></h2>
<p>Nuestro modelo asume que los errores se distribuyen normales, es decir</p>
<div class="math notranslate nohighlight">
\[
\varepsilon \sim N(0, \sigma^2 I)
\]</div>
<ul class="simple">
<li><p>Debido al <strong>Teorema del Límite Central</strong> es un supuesto muy razonable.</p></li>
<li><p>No tiene implicaciones graves.</p></li>
<li><p>No es necesario en la demostración de <strong>Gauss-Markov</strong>.</p></li>
<li><p>Sin embargo, es útil para determinar la distribución de los <strong>estadísticos</strong> usados en las pruebas de significancia.</p></li>
</ul>
<p>Para evaluar si el supuesto se cumple o no se puede hacer un procedimiento muy sencillo.</p>
<ul class="simple">
<li><p>Computamos los residuales y los graficamos.</p></li>
<li><p>Generalmente, estos residuales van a tener una distribución muy parecida a la normal.</p></li>
<li><p>Debido a que incluimos una constante en nuestra regresión, los residuales casi siempre tienen media cero.</p></li>
</ul>
<p>Adicionalmente, se puede hacer un test para evaluar la normalidad de la variable.</p>
<p>Este supuesto se cumplir a a medida que aumentemos el tamaño de muestra.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="nf">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">educ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">exper</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">expersq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">female</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">wage1</span><span class="p">)</span>
<span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">model</span><span class="o">$</span><span class="n">residuals</span>

<span class="nf">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">))</span>
<span class="nf">hist</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Residuals&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">probability</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">T</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="c1">#Histograma de esiduales</span>
<span class="nf">lines</span><span class="p">(</span><span class="nf">density</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="bp">T</span><span class="p">),</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1"># Densidad estimada de los residuales</span>
<span class="nf">curve</span><span class="p">(</span><span class="nf">dnorm</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="bp">T</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="bp">T</span><span class="p">)),</span><span class="w"> </span><span class="n">lty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="c1">#Distribucion normal</span>
<span class="nf">qqnorm</span><span class="p">(</span><span class="nf">rstandard</span><span class="p">(</span><span class="n">model</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="c1">##Q-Q plot</span>
<span class="nf">abline</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="o">=</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">lty</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">lwd</span><span class="o">=</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="ow">in</span> <span class="nb">eval</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">frame</span><span class="p">()):</span> <span class="nb">object</span> <span class="s1">&#39;wage1&#39;</span> <span class="ow">not</span> <span class="n">found</span>
<span class="ne">Traceback</span>:

<span class="mi">1</span><span class="o">.</span> <span class="nb">eval</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">frame</span><span class="p">())</span>
<span class="mi">2</span><span class="o">.</span> <span class="nb">eval</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">frame</span><span class="p">())</span>
<span class="mi">3</span><span class="o">.</span> <span class="n">stats</span><span class="p">::</span><span class="n">model</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span> <span class="o">~</span> <span class="n">educ</span> <span class="o">+</span> <span class="n">exper</span> <span class="o">+</span> <span class="n">expersq</span> <span class="o">+</span> 
 <span class="o">.</span>     <span class="n">female</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">wage1</span><span class="p">,</span> <span class="n">drop</span><span class="o">.</span><span class="n">unused</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
<span class="mi">4</span><span class="o">.</span> <span class="n">model</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="n">formula</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">wage</span><span class="p">)</span> <span class="o">~</span> <span class="n">educ</span> <span class="o">+</span> <span class="n">exper</span> <span class="o">+</span> <span class="n">expersq</span> <span class="o">+</span> 
 <span class="o">.</span>     <span class="n">female</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">wage1</span><span class="p">,</span> <span class="n">drop</span><span class="o">.</span><span class="n">unused</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
<span class="mi">5</span><span class="o">.</span> <span class="ow">is</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="mi">6</span><span class="o">.</span> <span class="o">.</span><span class="n">handleSimpleError</span><span class="p">(</span><span class="n">function</span> <span class="p">(</span><span class="n">cnd</span><span class="p">)</span> 
 <span class="o">.</span> <span class="p">{</span>
 <span class="o">.</span>     <span class="n">watcher</span><span class="err">$</span><span class="n">capture_plot_and_output</span><span class="p">()</span>
 <span class="o">.</span>     <span class="n">cnd</span> <span class="o">&lt;-</span> <span class="n">sanitize_call</span><span class="p">(</span><span class="n">cnd</span><span class="p">)</span>
 <span class="o">.</span>     <span class="n">watcher</span><span class="err">$</span><span class="n">push</span><span class="p">(</span><span class="n">cnd</span><span class="p">)</span>
 <span class="o">.</span>     <span class="n">switch</span><span class="p">(</span><span class="n">on_error</span><span class="p">,</span> <span class="k">continue</span> <span class="o">=</span> <span class="n">invokeRestart</span><span class="p">(</span><span class="s2">&quot;eval_continue&quot;</span><span class="p">),</span> 
 <span class="o">.</span>         <span class="n">stop</span> <span class="o">=</span> <span class="n">invokeRestart</span><span class="p">(</span><span class="s2">&quot;eval_stop&quot;</span><span class="p">),</span> <span class="n">error</span> <span class="o">=</span> <span class="n">NULL</span><span class="p">)</span>
 <span class="o">.</span> <span class="p">},</span> <span class="s2">&quot;object &#39;wage1&#39; not found&quot;</span><span class="p">,</span> <span class="n">base</span><span class="p">::</span><span class="n">quote</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">mf</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">frame</span><span class="p">())))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pruebas-de-normalidad">
<h2>Pruebas de Normalidad<a class="headerlink" href="#pruebas-de-normalidad" title="Link to this heading">#</a></h2>
<p>Algunas pruebas estadísticas nos permiten evaluar si una variable se distribuye normal o no. En general, bajo la hipotesis nula se asume que la variable se distribuye normal, es decir:</p>
<div class="math notranslate nohighlight">
\[H_0: X \sim N(\mu_X, \sigma_X^2)\]</div>
<div class="math notranslate nohighlight">
\[H_1: X \text{ no se distribuye normal }\]</div>
<p>Ejemplo de pruebas:</p>
<ol class="arabic simple">
<li><p>Shapiro-Wilk (recomendada): Prueba paramétrica que compara la densidad estimada y la densidad teorica</p></li>
<li><p>Kolmogorov-Smirnov: Compara la distribución acumulada de los datos y la distribución teorica</p></li>
<li><p>Jarque-Bera</p></li>
<li><p>Anderson-Darling</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">shapiro.test</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="nf">ks.test</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;pnorm&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">e</span><span class="p">),</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sd</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="heteroscedasticidad">
<h2>Heteroscedasticidad<a class="headerlink" href="#heteroscedasticidad" title="Link to this heading">#</a></h2>
<p>Uno de los supuestos de nuestro modelo es que la varianza de los errores es constante. Es decir,</p>
<div class="math notranslate nohighlight">
\[V(\varepsilon_i) = \sigma^2\]</div>
<p>En un modelo <strong>heteroscedastico</strong>,</p>
<div class="math notranslate nohighlight">
\[V(\varepsilon_i) = \sigma_{i}^2 \hspace{5pt}\text{donde}\hspace{5pt} \sigma_{i}^2 \neq \sigma_{j}^2 \hspace{5pt}\text{para algún}\hspace{5pt} i \neq j\]</div>
<p>En la práctica es común que nuestros errores no tengan varianza constante.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;scales&quot;</span><span class="p">);</span><span class="w"> </span><span class="nf">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">080925</span><span class="p">)</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">))</span>
<span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-20</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">),</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Variable x&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Errores (&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">)),</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">alpha</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Installing package into &#39;C:/Users/smontano/AppData/Local/R/win-library/4.3&#39;
(as &#39;lib&#39; is unspecified)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  There is a binary version available but the source version is later:
       binary source needs_compilation
scales  1.3.0  1.4.0             FALSE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>installing the source package &#39;scales&#39;
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/1b65880f9df9c57f667d63f8ec57ee755ab99e3213b6fcbe68972ee0bd50c05c.png"><img alt="_images/1b65880f9df9c57f667d63f8ec57ee755ab99e3213b6fcbe68972ee0bd50c05c.png" src="_images/1b65880f9df9c57f667d63f8ec57ee755ab99e3213b6fcbe68972ee0bd50c05c.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
<span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">*</span><span class="n">x</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-20</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">),</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-10</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Variable x&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Errores (&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">)),</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">alpha</span><span class="p">(</span><span class="s">&quot;blue&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/1d6301afe4e1bf0c28267efcc700a8ce36121f6d37f2157d0eaf64e756ece09b.png"><img alt="_images/1d6301afe4e1bf0c28267efcc700a8ce36121f6d37f2157d0eaf64e756ece09b.png" src="_images/1d6301afe4e1bf0c28267efcc700a8ce36121f6d37f2157d0eaf64e756ece09b.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rnorm</span><span class="p">(</span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="m">500</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">))</span><span class="w"> </span>
<span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">500</span><span class="p">),</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">500</span><span class="p">))</span>

<span class="n">markers</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">19</span><span class="p">,</span><span class="w"> </span><span class="m">17</span><span class="p">)</span>
<span class="n">colors</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;#66BD63&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;#FDAE61&quot;</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-20</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">),</span><span class="w"> </span><span class="n">xlim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">),</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Variable x&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">expression</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;Errores (&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="p">)),</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">markers</span><span class="p">[</span><span class="nf">factor</span><span class="p">(</span><span class="n">f</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">alpha</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="nf">factor</span><span class="p">(</span><span class="n">f</span><span class="p">)],</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="bp">F</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<a class="reference internal image-reference" href="_images/7fa541d4dccc1e380d5360c8758a1c89fc9c3c6a271f3569a8706e1cc260f4f5.png"><img alt="_images/7fa541d4dccc1e380d5360c8758a1c89fc9c3c6a271f3569a8706e1cc260f4f5.png" src="_images/7fa541d4dccc1e380d5360c8758a1c89fc9c3c6a271f3569a8706e1cc260f4f5.png" style="width: 420px; height: 420px;" />
</a>
</div>
</div>
</section>
<section id="por-que-nos-interesa-la-heteroscedasticidad">
<h2>¿Por qué nos interesa la heteroscedasticidad?<a class="headerlink" href="#por-que-nos-interesa-la-heteroscedasticidad" title="Link to this heading">#</a></h2>
<p>Recordemos que en regresión simple encontramos que:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    \hat\beta_1 &amp; = \frac{\widehat{Cov(x, y)}}{\widehat{V(x)}} = \frac{\sum_i (X_i - \overline X)(Y_i - \overline Y)}{\sum_i (X_i - \overline X)^2}\\
    &amp; = \beta_1 + \frac{\sum_i (X_i - \overline X) \cdot \varepsilon_i}{\sum_i (X_i - \overline X)^2} \\     
\end{align*}\]</div>
<p>Si asumimos que <span class="math notranslate nohighlight">\(E(\varepsilon_i | X) = 0\)</span>, podemos concluir que <span class="math notranslate nohighlight">\(E(\hat\beta_1) = \beta_1\)</span>. Es decir, <strong>nuestros estimadores seguirán siendo insesgados</strong> a pesar de que la varianza de los errores no es constante.</p>
<p>Si asumimos que <span class="math notranslate nohighlight">\(Cov(\varepsilon_i, \varepsilon_j) = 0\)</span>, podemos mostrar que:</p>
<div class="math notranslate nohighlight">
\[ee(\hat\beta_1) = \sqrt{V(\hat\beta_1)} = \sqrt{\frac{\sigma_i^2}{\sum_i (X_i - \overline X)^2}}\]</div>
<p>La <strong>heteroscedasticidad</strong> afecta los errores estándar de nuestros estimadores.</p>
<p><strong>En presencia de heteroscedasticidad</strong>, asumir que la varianza de los errores es constantes implica que nuestros <strong>errores estandar</strong> están <strong>sesgados</strong>.</p>
<p>Por lo tanto,</p>
<ul class="simple">
<li><p>los intervalos de confianza son incorrectos, y</p></li>
<li><p>las pruebas de significancia (<span class="math notranslate nohighlight">\(t\)</span> y <span class="math notranslate nohighlight">\(F\)</span>) no son validas</p></li>
</ul>
<p><strong>Solución</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Probar</strong> que hay presencia de heteroscedasticidad</p></li>
</ol>
<p>Prueba de Goldfeld-Quandt</p>
<p>Prueba de Breusch-Pagan</p>
<p>Prueba de White</p>
<ol class="arabic simple" start="2">
<li><p><strong>Corrección</strong> de los estimadores de la varianza</p></li>
</ol>
<p>Evitar error de especificación</p>
<p>Mínimos Cuadrados Ponderados</p>
<p>Erorres estándar robustos</p>
</section>
<section id="prueba-de-goldfeld-quandt">
<h2>Prueba de Goldfeld-Quandt<a class="headerlink" href="#prueba-de-goldfeld-quandt" title="Link to this heading">#</a></h2>
<p>Para determinar si existe heteroscedasticidad, podemos usar los <strong>residuales</strong> <span class="math notranslate nohighlight">\(e_i = y_i - \hat y_i\)</span> como un <strong>estimador de los errores poblaciones</strong> <span class="math notranslate nohighlight">\(\varepsilon_i\)</span></p>
<p>Recuerde que un estimador de la varianza del modelo (i.e., <span class="math notranslate nohighlight">\(\sigma^2\)</span>) es</p>
<div class="math notranslate nohighlight">
\[\widehat\sigma^2 = \frac{SSE}{n-k} = \frac{\sum_{i=1}^n e_i^2}{n-k}\]</div>
<p>Observe que podemos dividir la población en dos grupos de tamaño <span class="math notranslate nohighlight">\(n_1\)</span> y <span class="math notranslate nohighlight">\(n_2\)</span> y evaluar si:</p>
<p><span class="math notranslate nohighlight">\(H_0: \sigma_1^2 = \sigma_2^2\)</span>
<span class="math notranslate nohighlight">\(H_1: \sigma_1^2 \neq \sigma_2^2\)</span></p>
<p>Para ello usaremos el estadístico de prueba</p>
<div class="math notranslate nohighlight">
\[F_{stat} = \frac{SSE_2/(n_2 - k)}{SSE_1/(n_1 - k)} \sim F_{n_2-k \hspace{2pt},\hspace{2pt} n_1-k}\]</div>
<p><strong>Esta prueba es muy dependiente de la forma funcional de la heteroscedasticidad</strong>, veamos por qué!</p>
</section>
<section id="prueba-de-breusch-pagan">
<h2>Prueba de Breusch-Pagan<a class="headerlink" href="#prueba-de-breusch-pagan" title="Link to this heading">#</a></h2>
<p>Una segunda prueba que podemos realizar es la prueba de <strong>Breusch-Pagan</strong>.<br />
Asumimos que existe una relación lineal:</p>
<div class="math notranslate nohighlight">
\[
\sigma_i^2 = \sigma^2 f(\alpha_0 + \alpha_1 X)
\]</div>
<p>Hacemos una prueba de hipótesis de la forma:</p>
<div class="math notranslate nohighlight">
\[
H_0 : \alpha_1 = 0 \;\;\; \Rightarrow \;\; \text{Homoscedasticidad } = \sigma^2 f(\alpha_0)
\]</div>
<div class="math notranslate nohighlight">
\[
H_1 : \alpha_1 \neq 0 \;\;\; \Rightarrow \;\; \text{Heteroscedasticidad } = \sigma^2 f(\alpha_0 + \alpha_1 X)
\]</div>
<p>En esta prueba vamos a evaluar la relación estadística entre:</p>
<div class="math notranslate nohighlight">
\[
e_i^2 \quad \text{y ciertas variables explicativas } X
\]</div>
</section>
<section id="procedimiento-prueba-de-breusch-pagan">
<h2>Procedimiento: Prueba de Breusch-Pagan<a class="headerlink" href="#procedimiento-prueba-de-breusch-pagan" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Correr la regresión original</strong>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
Y = X\beta + \varepsilon
\]</div>
<ol class="arabic simple" start="2">
<li><p><strong>Obtener</strong>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\hat{\sigma}^2 = \frac{\sum e_i^2}{n-k}
\]</div>
<ol class="arabic simple" start="3">
<li><p><strong>Calcular</strong> y <strong>Estimar</strong>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
p_i = \frac{e_i^2}{\hat{\sigma}^2}
\]</div>
<div class="math notranslate nohighlight">
\[
p_i = X\alpha + u
\]</div>
<ol class="arabic simple" start="5">
<li><p><strong>Calcular el estadístico de prueba</strong>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\Theta = \frac{1}{2}SSR \sim \chi^2_m
\]</div>
<p>donde <span class="math notranslate nohighlight">\(m\)</span> es el número de variables incluidas en la matriz <span class="math notranslate nohighlight">\(X\)</span></p>
</section>
<section id="prueba-de-white">
<h2>Prueba de White<a class="headerlink" href="#prueba-de-white" title="Link to this heading">#</a></h2>
<p>Una segunda prueba muy parecida es la <strong>prueba de White</strong>. Esta prueba <strong>no asume</strong> que hay una relación lineal entre la varianza del error y las variables en <span class="math notranslate nohighlight">\(X\)</span>.</p>
<ol class="arabic simple">
<li><p><strong>Correr la regresión original</strong>: <span class="math notranslate nohighlight">\(Y = X\beta + \varepsilon\)</span></p></li>
<li><p><strong>Calcular los residuales al cuadrado</strong>: <span class="math notranslate nohighlight">\(e_i^2\)</span></p></li>
<li><p><strong>Correr la regresión auxiliar</strong>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[e_i^2 = \alpha_0 + \alpha_1 X_1 + \alpha_2 X_2 + \alpha_3 X_1^2 + \alpha_4 X_2^2 + \alpha_5 X_1 X_2 + \dots\]</div>
<p>(incluir todos los cuadrados y las interacciones de las variables explicativas).</p>
<ol class="arabic simple" start="4">
<li><p><strong>Calcular el estadístico de prueba</strong>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[nR^2 \sim \chi^2_p\]</div>
<p>donde <span class="math notranslate nohighlight">\(p\)</span> es el número total de regresores (sin la constante) en la regresión auxiliar.</p>
</section>
<section id="heteroscedasticidad-y-error-de-especificacion">
<h2>Heteroscedasticidad y Error de Especificación<a class="headerlink" href="#heteroscedasticidad-y-error-de-especificacion" title="Link to this heading">#</a></h2>
<p><strong>Error de especificación con variables independientes</strong></p>
<p>Considere la siguiente función de regresión:</p>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \beta_1 x_i + \beta_2 x_i^2 + \varepsilon_i\]</div>
<p>donde <span class="math notranslate nohighlight">\(E(\varepsilon_i | X) = 0\)</span> y <span class="math notranslate nohighlight">\(V(\varepsilon_i | X) = \sigma^2\)</span></p>
<p>Suponga que omitimos <span class="math notranslate nohighlight">\(x^2\)</span> y estimamos el siguiente modelo:</p>
<div class="math notranslate nohighlight">
\[y_i = \gamma_0 + \gamma_1 x_i + u_i\]</div>
<div class="math notranslate nohighlight">
\[u_i = \varepsilon_i + \beta_2 x_i^2\]</div>
<p>Oberve que en este caso</p>
<div class="math notranslate nohighlight">
\[V(u_i) = \sigma^2 + V(\beta_2 x_i^2)\]</div>
<p>Ya que la varianza de <span class="math notranslate nohighlight">\(u_i\)</span> depende de <span class="math notranslate nohighlight">\(x_i\)</span>, el error de especificación genera heteroscedasticidad.</p>
<p><strong>Error de especificación de la variable dependientes</strong></p>
<p>Considere ahora la regresión</p>
<div class="math notranslate nohighlight">
\[\log(y_i) = \beta_0 + \beta_1 x_i + \varepsilon_i\]</div>
<p>donde <span class="math notranslate nohighlight">\(E(\varepsilon_i | X) = E(\varepsilon_i)\)</span> y <span class="math notranslate nohighlight">\(\varepsilon_i \sim N(0, \sigma^2)\)</span>. De esta manera,</p>
<div class="math notranslate nohighlight">
\[\log(y_i) \sim N(\beta_0 + \beta_1 x_i, \sigma^2)\]</div>
<p>Suponga que estimamos el modelo</p>
<div class="math notranslate nohighlight">
\[y_i = \gamma_0 + \gamma_1 x_i + u_i\]</div>
<p>Observe que la varianza de <span class="math notranslate nohighlight">\(u_i\)</span> está dada por</p>
<div class="math notranslate nohighlight">
\[V(u_i) = (e^{\sigma^2} - 1) e^{2(\beta_0 + \beta_1 x_i)+ \sigma^2}\]</div>
<p>Ya que la varianza de <span class="math notranslate nohighlight">\(u_i\)</span> depende de <span class="math notranslate nohighlight">\(x_i\)</span>, el error de especificación genera heteroscedasticidad.</p>
<p><strong>¿Es posible solucionar la heteroscedasticidad por error de especificación?</strong></p>
<p>Errores en la especificación pueden generar heteroscedasticidad (además de otros problemas). Sin embargo, usualmente <strong>desconocemos</strong> la especificación correcta.</p>
<p>Por esta razón necesitamos una manera formal de tratar la heteroscedasticidad.</p>
</section>
<section id="minimos-cuadrados-ponderados">
<h2>Mínimos Cuadrados Ponderados<a class="headerlink" href="#minimos-cuadrados-ponderados" title="Link to this heading">#</a></h2>
<p>El método de mínimos cuadrados ponderados presenta una solución al problema de heteroscedasticidad.</p>
<p>Considere el siguiente modelo:</p>
<div class="math notranslate nohighlight">
\[
y_i = \beta_0 + \beta_1 x_i + u_i, \qquad \varepsilon_i \sim N(0, \sigma_i^2)
\]</div>
<p>Transformamos este modelo diviendo cada observación por su desviación estándar <span class="math notranslate nohighlight">\(\sigma_i\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\frac{y_i}{\sigma_i} = \beta_0 \frac{1}{\sigma_i} + \beta_1 \frac{x_i}{\sigma_i} + \frac{\varepsilon_i}{\sigma_i}
\]</div>
<p>Note que el error del modelo transformado es homoscedastico:</p>
<div class="math notranslate nohighlight">
\[
V\left(\frac{\varepsilon_i}{\sigma_i} \Big| x_i\right)
= \frac{1}{\sigma^2_i} V(\varepsilon_i | x_i)
= \frac{1}{\sigma^2_i} \sigma^2_i = 1
\]</div>
<p>Más aún,</p>
<div class="math notranslate nohighlight">
\[\frac{\varepsilon_i}{\sigma_i} \sim N(0, 1)\]</div>
<p>Si aplicamos el método de mínimos cuadrados (MCO) para estimar el modelo transformado, los estimadores de <span class="math notranslate nohighlight">\(\beta_k\)</span> serán insesgados y eficientes. Sin embargo, no conocemos <span class="math notranslate nohighlight">\(\sigma_i\)</span>.</p>
<p>Suponga ahora que:</p>
<div class="math notranslate nohighlight">
\[V(\varepsilon_i \mid x_i) = \sigma^2 h(x_i)\]</div>
<p>Este supuesto es más débil. Observe además que si conocemos <span class="math notranslate nohighlight">\(h(x_i)\)</span>, entonces podemos usar MCO para estimar el siguiente modelo transformado:</p>
<div class="math notranslate nohighlight">
\[
\frac{y_i}{\sqrt{h(x_i)}} = \beta_0 \frac{1}{\sqrt{h(x_i)}} + \beta_1 \frac{x_i}{\sqrt{h(x_i)}} + \frac{\varepsilon_i}{\sqrt{h(x_i)}}
\]</div>
<p>Nuevamente nuestro modelo transformado es homoscedastico.</p>
</section>
<section id="minimos-cuadrados-factibles">
<h2>Minimos Cuadrados Factibles<a class="headerlink" href="#minimos-cuadrados-factibles" title="Link to this heading">#</a></h2>
<p>Mínimos cuadrados ponderados es un caso particular de <strong>mínimos cuadrados generalizados</strong>.</p>
<p>Bajo ciertas condiciones, podemos transformar nuestro modelo de regresión usando el estimador <span class="math notranslate nohighlight">\(\widehat{\sigma^2} = \frac{\sum_{i=1}^n e_i^2}{n-k}\)</span>. Es decir, en lugar de transformar el modelo dividiendo <span class="math notranslate nohighlight">\(\sigma_i\)</span>, dividimos por <span class="math notranslate nohighlight">\(\widehat{\sigma^2}\)</span>.</p>
<p>A este método se le conoce como <strong>mínimos cuadrados factibles</strong>.</p>
</section>
<section id="errores-estandar-robustos">
<h2>Errores Estándar Robustos<a class="headerlink" href="#errores-estandar-robustos" title="Link to this heading">#</a></h2>
<p>Para el modelo de <strong>regresión simple</strong>, podemos reescribir nuestro estimador de MCO de la siguiente manera:</p>
<div class="math notranslate nohighlight">
\[
\hat\beta_1 = \beta_1 + \frac{\sum_i (x_i - \bar{x}) \varepsilon_i}{\sum_i (x_i - \bar{x})^2}
\]</div>
<p>Suponga que nuestro modelo es heteroscedastico, es decir:</p>
<div class="math notranslate nohighlight">
\[
V(\varepsilon_i \mid x_i) = \sigma_i^2
\]</div>
<p>De esta manera,</p>
<div class="math notranslate nohighlight">
\[
V(\hat\beta_1 \mid x_i)
= \frac{\sum_i (x_i - \bar{x})^2 \sigma_i^2}{\sum_i (x_i - \bar{x})^2}
\]</div>
<p>Hal White propuso el siguiente estimador para la varianza de <span class="math notranslate nohighlight">\(\hat\beta_1\)</span>:</p>
<div class="math notranslate nohighlight">
\[
V(\hat\beta_1)
= \frac{\sum_i (x_i - \bar{x})^2 e_i^2}{\sum_i (x_i - \bar{x})^2}
\]</div>
<p>donde <span class="math notranslate nohighlight">\(e_i = y_i - \hat y_i\)</span></p>
<p>Para el modelo de <strong>regresión múltiple</strong></p>
<div class="math notranslate nohighlight">
\[
y_i = \beta_0 + \beta_1 x_{1i} + \cdots + \beta_k x_{ki} + \varepsilon_i
\]</div>
<p>el estimador de varianza (robusto a heteroscedasticidad) para <span class="math notranslate nohighlight">\(\hat\beta_j\)</span> está dado por:</p>
<div class="math notranslate nohighlight">
\[
V(\hat\beta_j)
= \frac{\sum_i r_{ij}^2 e_i^2}{\sum_i (x_{ji} - \bar{x_j})^2}
\]</div>
<p>donde <span class="math notranslate nohighlight">\(r_{ij}\)</span> es el residual para la observación <span class="math notranslate nohighlight">\(i\)</span> luego de estimar <span class="math notranslate nohighlight">\(x_j\)</span> en función de las demás variables independientes.</p>
<p>Recuerde que para nuestro modelo en forma matricial <span class="math notranslate nohighlight">\(Y = X\beta + \varepsilon\)</span>, podemos mostrar que la matriz de varianza-covarianza es:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
V(\hat{\beta}|X ) &amp;= E \big[(\hat{\beta} - E[\hat{\beta}])(\hat{\beta} - E[\hat{\beta}])' \,|\, X \big] \\
&amp;= (X'X)^{-1}X' E[\varepsilon\varepsilon'|X] X (X'X)^{-1} \\
\end{align*}\]</div>
<p>El estimador propuesto por Hal White para <span class="math notranslate nohighlight">\(X' E[\varepsilon\varepsilon'|X] X\)</span> está dado por:</p>
<div class="math notranslate nohighlight">
\[S_R = \sum_{i} e_i^2 \, x_i x_i'\]</div>
<p>De esta manera, el estimador de White para la matriz de varianza-covarianza toma la siguiente forma:</p>
<div class="math notranslate nohighlight">
\[
\widehat{V}(\hat{\beta}) = (X'X)^{-1} S_R (X'X)^{-1}\]</div>
<p>A estos errores se les conoce como <strong>errores de White</strong> o <strong>robustos</strong>, y corrigen (son robustos) cualquier forma de heteroscedasticidad.</p>
</section>
<section id="sesgo-por-error-de-especificacion">
<h2>Sesgo por Error de Especificación<a class="headerlink" href="#sesgo-por-error-de-especificacion" title="Link to this heading">#</a></h2>
<p>Consideremos ahora la función de regresión:</p>
<div class="math notranslate nohighlight">
\[
y_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \varepsilon_i \qquad (1)
\]</div>
<p>donde <span class="math notranslate nohighlight">\(E(\varepsilon_i | x_{1i}, x_{2i}) = 0\)</span>.</p>
<p>Suponga que usted está interasado en estimar el efecto causal de <span class="math notranslate nohighlight">\(x_{1i}\)</span> en <span class="math notranslate nohighlight">\(y_i\)</span>. Es decir, su parámetro de interés es <span class="math notranslate nohighlight">\(\beta_1\)</span>.</p>
<p>Sin embargo, usted omite la variable <span class="math notranslate nohighlight">\(x_{2i}\)</span> y estima</p>
<div class="math notranslate nohighlight">
\[
y_i = \beta_0 + \beta_1 x_{1i} + u_i \qquad u_i = \beta_2 x_{2i} + \varepsilon_i \qquad (2)
\]</div>
<p>Debido a este error de especificación, el estimador de MCO de <span class="math notranslate nohighlight">\(\beta_1\)</span> no es un estimador insesgado. Veamos:</p>
<p>Recuerde que:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\hat \beta_1 &amp;= \frac{\widehat{Cov}(x_{1i}, y_i)}{\widehat{V(x_{1i})}} \\
              &amp;= \frac{\widehat{Cov}(x_{1i}, \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \varepsilon_i)}{\widehat{V(x_{1i})}} \\
              &amp;= \beta_1 + \beta_2 \frac{\widehat{Cov}(x_{1i}, x_{2i})}{\widehat{V(x_{1i})}} + \frac{\widehat{Cov}(x_{1i}, \varepsilon_i)}{\widehat{V(x_{1i})}} \\
              &amp;= \beta_1 + \beta_2 \frac{\widehat{Cov}(x_{1i}, x_{2i})}{\widehat{V(x_{1i})}} \\              
\end{align*}\]</div>
<p>Este resultado nos permite ver que:</p>
<ul class="simple">
<li><p>si <span class="math notranslate nohighlight">\(\widehat{Cov}(x_{1i}, x_{2i}) = 0\)</span>, entonces <span class="math notranslate nohighlight">\(E(\hat\beta_1) = \beta_1\)</span></p></li>
<li><p>Sin embargo, si <span class="math notranslate nohighlight">\(\widehat{Cov}(x_{1i}, x_{2i}) \neq 0\)</span>, entonces <span class="math notranslate nohighlight">\(E(\hat\beta_1) \neq \beta_1\)</span></p></li>
</ul>
<p>En qué casos <span class="math notranslate nohighlight">\(\widehat{Cov}(x_{1i}, x_{2i}) = 0\)</span>?</p>
</section>
<section id="error-de-medicion-variable-dependiente">
<h2>Error de Medición: Variable Dependiente<a class="headerlink" href="#error-de-medicion-variable-dependiente" title="Link to this heading">#</a></h2>
<p>Suponga que usted está interesado en estudiar la relación entre una variable dependiente <span class="math notranslate nohighlight">\(y_i\)</span> y una variable <span class="math notranslate nohighlight">\(x_i\)</span>. Para ello usted quiere usar el siguiente modelo:</p>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \beta_1 x_i + \varepsilon_i\]</div>
<p>Sin embargo, usted observa <span class="math notranslate nohighlight">\(y_i\)</span> con un <strong>error (de medición)</strong> <span class="math notranslate nohighlight">\(\nu\)</span>. Es decir, usted observa <span class="math notranslate nohighlight">\(y_i^* = y_i + \nu\)</span>. Usualmente, asumimos que <span class="math notranslate nohighlight">\(\nu \sim N(0, \sigma^2_\nu)\)</span>. De esta manera, usted se ve ‘’obligado’’ a estimar:</p>
<div class="math notranslate nohighlight">
\[y_i^* = \beta_0 + \beta_1 x_i + u_i \qquad \text{ donde } u_i = \varepsilon_i + \nu\]</div>
<p><strong>¿Qué propiedades tienen los estimadores de MCO en este caso?</strong></p>
<p>Supongamos que la variable <span class="math notranslate nohighlight">\(x_i\)</span> es exogena. Es decir, <span class="math notranslate nohighlight">\(E(\varepsilon_i | x_i) = 0\)</span>.</p>
<p>Así,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\hat \beta_1 &amp;= \frac{\widehat{Cov}(x_{i}, y^*_i)}{\widehat{V(x_{i})}} \\
 &amp;= \frac{\widehat{Cov}(x_{i}, \beta_0 + \beta_1 x_{i} + u_i)}{\widehat{V(x_{i})}} \\
 &amp;= \beta_1 + \frac{\widehat{Cov}(x_{i}, \varepsilon_i)}{\widehat{V(x_{i})}} + \frac{\widehat{Cov}(x_{i}, \nu)}{\widehat{V(x_{i})}} \\ 
 &amp;= \beta_1 + \frac{\widehat{Cov}(x_{i}, \nu)}{\widehat{V(x_{i})}} \\  
\end{align*}\]</div>
<p>Observe que el error de medición puede sesgar los estimadores de MCO si existe una correlación entre el error de medición y las variables independientes, es decir si <span class="math notranslate nohighlight">\(\widehat{Cov}(x_{i}, \nu) \neq 0\)</span>.</p>
<p>Observe además que <span class="math notranslate nohighlight">\(V(u_i) = V(\varepsilon_i + \nu) = \sigma^2 + \sigma_\nu^2 &gt; \sigma^2\)</span>. Luego, en presencia de error de medición, nuestros errores estandar serán mayores.</p>
</section>
<section id="error-de-medicion-variable-independiente">
<h2>Error de Medición: Variable Independiente<a class="headerlink" href="#error-de-medicion-variable-independiente" title="Link to this heading">#</a></h2>
<p>Suponga ahora que usted tiene error de medición en la variable dependiente <span class="math notranslate nohighlight">\(x_i\)</span>. Es decir, usted observa <span class="math notranslate nohighlight">\(y_i\)</span> y <span class="math notranslate nohighlight">\(x_i^* = x_i + \nu\)</span>, con <span class="math notranslate nohighlight">\(\nu \sim N(0, \sigma_nu)\)</span>.</p>
<p>La función de regresión poblaciones es:</p>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \beta_1 x_i + \varepsilon_i\]</div>
<p>Sin embargo, usted estima:</p>
<div class="math notranslate nohighlight">
\[y_i = \beta_0 + \beta_1 x^*_i + u_i \qquad \text{ donde } u_i = \varepsilon_i -  \beta_1 \nu \]</div>
<p>Si asumimos que <span class="math notranslate nohighlight">\(Cov(x^*_i, \nu) = 0\)</span>, entonces MCO produce estimadores insesgados. Sin embargo, la <span class="math notranslate nohighlight">\(V(u_i) = \sigma^2 + \beta_1^2 \sigma_\nu^2\)</span>.</p>
<p>Debido a que este es el caso menos problemático, estamos más interesados en saber qué ocurre cuando asumimos que <span class="math notranslate nohighlight">\(Cov(x_i, \nu) = 0\)</span></p>
<p>Si este el caso, entonces <span class="math notranslate nohighlight">\(Cov(x_i^*, \nu) \neq 0\)</span>. Esto es asi porque <span class="math notranslate nohighlight">\(Cov(x_i, \nu) = Cov(x_i^*, \nu) - \sigma^2_\nu = 0\)</span>. Luego, <span class="math notranslate nohighlight">\(Cov(x_i^*, \nu) = \sigma^2_\nu &gt; 0\)</span>.</p>
<p>Usando las propiedades de los estimadores, podemos mostrar que</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
E(\hat \beta_1) &amp;= \beta_1 + \frac{Cov(x_i^*, \varepsilon_i -  \beta_1 \nu )}{V(x_i^*)} \\
&amp;= \beta_1 - \frac{\beta_1 \sigma^2_\nu}{\sigma^2_x + \sigma^2_\nu} \\
&amp;= \beta_1 \left(1 - \frac{\sigma^2_\nu}{\sigma^2_x + \sigma^2_\nu}\right) \\
&amp;= \beta_1 \left(\frac{\sigma^2_x}{\sigma^2_x + \sigma^2_\nu}\right) \\
\end{align*}\]</div>
<p>A este sesgo se le conoce como <strong>sesgo de atenuación</strong>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="4_Regresion.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Modelo de Regresión Multiple</p>
      </div>
    </a>
    <a class="right-next"
       href="6_Respuesta_Cualitativa.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Variables de Respuesta Cualitativa</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multicolinealidad">Multicolinealidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#como-identificar-multicolinealidad">¿Cómo identificar multicolinealidad?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#no-normalidad-de-errores">No-normalidad de Errores</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pruebas-de-normalidad">Pruebas de Normalidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heteroscedasticidad">Heteroscedasticidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#por-que-nos-interesa-la-heteroscedasticidad">¿Por qué nos interesa la heteroscedasticidad?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-goldfeld-quandt">Prueba de Goldfeld-Quandt</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-breusch-pagan">Prueba de Breusch-Pagan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procedimiento-prueba-de-breusch-pagan">Procedimiento: Prueba de Breusch-Pagan</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prueba-de-white">Prueba de White</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#heteroscedasticidad-y-error-de-especificacion">Heteroscedasticidad y Error de Especificación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-ponderados">Mínimos Cuadrados Ponderados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-cuadrados-factibles">Minimos Cuadrados Factibles</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#errores-estandar-robustos">Errores Estándar Robustos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sesgo-por-error-de-especificacion">Sesgo por Error de Especificación</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#error-de-medicion-variable-dependiente">Error de Medición: Variable Dependiente</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#error-de-medicion-variable-independiente">Error de Medición: Variable Independiente</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sebastian Montano
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>